cscope 15 $HOME/Desktop/OS/os_project/OSLab/OSLab/GeekOS/src/geekos               0000396532
	@alarm.c

10 
	~<gìkos/timî.h
>

11 
	~<gìkos/Æ¨m.h
>

12 
	~<gìkos/mÆloc.h
>

13 
	~<gìkos/î∫o.h
>

14 
	~<gìkos/öt.h
>

15 
	~<gìkos/kthªad.h
>

17 #i‚de‡
NULL


18 
	#NULL
 ((*)0)

	)

21 
Spö_Lock_t
 
	gÆ¨mLock
;

23 
	#DEBUG_ALARM
(
x
...)

	)

25 
Aœrm_H™dÀr_Queue
 
	gs_Æ¨mWaôögQueue
;

26 
Aœrm_H™dÀr_Queue
 
	gs_Æ¨mPídögQueue
;

27 
Thªad_Queue
 
	gs_thªadQueue
;

29 
ölöe
 
	$CÆc_Ticks_Pî_MS
(
mûli£c⁄ds
) {

30 
ticks
 = 
TICKS_PER_MS
 * 
mûli£c⁄ds
;

31 
åunc
 = ()
ticks
;

32  (((
ticks
 - 
åunc
) > 0) ?Årunc + 1 :Årunc);

33 
	}
}

35 
Aœrm_Evít
 *
	$Aœrm_Föd_In_Queue_By_ID
(
Aœrm_H™dÀr_Queue


36 *
queue
, 
id
) {

37 
Aœrm_Evít
 *
Æ¨m
;

38 
Æ¨m
 = 
	`Gë_Fr⁄t_Of_Aœrm_H™dÀr_Queue
(
queue
);

39 
Æ¨m
 !0;áœrm = 
	`Gë_Next_In_Aœrm_H™dÀr_Queue
(alarm)) {

40 i‡(
Æ¨m
->
timîId
 =
id
) {

41  
Æ¨m
;

44  
NULL
;

45 
	}
}

47 *
_íd
;

48 
Aœrm_H™dÀr
(
ul⁄g_t
 
¨g
 
__©åibuã__
 ((
unu£d
))) {

49 
Aœrm_Evít
 *
	gÆ¨m
 = 
NULL
;

51 
DißbÀ_I¡îru±s
();

53 i‡(!
Is_Aœrm_H™dÀr_Queue_Em±y
(&
s_Æ¨mPídögQueue
)) {

55 
	gÆ¨m
 =

56 
Remove_From_Fr⁄t_Of_Aœrm_H™dÀr_Queue


57 (&
s_Æ¨mPídögQueue
);

58 
E«bÀ_I¡îru±s
();

60 
DEBUG_ALARM
("Æ: %∞", 
Æ¨m
);

61 
KASSERT0
(
Æ¨m
, "firstálarm handler in queue isÇull");

62 
KASSERT0
((*)
Æ¨m
 > (*)0x10,

64 
DEBUG_ALARM
("Æcb: %p(%pËC‹ê%d\n", 
Æ¨m
->
ˇŒback
,

65 
Æ¨m
->
d©a
, 
Gë_CPU_ID
());

66 i‡(
	g_íd
) {

67 
KASSERT0
((*)
Æ¨m
->
ˇŒback
 < 
_íd
,

70 
	gÆ¨m
->
ˇŒback
(
Æ¨m
->
d©a
);

72 
DißbÀ_I¡îru±s
();

73 
Fªe
(
Æ¨m
);

74 
E«bÀ_I¡îru±s
();

76 
Waô
(&
s_thªadQueue
);

77 
E«bÀ_I¡îru±s
();

82 
	$Sy°em_Timî_CÆlback
(
id
) {

83 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

84 
Aœrm_Evít
 *
Æ¨m
 =

85 
	`Aœrm_Föd_In_Queue_By_ID
(&
s_Æ¨mWaôögQueue
, 
id
);

86 i‡(
Æ¨m
 == 0)

89 
	`KASSERT0
((*)
Æ¨m
->
ˇŒback
, "alarm callback wasÇull");

90 i‡(
_íd
) {

91 
	`KASSERT0
((*)
Æ¨m
->
ˇŒback
 < 
_íd
,

95 
	`Remove_From_Aœrm_H™dÀr_Queue
(&
s_Æ¨mWaôögQueue
, 
Æ¨m
);

96 
	`C™˚l_Timî
(
id
);

100 i‡(!
	`Is_Membî_Of_Aœrm_H™dÀr_Queue
(&
s_Æ¨mPídögQueue
, 
Æ¨m
)) {

101 
	`Add_To_Fr⁄t_Of_Aœrm_H™dÀr_Queue
(&
s_Æ¨mPídögQueue
, 
Æ¨m
);

103 
	`Wake_Up
(&
s_thªadQueue
);

104 
	}
}

106 
	$Inô_Aœrm
() {

107 
	`Sèπ_Kî√l_Thªad
(
Aœrm_H™dÀr
, 0, 
PRIORITY_NORMAL
, 
Ál£
, "{Alarm}");

108 
	}
}

110 
	$Aœrm_Cª©e
(
Aœrm_CÆlback
 
ˇŒback
, *
d©a
,

111 
mûliSec⁄ds
) {

112 
Aœrm_Evít
 *
Æ¨mEvít
 = 
	`MÆloc
((Alarm_Event));

113 i‡(
Æ¨mEvít
 == 0)

114  
ENOMEM
;

116 
id
;

118 
Æ¨mEvít
->
ˇŒback
 = callback;

119 
Æ¨mEvít
->
d©a
 = data;

120 
Æ¨mEvít
->
thªad
 = 
CURRENT_THREAD
;

122 
	`DißbÀ_I¡îru±s
();

124 
id
 = 
	`Sèπ_Timî
(
	`CÆc_Ticks_Pî_MS
(
mûliSec⁄ds
), 
Sy°em_Timî_CÆlback
);

125 i‡(
id
 < 0) {

126 
	`E«bÀ_I¡îru±s
();

127 
	`DEBUG_ALARM
("In Alarm_Create, failedÅo Start_Timer\n");

131 
Æ¨mEvít
->
timîId
 = 
id
;

133 
	`Add_To_Fr⁄t_Of_Aœrm_H™dÀr_Queue
(&
s_Æ¨mWaôögQueue
, 
Æ¨mEvít
);

134 
	`E«bÀ_I¡îru±s
();

135  
id
;

137 
	}
}

139 
	$Aœrm_C™˚l_F‹_Thªad
(
Kî√l_Thªad
 *
thªad
) {

140 
Aœrm_Evít
 *
Æ¨m
, *
√xt
;

142 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

144 
Æ¨m
 = 
	`Gë_Fr⁄t_Of_Aœrm_H™dÀr_Queue
(&
s_Æ¨mWaôögQueue
);

145 
Æ¨m
 !0;áœrm = 
√xt
) {

146 
√xt
 = 
	`Gë_Next_In_Aœrm_H™dÀr_Queue
(
Æ¨m
);

147 i‡(
Æ¨m
->
thªad
 ==Åhread) {

148 
	`Remove_From_Aœrm_H™dÀr_Queue
(&
s_Æ¨mWaôögQueue
, 
Æ¨m
);

149 
	`Fªe
(
Æ¨m
);

154 
	}
}

156 
	$Aœrm_De°roy
(
id
) {

157 
	`DißbÀ_I¡îru±s
();

159 
Aœrm_Evít
 *
Æ¨m
 =

160 
	`Aœrm_Föd_In_Queue_By_ID
(&
s_Æ¨mWaôögQueue
, 
id
);

161 i‡(
Æ¨m
) {

162 
	`Remove_From_Aœrm_H™dÀr_Queue
(&
s_Æ¨mWaôögQueue
, 
Æ¨m
);

163 
	`C™˚l_Timî
(
id
);

164 
	`Fªe
(
Æ¨m
);

166 
Æ¨m
 = 
	`Aœrm_Föd_In_Queue_By_ID
(&
s_Æ¨mPídögQueue
, 
id
);

167 i‡(
Æ¨m
) {

168 
	`Remove_From_Aœrm_H™dÀr_Queue
(&
s_Æ¨mPídögQueue
, 
Æ¨m
);

169 
	`Fªe
(
Æ¨m
);

172 
	`E«bÀ_I¡îru±s
();

174 
	}
}

	@argblock.c

10 
	~<gìkos/kty≥s.h
>

11 
	~<gìkos/°rög.h
>

12 
	~<gìkos/¨gblock.h
>

19 
boﬁ
 
	$Is_S∑˚
(
c
) {

20  
c
 == ' ' || c == '\t' || c == '\n' || c == '\r';

21 
	}
}

28 c⁄° *
	$Skù_Whôe•a˚
(c⁄° *
s
) {

29 
	`Is_S∑˚
(*
s
))

30 ++
s
;

31  
s
;

32 
	}
}

39 
	$Gë_Argumít_Lí
(c⁄° *
¨g
) {

40 c⁄° *
s
 = 
¨g
;

41 
Àn
 = 0;

43 *
s
 !'\0' && !
	`Is_S∑˚
(*s)) {

44 ++
Àn
;

45 ++
s
;

47  
Àn
;

48 
	}
}

59 
	$Gë_Argumít_Block_Size
(c⁄° *
comm™d
, *
numArgs
,

60 
ul⁄g_t
 * 
¨gBlockSize
) {

61 
ul⁄g_t
 
size
 = 0;

62 
¨gCou¡
 = 0;

63 c⁄° *
s
 = 
comm™d
;

65 
size
 += ();

66 
size
 += (**);

73 
Àn
;

75 
s
 = 
	`Skù_Whôe•a˚
(s);

77 i‡(*
s
 == '\0')

79 
Àn
 = 
	`Gë_Argumít_Lí
(
s
);

80 
s
 +
Àn
;

82 
size
 += (*);

83 
size
 +
Àn
 + 1;

84 ++
¨gCou¡
;

88 
size
 += (*);

90 *
numArgs
 = 
¨gCou¡
;

91 *
¨gBlockSize
 = 
size
;

94 
	}
}

108 
	$F‹m©_Argumít_Block
(*
¨gBlock
, 
numArgs
,

109 
ul⁄g_t
 
u£rAddªss
, c⁄° *
comm™d
) {

110 
Àn
;

111 
ul⁄g_t
 *
¨gv
;

112 *
d°
 = 
¨gBlock
;

113 c⁄° *
s
 = 
comm™d
;

116 *(*)
d°
 = 
numArgs
;

117 
d°
 += ();

123 *(
ul⁄g_t
 *Ë
d°
 = 
u£rAddªss
 + (
Argumít_Block
);

124 
d°
 += (**);

127 
¨gv
 = (
ul⁄g_t
 *Ë
d°
;

128 
d°
 +(
numArgs
 + 1) * (*);

132 
s
 = 
	`Skù_Whôe•a˚
(s);

133 i‡(*
s
 == '\0')

135 *
¨gv
++ = 
u£rAddªss
 + (
d°
 - 
¨gBlock
);

137 
Àn
 = 
	`Gë_Argumít_Lí
(
s
);

138 
	`mem˝y
(
d°
, 
s
, 
Àn
);

139 
d°
 +
Àn
;

140 *
d°
++ = '\0';

142 
s
 +
Àn
;

146 *
¨gv
++ = 0;

147 
	}
}

	@bitset.c

15 
	~<gìkos/kas£π.h
>

16 
	~<gìkos/mÆloc.h
>

17 
	~<gìkos/bô£t.h
>

18 
	~<gìkos/°rög.h
>

19 
	~<libc/c⁄io.h
>

21 
	#FIND_OFFSET_AND_BIT
(
bôPos
,
off£t
,
bô
) \

23 
off£t
 = 
bôPos
 / 8; \

24 
bô
 = 
bôPos
 % 8; \

25 } 0)

	)

27 
	#FIND_NUM_BYTES
(
tŸÆBôs
) \

28 ((
tŸÆBôs
 / 8Ë+ (—ŸÆBô†% 8 !0Ë? 1 : 0))

	)

30 *
	$Cª©e_Bô_Së
(
uöt_t
 
tŸÆBôs
) {

31 
ul⁄g_t
 
numByãs
;

32 *
bôSë
;

34 
numByãs
 = 
	`FIND_NUM_BYTES
(
tŸÆBôs
);

36 
bôSë
 = 
	`MÆloc
(
numByãs
);

37 i‡(
bôSë
 != 0)

38 
	`mem£t
(
bôSë
, '\0', 
numByãs
);

40 
	`Pröt
("malloc failed\n");

42  
bôSë
;

43 
	}
}

45 
	$Së_Bô
(*
bôSë
, 
uöt_t
 
bôPos
) {

46 
ul⁄g_t
 
off£t
, 
bô
;

48 
	`FIND_OFFSET_AND_BIT
(
bôPos
, 
off£t
, 
bô
);

49 ((
uch¨_t
 *Ë
bôSë
)[
off£t
] |(1 << 
bô
);

50 
	}
}

52 
	$CÀ¨_Bô
(*
bôSë
, 
uöt_t
 
bôPos
) {

53 
ul⁄g_t
 
off£t
, 
bô
;

55 
	`FIND_OFFSET_AND_BIT
(
bôPos
, 
off£t
, 
bô
);

56 ((
uch¨_t
 *Ë
bôSë
)[
off£t
] &~(1 << 
bô
);

57 
	}
}

59 
boﬁ
 
	$Is_Bô_Së
(*
bôSë
, 
uöt_t
 
bôPos
) {

60 
ul⁄g_t
 
off£t
, 
bô
;

62 
	`FIND_OFFSET_AND_BIT
(
bôPos
, 
off£t
, 
bô
);

63  (((
uch¨_t
 *Ë
bôSë
)[
off£t
] & (1 << 
bô
)) != 0;

64 
	}
}

66 
	$Föd_Fú°_Fªe_Bô
(*
bôSë
, 
ul⁄g_t
 
tŸÆBôs
) {

67 
uöt_t
 
numByãs
 = 
	`FIND_NUM_BYTES
(
tŸÆBôs
);

68 
ul⁄g_t
 
off£t
;

69 
uch¨_t
 *
bôs
 = (uch¨_à*Ë
bôSë
;

71 
off£t
 = 0; off£à< 
numByãs
; ++offset) {

72 i‡(
bôs
[
off£t
] != 0xff) {

73 
uöt_t
 
bô
;

74 
bô
 = 0; bit < 8; ++bit) {

75 i‡((
bôs
[
off£t
] & (1 << 
bô
)) == 0)

76  (
off£t
 * 8Ë+ 
bô
;

78 #ifde‡
GEEKOS


80 
	`KASSERT
(
Ál£
);

86 
	}
}

91 
	$Föd_Fú°_N_Fªe
(*
bôSë
, 
uöt_t
 
runLígth
, 
ul⁄g_t
 
tŸÆBôs
) {

92 
uöt_t
 
i
, 
j
;

94 
i
 = 0; i < 
tŸÆBôs
 - 
runLígth
; i++) {

95 i‡(!
	`Is_Bô_Së
(
bôSë
, 
i
)) {

96 
j
 = 1; j < 
runLígth
; j++) {

97 i‡(
	`Is_Bô_Së
(
bôSë
, 
i
 + 
j
)) {

101 i‡(
j
 =
runLígth
) {

102  
i
;

107 
	}
}

109 
	$De°roy_Bô_Së
(*
bôSë
) {

110 
	`Fªe
(
bôSë
);

111 
	}
}

	@blockdev.c

10 
	~<gìkos/î∫o.h
>

11 
	~<gìkos/s¸ìn.h
>

12 
	~<gìkos/°rög.h
>

13 
	~<gìkos/mÆloc.h
>

14 
	~<gìkos/öt.h
>

15 
	~<gìkos/kthªad.h
>

16 
	~<gìkos/synch.h
>

17 
	~<gìkos/blockdev.h
>

20 #ifde‡
BLOCKDEV_DEBUG


21 
	#Debug
(
¨gs
...Ë
	`Pröt
◊rgs)

	)

23 
	#Debug
(
¨gs
...)

	)

26 
Spö_Lock_t
 
kthªadLock
;

35 
Muãx
 
	gs_blockdevLock
;

40 
DEFINE_LIST
(
Block_Devi˚_Li°
, 
Block_Devi˚
);

41 
IMPLEMENT_LIST
(
Block_Devi˚_Li°
, 
Block_Devi˚
);

47 
Block_Devi˚_Li°
 
	gs_devi˚Li°
;

54 
	$Do_Reque°
(
Block_Devi˚
 *
dev
, 
Reque°_Ty≥
 
ty≥
,

55 
blockNum
, *
buf
) {

56 
Block_Reque°
 *
ªque°
;

57 
rc
;

60 
	`Muãx_Lock
(&
s_blockdevLock
);

61 
ªque°
 = 
	`Cª©e_Reque°
(
dev
, 
ty≥
, 
blockNum
, 
buf
);

63 i‡(
ªque°
 == 0) {

65 
	`Muãx_U∆ock
(&
s_blockdevLock
);

66  
ENOMEM
;

69 
	`Po°_Reque°_And_Waô
(
ªque°
);

70 
rc
 = 
ªque°
->
îr‹Code
;

71 
	`Fªe
(
ªque°
);

72 
	`Muãx_U∆ock
(&
s_blockdevLock
);

73  
rc
;

74 
	}
}

86 
	$Regi°î_Block_Devi˚
(c⁄° *
«me
, 
Block_Devi˚_Ops
 *
›s
,

87 
unô
, *
drivîD©a
,

88 
Thªad_Queue
 *
waôQueue
,

89 
Block_Reque°_Li°
 *
ªque°Queue
) {

90 
Block_Devi˚
 *
dev
;

92 
	`KASSERT
(
›s
 != 0);

93 
	`KASSERT
(
waôQueue
 != 0);

94 
	`KASSERT
(
ªque°Queue
 != 0);

96 
dev
 = (
Block_Devi˚
 *)
	`MÆloc
((*dev));

97 i‡(
dev
 == 0)

98  
ENOMEM
;

100 
	`°r˝y
(
dev
->
«me
,Çame);

101 
dev
->
›s
 = ops;

102 
dev
->
unô
 = unit;

103 
dev
->
öU£
 = 
Ál£
;

104 
dev
->
drivîD©a
 = driverData;

105 
dev
->
waôQueue
 = waitQueue;

106 
dev
->
ªque°Queue
 =ÑequestQueue;

107 
dev
->
ªads
 = dev->
wrôes
 = 0;

109 
	`Muãx_Lock
(&
s_blockdevLock
);

111 
	`Debug
("Regi°îög block devi˚ %s\n", 
dev
->
«me
);

112 
	`Add_To_Back_Of_Block_Devi˚_Li°
(&
s_devi˚Li°
, 
dev
);

113 
	`Muãx_U∆ock
(&
s_blockdevLock
);

116 
	}
}

122 
	$O≥n_Block_Devi˚
(c⁄° *
«me
, 
Block_Devi˚
 **
pDev
) {

123 
Block_Devi˚
 *
dev
;

124 
rc
 = 0;

126 
	`Muãx_Lock
(&
s_blockdevLock
);

128 
dev
 = 
	`Gë_Fr⁄t_Of_Block_Devi˚_Li°
(&
s_devi˚Li°
);

129 
dev
 != 0) {

130 i‡(
	`°rcmp
(
dev
->
«me
,Çame) == 0)

132 
dev
 = 
	`Gë_Next_In_Block_Devi˚_Li°
(dev);

135 i‡(
dev
 == 0)

136 
rc
 = 
ENODEV
;

137 i‡(
dev
->
öU£
)

138 
rc
 = 
EBUSY
;

140 
rc
 = 
dev
->
›s
->
	`O≥n
(dev);

141 i‡(
rc
 == 0) {

142 *
pDev
 = 
dev
;

143 
dev
->
öU£
 = 
åue
;

147 
	`Muãx_U∆ock
(&
s_blockdevLock
);

149  
rc
;

150 
	}
}

156 
	$Clo£_Block_Devi˚
(
Block_Devi˚
 *
dev
) {

157 
rc
;

159 
	`Muãx_Lock
(&
s_blockdevLock
);

161 
	`KASSERT
(
dev
->
öU£
);

162 
rc
 = 
dev
->
›s
->
	`Clo£
(dev);

163 i‡(
rc
 == 0)

164 
dev
->
öU£
 = 
Ál£
;

166 
	`Muãx_U∆ock
(&
s_blockdevLock
);

168  
rc
;

169 
	}
}

174 
Block_Reque°
 *
	$Cª©e_Reque°
(
Block_Devi˚
 *
dev
,

175 
Reque°_Ty≥
 
ty≥
, 
blockNum
,

176 *
buf
) {

177 
Block_Reque°
 *
ªque°
 = 
	`MÆloc
((*request));

178 i‡(
ªque°
 != 0) {

179 
ªque°
->
dev
 = dev;

180 
ªque°
->
ty≥
 =Åype;

181 
ªque°
->
blockNum
 = blockNum;

182 
ªque°
->
buf
 = buf;

183 
ªque°
->
°©e
 = 
PENDING
;

184 
	`CÀ¨_Thªad_Queue
(&
ªque°
->
waôQueue
);

186  
ªque°
;

187 
	}
}

194 
	$Po°_Reque°_And_Waô
(
Block_Reque°
 *
ªque°
) {

195 
Block_Devi˚
 *
dev
;

197 
	`KASSERT
(
ªque°
 != 0);

199 
dev
 = 
ªque°
->dev;

200 
	`KASSERT
(
dev
 != 0);

203 
	`Debug
("Po°ög block devi˚Ñeque° [@%x]...\n", 
ªque°
);

204 
	`DißbÀ_I¡îru±s
();

205 
	`Spö_Lock
(&
kthªadLock
);

206 
	`Add_To_Back_Of_Block_Reque°_Li°
(
dev
->
ªque°Queue
, 
ªque°
);

207 
	`Wake_Up_Locked
(
dev
->
waôQueue
);

208 
	`Spö_U∆ock
(&
kthªadLock
);

209 
	`E«bÀ_I¡îru±s
();

212 
	`DißbÀ_I¡îru±s
();

213 
ªque°
->
°©e
 =
PENDING
) {

214 
	`Debug
("Waôög, sèã=%d\n", 
ªque°
->
°©e
);

215 
	`Waô
(&
ªque°
->
waôQueue
);

217 
	`Debug
("Wait completed!\n");

218 
	`E«bÀ_I¡îru±s
();

219 
	}
}

224 
Block_Reque°
 *
	$Dequeue_Reque°
(
Block_Reque°_Li°
 *
ªque°Queue
,

225 
Thªad_Queue
 *
waôQueue
) {

226 
Block_Reque°
 *
ªque°
;

228 
	`DißbÀ_I¡îru±s
();

229 
	`Is_Block_Reque°_Li°_Em±y
(
ªque°Queue
))

230 
	`Waô
(
waôQueue
);

231 
ªque°
 = 
	`Gë_Fr⁄t_Of_Block_Reque°_Li°
(
ªque°Queue
);

232 
	`Remove_From_Fr⁄t_Of_Block_Reque°_Li°
(
ªque°Queue
);

233 
	`E«bÀ_I¡îru±s
();

235  
ªque°
;

236 
	}
}

241 
	$NŸify_Reque°_Com∂ëi⁄
(
Block_Reque°
 *
ªque°
,

242 
Reque°_Sèã
 
°©e
, 
îr‹Code
) {

243 
	`DißbÀ_I¡îru±s
();

245 
ªque°
->
°©e
 = state;

246 
ªque°
->
îr‹Code
 =ÉrrorCode;

248 
	`Wake_Up
(&
ªque°
->
waôQueue
);

251 
	`E«bÀ_I¡îru±s
();

252 
	}
}

258 
	$Block_Ród
(
Block_Devi˚
 *
dev
, 
blockNum
, *
buf
) {

259 
	`KASSERT
(
dev
);

260 
	`KASSERT
(
buf
);

261 
dev
->
ªads
++;

262  
	`Do_Reque°
(
dev
, 
BLOCK_READ
, 
blockNum
, 
buf
);

263 
	}
}

269 
	$Block_Wrôe
(
Block_Devi˚
 *
dev
, 
blockNum
, *
buf
) {

270 
	`KASSERT
(
dev
);

271 
	`KASSERT
(
buf
);

272 
dev
->
wrôes
++;

273  
	`Do_Reque°
(
dev
, 
BLOCK_WRITE
, 
blockNum
, 
buf
);

274 
	}
}

279 
	$Gë_Num_Blocks
(
Block_Devi˚
 *
dev
) {

280  
dev
->
›s
->
	`Gë_Num_Blocks
(dev);

281 
	}
}

286 
	$Dump_Blockdev_Sèts
() {

287 
Block_Devi˚
 *
dev
;

288 
i
;

289 
	`Pröt
("Block Device Stats:\n");

290 
	`Muãx_Lock
(&
s_blockdevLock
);

291 
dev
 = 
	`Gë_Fr⁄t_Of_Block_Devi˚_Li°
(&
s_devi˚Li°
), 
i
 = 5;

292 
dev
 !0 && 
i
 > 0;

293 
dev
 = 
	`Gë_Next_In_Block_Devi˚_Li°
(dev), 
i
 -= 1) {

294 
	`Pröt
(" %s:Ñód %u wrŸê%u\n", 
dev
->
«me
, dev->
ªads
, dev->
wrôes
);

296 
	`Muãx_U∆ock
(&
s_blockdevLock
);

297 
	}
}

	@bufcache.c

10 
	~<gìkos/î∫o.h
>

11 
	~<gìkos/kas£π.h
>

12 
	~<gìkos/mem.h
>

13 
	~<gìkos/mÆloc.h
>

14 
	~<gìkos/blockdev.h
>

15 
	~<gìkos/bufˇche.h
>

20 
	#FS_BUFFER_CACHE_MAX_BLOCKS
 128

	)

26 
	gbufCacheDebug
 = 0;

27 
	#Debug
(
¨gs
...Ëi‡(
bufCacheDebug
Ë
	`Pröt
◊rgs)

	)

30 
	gnoEvi˘
 = 0;

36 
uöt_t
 
	$Gë_Num_Se˘‹s_Pî_FS_Block
(
FS_Buf„r_Cache
 *
ˇche
) {

37  (
ˇche
->
fsBlockSize
 / 
SECTOR_SIZE
);

38 
	}
}

43 
Do_Buf„r_IO
(
FS_Buf„r_Cache
 *
ˇche
, 
FS_Buf„r
 *
buf
,

44 (*
IO_Func
Ë(
Block_Devi˚
 * 
dev
,

45 
blockNum
, *
buf
)) {

46 
uöt_t
 
off£t
;

47 
£˘‹Cou¡
 = 0;

48 
blockNum
 = 
buf
->
fsBlockNum
 * 
	`Gë_Num_Se˘‹s_Pî_FS_Block
(
ˇche
);

49 *
±r
 = (*)
buf
->
d©a
;

51 
off£t
 = 0; off£à< 
ˇche
->
fsBlockSize
; off£à+
SECTOR_SIZE
) {

52 
rc
 = 
	`IO_Func
(
ˇche
->
dev
, 
blockNum
, 
±r
 + 
off£t
);

53 i‡(
rc
 != 0)

54  
rc
;

55 ++
£˘‹Cou¡
;

56 ++
blockNum
;

58 
	`KASSERT
(
off£t
 =
ˇche
->
fsBlockSize
);

59 
	`KASSERT
(
£˘‹Cou¡
 =
	`Gë_Num_Se˘‹s_Pî_FS_Block
(
ˇche
));

62 
	}
}

67 
	$Sync_Buf„r
(
FS_Buf„r_Cache
 *
ˇche
, 
FS_Buf„r
 *
buf
) {

68 
rc
 = 0;

70 
	`KASSERT
(
	`IS_HELD
(&
ˇche
->
lock
));

72 i‡(
buf
->
Êags
 & 
FS_BUFFER_DIRTY
) {

73 i‡((
rc
 = 
	`Do_Buf„r_IO
(
ˇche
, 
buf
, 
Block_Wrôe
)) == 0)

74 
buf
->
Êags
 &~(
FS_BUFFER_DIRTY
);

77  
rc
;

78 
	}
}

84 
	$Move_To_Fr⁄t
(
FS_Buf„r_Cache
 *
ˇche
,

85 
FS_Buf„r
 *
buf
) {

86 
	`Remove_From_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
, 
buf
);

87 
	`Add_To_Fr⁄t_Of_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
, 
buf
);

88 
	}
}

94 
	$Gë_Buf„r
(
FS_Buf„r_Cache
 *
ˇche
, 
ul⁄g_t
 
fsBlockNum
,

95 
FS_Buf„r
 **
pBuf
) {

96 
FS_Buf„r
 *
buf
, *
Ãu
 = 0;

97 
rc
;

99 
	`Debug
("Reque° block %lu\n", 
fsBlockNum
);

101 
	`KASSERT
(
	`IS_HELD
(&
ˇche
->
lock
));

108 
buf
 = 
	`Gë_Fr⁄t_Of_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
);

109 
buf
 != 0) {

110 i‡(
buf
->
fsBlockNum
 == fsBlockNum) {

111 
	`Debug
("Found block %lu\n", 
fsBlockNum
);

113 
buf
->
Êags
 & 
FS_BUFFER_INUSE
) {

114 
	`Debug
("Waôög f‹ block %lu\n", 
fsBlockNum
);

115 
	`C⁄d_Waô
(&
ˇche
->
c⁄d
, &ˇche->
lock
);

117 
d⁄e
;

121 i‡(!(
buf
->
Êags
 & 
FS_BUFFER_INUSE
))

122 
Ãu
 = 
buf
;

124 
buf
 = 
	`Gë_Next_In_FS_Buf„r_Li°
(buf);

131 i‡(
ˇche
->
numCached
 < 
FS_BUFFER_CACHE_MAX_BLOCKS
) {

132 
buf
 = (
FS_Buf„r
 *)
	`MÆloc
((*buf));

133 i‡(
buf
 != 0) {

134 
buf
->
d©a
 = 
	`AŒoc_Page
();

135 i‡(
buf
->
d©a
 == 0) {

136 
	`Fªe
(
buf
);

139 
buf
->
fsBlockNum
 = fsBlockNum;

140 
buf
->
Êags
 = 0;

141 
	`Add_To_Fr⁄t_Of_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
, 
buf
);

142 ++
ˇche
->
numCached
;

143 
ªadAndAcquúe
;

152 i‡(
Ãu
 == 0)

153  
ENOMEM
;

155 
	`KASSERT
(!
noEvi˘
);

158 i‡((
rc
 = 
	`Sync_Buf„r
(
ˇche
, 
Ãu
)) != 0)

159  
rc
;

162 
buf
 = 
Ãu
;

163 
buf
->
Êags
 = 0;

164 
buf
->
fsBlockNum
 = fsBlockNum;

165 
	`Move_To_Fr⁄t
(
ˇche
, 
buf
);

167 
ªadAndAcquúe
:

173 
	`KASSERT
(!(
buf
->
Êags
 & 
FS_BUFFER_DIRTY
));

174 
	`KASSERT
(
	`Gë_Fr⁄t_Of_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
Ë=
buf
);

177 i‡((
rc
 = 
	`Do_Buf„r_IO
(
ˇche
, 
buf
, 
Block_Ród
)) != 0)

178  
rc
;

180 
d⁄e
:

182 
buf
->
Êags
 |
FS_BUFFER_INUSE
;

185 
	`Debug
("Acquúed block %lu\n", 
fsBlockNum
);

186 *
pBuf
 = 
buf
;

188 
	}
}

193 
	$Sync_Cache
(
FS_Buf„r_Cache
 *
ˇche
) {

194 
rc
 = 0;

195 
FS_Buf„r
 *
buf
;

197 
	`KASSERT
(
	`IS_HELD
(&
ˇche
->
lock
));

199 
buf
 = 
	`Gë_Fr⁄t_Of_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
);

200 
buf
 != 0) {

201 i‡((
rc
 = 
	`Sync_Buf„r
(
ˇche
, 
buf
)) != 0)

203 
buf
 = 
	`Gë_Next_In_FS_Buf„r_Li°
(buf);

206  
rc
;

207 
	}
}

212 
	$Fªe_Buf„r
(
FS_Buf„r
 *
buf
) {

213 
	`KASSERT
(!(
buf
->
Êags
 & (
FS_BUFFER_DIRTY
 | 
FS_BUFFER_INUSE
)));

214 
	`Fªe_Page
(
buf
->
d©a
);

215 
	`Fªe
(
buf
);

216 
	}
}

225 
FS_Buf„r_Cache
 *
	$Cª©e_FS_Buf„r_Cache
(
Block_Devi˚
 *
dev
,

226 
uöt_t
 
fsBlockSize
) {

227 
FS_Buf„r_Cache
 *
ˇche
;

229 
	`KASSERT
(
dev
 != 0);

230 
	`KASSERT
(
dev
->
öU£
);

236 
	`KASSERT
(
fsBlockSize
 <
PAGE_SIZE
);

237 
	`KASSERT
(
fsBlockSize
 > 0);

239 
ˇche
 = (
FS_Buf„r_Cache
 *)
	`MÆloc
((*cache));

240 i‡(
ˇche
 == 0)

243 
ˇche
->
dev
 = dev;

244 
ˇche
->
fsBlockSize
 = fsBlockSize;

245 
ˇche
->
numCached
 = 0;

246 
	`CÀ¨_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
);

247 
	`Muãx_Inô
(&
ˇche
->
lock
);

248 
	`C⁄d_Inô
(&
ˇche
->
c⁄d
);

250  
ˇche
;

251 
	}
}

257 
	$Sync_FS_Buf„r_Cache
(
FS_Buf„r_Cache
 *
ˇche
) {

258 
rc
;

260 
	`Muãx_Lock
(&
ˇche
->
lock
);

261 
rc
 = 
	`Sync_Cache
(
ˇche
);

262 
	`Muãx_U∆ock
(&
ˇche
->
lock
);

264  
rc
;

265 
	}
}

272 
	$De°roy_FS_Buf„r_Cache
(
FS_Buf„r_Cache
 *
ˇche
) {

273 
rc
;

274 
FS_Buf„r
 *
buf
;

276 
	`Muãx_Lock
(&
ˇche
->
lock
);

279 
rc
 = 
	`Sync_Cache
(
ˇche
);

282 
buf
 = 
	`Gë_Fr⁄t_Of_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
);

283 
buf
 != 0) {

284 
FS_Buf„r
 *
√xt
 = 
	`Gë_Next_In_FS_Buf„r_Li°
(
buf
);

285 
	`Fªe_Buf„r
(
buf
);

286 
buf
 = 
√xt
;

288 
	`CÀ¨_FS_Buf„r_Li°
(&
ˇche
->
buf„rLi°
);

290 
	`Muãx_U∆ock
(&
ˇche
->
lock
);

293 
	`Fªe
(
ˇche
);

295  
rc
;

296 
	}
}

301 
	$Gë_FS_Buf„r
(
FS_Buf„r_Cache
 *
ˇche
, 
ul⁄g_t
 
fsBlockNum
,

302 
FS_Buf„r
 **
pBuf
) {

303 
rc
;

305 
	`KASSERT0
(
ˇche
 !
NULL
, "Null FS_Buffer_CacheÖassedÅo Get_FS_Buffer.");

306 
	`KASSERT0
(
pBuf
 !
NULL
,

309 
	`Muãx_Lock
(&
ˇche
->
lock
);

310 
rc
 = 
	`Gë_Buf„r
(
ˇche
, 
fsBlockNum
, 
pBuf
);

311 
	`Muãx_U∆ock
(&
ˇche
->
lock
);

313  
rc
;

314 
	}
}

319 
	$Modify_FS_Buf„r
(
FS_Buf„r_Cache
 *
ˇche
, 
FS_Buf„r
 *
buf
) {

320 
	`KASSERT0
(
ˇche
 !
NULL
, "Null FS_Buffer_CacheÖassedÅo Modify_FS_Buffer.");

321 
	`KASSERT0
(
buf
 !
NULL
, "Null FS_BufferÖassedÅo Modify_FS_Buffer.");

323 
	`KASSERT
(
buf
->
Êags
 & 
FS_BUFFER_INUSE
);

324 
buf
->
Êags
 |
FS_BUFFER_DIRTY
;

325 
	}
}

331 
	$Sync_FS_Buf„r
(
FS_Buf„r_Cache
 *
ˇche
, 
FS_Buf„r
 *
buf
) {

332 
rc
;

334 
	`KASSERT
(
buf
->
Êags
 & 
FS_BUFFER_INUSE
);

336 
	`Muãx_Lock
(&
ˇche
->
lock
);

337 
rc
 = 
	`Sync_Buf„r
(
ˇche
, 
buf
);

338 
	`Muãx_U∆ock
(&
ˇche
->
lock
);

340  
rc
;

341 
	}
}

346 
	$Rñó£_FS_Buf„r
(
FS_Buf„r_Cache
 *
ˇche
, 
FS_Buf„r
 *
buf
) {

347 
rc
 = 0;

349 
	`KASSERT
(
buf
->
Êags
 & 
FS_BUFFER_INUSE
);

351 
	`Muãx_Lock
(&
ˇche
->
lock
);

358 i‡(
rc
 == 0) {

359 
buf
->
Êags
 &~(
FS_BUFFER_INUSE
);

360 
	`C⁄d_Brﬂdˇ°
(&
ˇche
->
c⁄d
);

362 
	`Debug
("Rñó£d block %lu\n", 
buf
->
fsBlockNum
);

364 
	`Muãx_U∆ock
(&
ˇche
->
lock
);

366  
rc
;

367 
	}
}

	@cfs.c

13 
	~<limôs.h
>

14 
	~<˘y≥.h
>

15 
	~<gìkos/î∫o.h
>

16 
	~<gìkos/kas£π.h
>

17 
	~<gìkos/s¸ìn.h
>

18 
	~<gìkos/mÆloc.h
>

19 
	~<gìkos/°rög.h
>

20 
	~<gìkos/bô£t.h
>

21 
	~<gìkos/synch.h
>

22 
	~<gìkos/bufˇche.h
>

23 
	~<gìkos/li°.h
>

24 
	~<gìkos/cfs.h
>

25 
	~<gìkos/vfs.h
>

26 
	~<gìkos/°rög.h
>

27 
	~<gìkos/¥oje˘s.h
>

28 
	~<gìkos/mem.h
>

38 
	$CFS_F‹m©
(
Block_Devi˚
 *
blockDev
) {

39 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Format operation");

40  
EUNSUPPORTED
;

41 
	}
}

47 
	$CFS_Mou¡
(
Mou¡_Poöt
 *
mou¡Poöt
) {

48 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Mount operation");

49  
EUNSUPPORTED
;

50 
	}
}

55 
	$CFS_FSèt
(
Fûe
 *
fûe
, 
VFS_Fûe_Sèt
 *
°©
) {

56 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system FStat operation");

57  
EUNSUPPORTED
;

58 
	}
}

66 
	$CFS_O≥n
(
Mou¡_Poöt
 *
mp
, c⁄° *
∑th
, 
mode
,

67 
Fûe
 **
pFûe
) {

68 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Open operation");

69  
EUNSUPPORTED
;

70 
	}
}

76 
	$CFS_Ród
(
Fûe
 *
fûe
, *
±r
, 
ul⁄g_t
 
numByãs
) {

77 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Read operation");

78  
EUNSUPPORTED
;

79 
	}
}

85 
	$CFS_Wrôe
(
Fûe
 *
fûe
, *
±r
, 
ul⁄g_t
 
numByãs
) {

86 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Write operation");

87  
EUNSUPPORTED
;

88 
	}
}

93 
	$CFS_Sèt
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

94 
VFS_Fûe_Sèt
 *
°©
) {

95 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Stat operation");

96  
EUNSUPPORTED
;

97 
	}
}

103 
	$CFS_Sync
(
Mou¡_Poöt
 *
mou¡Poöt
) {

104 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Sync operation");

105  
EUNSUPPORTED
;

106 
	}
}

111 
	$CFS_Clo£
(
Fûe
 *
fûe
) {

112 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Close operation");

113  
EUNSUPPORTED
;

114 
	}
}

119 
	$CFS_Cª©e_Dúe˘‹y
(
Mou¡_Poöt
 *
mp
, c⁄° *
c⁄°_∑th
) {

120 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Create Directory operation");

121  
EUNSUPPORTED
;

122 
	}
}

127 
	$CFS_O≥n_Dúe˘‹y
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

128 
Fûe
 **
pDú
) {

129 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Open Directory operation");

130  
EUNSUPPORTED
;

131 
	}
}

136 
	$CFS_Sìk
(
Fûe
 *
fûe
, 
ul⁄g_t
 
pos
) {

137 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Seek operation");

138  
EUNSUPPORTED
;

139 
	}
}

146 
	$CFS_Dñëe
(
Mou¡_Poöt
 *
mp
, c⁄° *
c⁄°_∑th
, 
boﬁ
 
ªcursive
) {

147 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Delete operation");

148  
EUNSUPPORTED
;

149 
	}
}

151 
	$CFS_Ríame
(
Mou¡_Poöt
 *
mp
, c⁄° *
ﬁd∑th
,

152 c⁄° *
√w∑th
) {

153 
	`TODO_P
(
PROJECT_USER
, "chameleon file system Rename operation");

154  
EUNSUPPORTED
;

155 
	}
}

157 
	$CFS_Lök
(
Mou¡_Poöt
 *
mp
, c⁄° *
ﬁd∑th
, c⁄° *
√w∑th
) {

158 
	`TODO_P
(
PROJECT_USER
, "chameleon file system Link operation");

159  
EUNSUPPORTED
;

160 
	}
}

162 
	$CFS_SymLök
(
Mou¡_Poöt
 *
mp
, c⁄° *
ﬁd∑th
,

163 c⁄° *
√w∑th
) {

164 
	`TODO_P
(
PROJECT_USER
, "chameleon file system SymLink operation");

165  
EUNSUPPORTED
;

166 
	}
}

168 
	$CFS_SëSëUid
(
Mou¡_Poöt
 *
mp
, c⁄° *
fûe
, 
£tuid
) {

169 
Fûe
 *
pFûe
;

171 
	`TODO_P
(
PROJECT_USER
, "chameleon file system SetSetUID operation");

172  
EUNSUPPORTED
;

173 
	}
}

175 
	$CFS_SëA˛
(
Mou¡_Poöt
 *
mp
, c⁄° *
fûe
, 
uid
,

176 
≥rmissi⁄s
) {

177 
	`TODO_P
(
PROJECT_USER
, "chameleon file system SetAcl operation");

178  
EUNSUPPORTED
;

179 
	}
}

184 
	$CFS_Ród_E¡ry
(
Fûe
 *
fûe
, 
VFS_Dú_E¡ry
 *
íåy
) {

185 
	`TODO_P
(
PROJECT_CFS
, "chameleon file system Read Directory operation");

186  
EUNSUPPORTED
;

187 
	}
}

189 
Fûesy°em_Ops
 
	gs_cfsFûesy°emOps
 = {

190 &
CFS_F‹m©
,

191 &
CFS_Mou¡
,

198 
	$Inô_CFS
() {

199 
	`Regi°î_Fûesy°em
("cfs", &
s_cfsFûesy°emOps
);

200 
	}
}

	@crc32.c

9 
	~<gìkos/¸c32.h
>

10 
	~<gìkos/kas£π.h
>

12 
	#POLYNOMIAL
 (
ul⁄g_t
)0xedb88320

	)

13 
ul⁄g_t
 
	g¸c_èbÀ
[256];

20 
	$Inô_CRC32
() {

21 
i
, 
j
;

22 
ul⁄g_t
 
h
 = 1;

23 
¸c_èbÀ
[0] = 0;

24 
i
 = 128; i; i >>= 1) {

25 
h
 = (h >> 1Ë^ ((h & 1Ë? 
POLYNOMIAL
 : 0);

27 
j
 = 0; j < 256; j +2 * 
i
)

28 
¸c_èbÀ
[
i
 + 
j
] = crc_èbÀ[j] ^ 
h
;

30 
	}
}

42 
ul⁄g_t
 
	$¸c32
(
ul⁄g_t
 
¸c
, c⁄° *
buf
, 
size_t
 
Àn
) {

43 
	`KASSERT
(
¸c_èbÀ
[255] != 0);

44 
¸c
 ^= 0xffffffff;

45 
Àn
--)

46 
¸c
 = (¸¯>> 8Ë^ 
¸c_èbÀ
[(¸¯^ *
buf
++) & 0xff];

47  
¸c
 ^ 0xffffffff;

48 
	}
}

	@dma.c

35 
	~<gìkos/s¸ìn.h
>

36 
	~<gìkos/ønge.h
>

37 
	~<gìkos/öt.h
>

38 
	~<gìkos/io.h
>

39 
	~<gìkos/dma.h
>

54 
	$VALID_CHANNEL
(
ch™
) (((chan) >= 0) && ((chan) < 8))

60 
	#DMA_MAX_ADDR
 0x1000000UL

	)

61 
	#VALID_MEM
(
°¨t
,
size
Ë
	`Check_R™ge_Undî
((
ul⁄g_t
)(°¨t),(size),
DMA_MAX_ADDR
)

	)

66 
	#DMA_BASE
 0x00

	)

67 
	#DMA_COMMAND_REG
 0x08

	)

68 
	#DMA_STATUS_REG
 0x08

	)

69 
	#DMA_REQUEST_REG
 0x09

	)

70 
	#DMA_MASK_ONE_REG
(
ch™
Ë(ch™<4 ? 0x0A : 0xD4Ë

	)

71 
	#DMA_MODE_REG
(
ch™
Ë(ch™<4 ? 0x0B : 0xD6Ë

	)

72 
	#DMA_CLEAR_FF_REG
(
ch™
Ë(ch™<4 ? 0x0C : 0xD8Ë

	)

73 
	#DMA_MASTER_CLEAR_REG
 0x0D

	)

74 
	#DMA_TEMP_REG
 0x0D

	)

75 
	#DMA_CLEAR_MASK_REG
 0x0E

	)

76 
	#DMA_MASK_ALL_REG
 0x0F

	)

84 
	#DMA_ADDR_REG
(
ch™
Ë(ch™<4 ? (((ch™Ë& 0x3)<<1Ë: (0xC0 | ((ch™Ë& 0x3Ë<<2Ë)

	)

87 
	#DMA_COUNT_REG
(
ch™
Ë(
	`DMA_ADDR_REG
(ch™Ë+ (ch™<4 ? 1 : 2))

	)

92 
	#DMA_MASK_ENABLE
 (1<<2Ë

	)

97 
	#DMA_MODE_SINGLE
 0x40

	)

98 
	#DMA_MODE_CASCADE
 0xC0

	)

99 
	#DMA_MODE_READ
 0x04

	)

100 
	#DMA_MODE_WRITE
 0x08

	)

105 c⁄° 
uch¨_t
 
s_dmaPageRegi°îLi°
[] = {

114 
	}
};

116 
	#DMA_PAGE_REG
(
ch™
Ë(
s_dmaPageRegi°îLi°
[ch™]Ë

	)

118 
	#IS_RESERVED
(
ch™
Ë((
s_Æloˇãd
 & (1 << (ch™))Ë!0)

	)

121 #ifde‡
DEBUG_DMA


122 
	#Debug
(
¨gs
...Ë
	`Pröt
◊rgs)

	)

124 
	#Debug
(
¨gs
...)

	)

131 
uch¨_t
 
	gs_Æloˇãd
;

140 
	$Inô_DMA
() {

141 
	`Pröt
("Initializing DMA Controller...\n");

144 
	`Out_Byã
(
DMA_MASTER_CLEAR_REG
, 0);

145 
	}
}

152 
boﬁ
 
	$Re£rve_DMA
(
ch™
) {

153 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

154 
boﬁ
 
ªsu…
 = 
Ál£
;

156 
	`KASSERT
(
	`VALID_CHANNEL
(
ch™
));

158 i‡(!
	`IS_RESERVED
(
ch™
)) {

160 
	`Out_Byã
(
	`DMA_MASK_ONE_REG
(
ch™
), chan & 3);

163 
s_Æloˇãd
 |(1 << 
ch™
);

164 
ªsu…
 = 
åue
;

167 
	`End_I¡_Atomic
(
iÊag
);

169  
ªsu…
;

170 
	}
}

179 
	$Sëup_DMA
(
DMA_Dúe˘i⁄
 
dúe˘i⁄
, 
ch™
, *
addr_
,

180 
ul⁄g_t
 
size
) {

181 
uch¨_t
 
mode
 = 0;

182 
ul⁄g_t
 
addr
 = (ul⁄g_tË
addr_
;

185 
	`KASSERT
(
dúe˘i⁄
 =
DMA_READ
 || dúe˘i⁄ =
DMA_WRITE
);

186 
	`KASSERT
(
	`VALID_CHANNEL
(
ch™
));

187 
	`KASSERT
(
	`IS_RESERVED
(
ch™
));

188 
	`KASSERT
(
	`VALID_MEM
(
addr
, 
size
));

189 
	`KASSERT
(
size
 > 0);

191 
	`KASSERT0
((((
addr
 & 0xffffË=0 && 
size
 <= 65536)) ||

192 (
size
 <(0xfff‡- (
addr
 & 0xffff))),

196 
mode
 |
DMA_MODE_SINGLE
;

197 
mode
 |(
dúe˘i⁄
 =
DMA_READ
Ë? 
DMA_MODE_READ
 : 
DMA_MODE_WRITE
;

198 
mode
 |(
ch™
 & 3);

199 i‡(
ch™
 == 5)

200 
mode
 |= 0x10;

202 
	`Debug
("Setup_DMA(%s,%d,%x,%d)\n",

203 
dúe˘i⁄
 =
DMA_READ
 ? "DMA_READ" : "DMA_WRITE", 
ch™
, 
addr
, 
size
);

204 
	`Debug
("Sëup_DMA: mode=%02x\n", 
mode
);

205 
	`Debug
("DMA_ADDR_REG f‹ ch™√»i†%02x\n", 
	`DMA_ADDR_REG
(
ch™
));

206 
	`Debug
("DMA_PAGE_REG f‹ ch™√»i†%02x\n", 
	`DMA_PAGE_REG
(
ch™
));

207 
	`Debug
("DMA_COUNT_REG f‹ ch™√»i†%02x\n", 
	`DMA_COUNT_REG
(
ch™
));

210 
	`Mask_DMA
(
ch™
);

213 
	`Out_Byã
(
	`DMA_MODE_REG
(
ch™
), 
mode
);

216 
	`Out_Byã
(
	`DMA_CLEAR_FF_REG
(
ch™
), 0);

219 
	`Out_Byã
(
	`DMA_ADDR_REG
(
ch™
), 
addr
 & 0xFF);

220 
	`Out_Byã
(
	`DMA_ADDR_REG
(
ch™
), (
addr
 >> 8) & 0xFF);

223 
	`Out_Byã
(
	`DMA_PAGE_REG
(
ch™
), (
addr
 >> 16) & 0xFF);

229 i‡(
ch™
 > 4) {

230 
size
 >>= 1;

232 --
size
;

233 
	`Out_Byã
(
	`DMA_COUNT_REG
(
ch™
), 
size
 & 0xFF);

234 
	`Out_Byã
(
	`DMA_COUNT_REG
(
ch™
), (
size
 >> 8) & 0xFF);

237 
	`Unmask_DMA
(
ch™
);

238 
	}
}

245 
	$Mask_DMA
(
ch™
) {

246 
	`KASSERT
(
	`VALID_CHANNEL
(
ch™
));

247 
	`KASSERT
(
	`IS_RESERVED
(
ch™
));

249 
	`Out_Byã
(
	`DMA_MASK_ONE_REG
(
ch™
), (1 << 2) | (chan & 3));

250 
	}
}

257 
	$Unmask_DMA
(
ch™
) {

258 
	`KASSERT
(
	`VALID_CHANNEL
(
ch™
));

259 
	`KASSERT
(
	`IS_RESERVED
(
ch™
));

261 
	`Out_Byã
(
	`DMA_MASK_ONE_REG
(
ch™
), chan & 3);

262 
	}
}

	@elf.c

18 
	~<gìkos/î∫o.h
>

19 
	~<gìkos/kas£π.h
>

20 
	~<gìkos/kty≥s.h
>

21 
	~<gìkos/s¸ìn.h
>

22 
	~<gìkos/pÁt.h
>

23 
	~<gìkos/mÆloc.h
>

24 
	~<gìkos/°rög.h
>

25 
	~<gìkos/u£r.h
>

26 
	~<gìkos/fûeio.h
>

27 
	~<gìkos/ñf.h
>

29 
	~<gìkos/∑gög.h
>

31 
	gñfDebug
 = 0;

42 
	$P¨£_ELF_ExecuèbÀ
(*
exeFûeD©a
, 
ul⁄g_t
 
exeFûeLígth
,

43 
Exe_F‹m©
 *
exeF‹m©
) {

44 
ñfHódî
 *
hdr
;

45 
¥ogømHódî
 *
phdr
;

46 
i
;

48 
hdr
 = (
ñfHódî
 *Ë
exeFûeD©a
;

56 i‡(
exeFûeLígth
 < (
ñfHódî
) ||

57 
	`°∫cmp
(
exeFûeD©a
, "\x7F" "ELF", 4) != 0) {

58 i‡(
ñfDebug
)

59 
	`Pröt
("Notán ELFÉxecutable\n");

60  
ENOEXEC
;

63 i‡(
hdr
->
phnum
 > 
EXE_MAX_SEGMENTS
) {

64 i‡(
ñfDebug
)

65 
	`Pröt
("Toÿm™y segmít†(%dËö ELFÉxecuèbÀ\n", 
hdr
->
phnum
);

66  
ENOEXEC
;

69 i‡(
exeFûeLígth
 < 
hdr
->
phoff
 + (hdr->
phnum
 * (
¥ogømHódî
))) {

70 i‡(
ñfDebug
)

71 
	`Pröt
("NotÉnoughÑoom forÖrogram header\n");

72  
ENOEXEC
;

75 
exeF‹m©
->
numSegmíts
 = 
hdr
->
phnum
;

76 
exeF‹m©
->
íåyAddr
 = 
hdr
->
íåy
;

78 
phdr
 = (
¥ogømHódî
 *Ë(
exeFûeD©a
 + 
hdr
->
phoff
);

79 
i
 = 0; i < 
hdr
->
phnum
; ++i) {

80 
Exe_Segmít
 *
£gmít
 = &
exeF‹m©
->
£gmítLi°
[
i
];

86 
£gmít
->
off£tInFûe
 = 
phdr
[
i
].
off£t
;

87 
£gmít
->
ÀngthInFûe
 = 
phdr
[
i
].
fûeSize
;

88 
£gmít
->
°¨tAddªss
 = 
phdr
[
i
].
vaddr
;

89 
£gmít
->
sizeInMem‹y
 = 
phdr
[
i
].
memSize
;

91 i‡(
£gmít
->
ÀngthInFûe
 > segmít->
sizeInMem‹y
) {

92 i‡(
ñfDebug
)

93 
Pröt


95 
i
, 
£gmít
->
ÀngthInFûe
, segmít->
sizeInMem‹y
);

96  
ENOEXEC
;

103 
	}
}

	@floppy.c

10 
	~<gìkos/s¸ìn.h
>

11 
	~<gìkos/°rög.h
>

12 
	~<gìkos/mem.h
>

13 
	~<gìkos/mÆloc.h
>

14 
	~<gìkos/öt.h
>

15 
	~<gìkos/úq.h
>

16 
	~<gìkos/dma.h
>

17 
	~<gìkos/io.h
>

18 
	~<gìkos/timî.h
>

19 
	~<gìkos/kthªad.h
>

20 
	~<gìkos/blockdev.h
>

21 
	~<gìkos/Ê›py.h
>

58 
	#FDC_IRQ
 6

	)

63 
	#FDC_DMA
 2

	)

68 
	#FDC_BASE
 0x3F0

	)

69 
	#FDC_DOR_REG
 0x3F2

	)

70 
	#FDC_STATUS_REG
 0x3F4

	)

71 
	#FDC_DATA_RATE_SELECT_REG
 0x3F4

	)

72 
	#FDC_DATA_REG
 0x3F5

	)

77 
	#FDC_STATUS_MRQ
 (1 << 7)

	)

78 
	#FDC_STATUS_DIO
 (1 << 6)

	)

79 
	#FDC_STATUS_NDMA
 (1 << 5)

	)

80 
	#FDC_STATUS_BUSY
 (1 << 4)

	)

81 
	#FDC_STATUS_ACTIVE
(
drive
Ë(1 << (drive))

	)

82 
	#FDC_STATUS_READY_MASK
 (
FDC_STATUS_MRQ
 | 
FDC_STATUS_DIO
)

	)

83 
	#FDC_STATUS_READY_WRITE
 
FDC_STATUS_MRQ


	)

84 
	#FDC_STATUS_READY_READ
 (
FDC_STATUS_MRQ
 | 
FDC_STATUS_DIO
)

	)

89 
	#FDC_DOR_MOTOR
(
drive
Ë(1 << ((driveË+ 4))

	)

90 
	#FDC_DOR_DMA_ENABLE
 (1 << 3)

	)

91 
	#FDC_DOR_RESET_DISABLE
 (1 << 2)

	)

92 
	#FDC_DOR_DRIVE_SELECT
(
drive
Ë((driveË& 0x3)

	)

97 
	#FDC_COMMAND_CALIBRATE
 0x07

	)

98 
	#FDC_COMMAND_SENSE_INT_STATUS
 0x08

	)

99 
	#FDC_COMMAND_SEEK
 0x0F

	)

100 
	#FDC_COMMAND_WRITE_SECTOR
 0x05

	)

101 
	#FDC_COMMAND_READ_SECTOR
 0x06

	)

106 
	#FDC_MULTI_TRACK
 0x80

	)

107 
	#FDC_MFM
 0x40

	)

108 
	#FDC_SKIP_DELETED
 0x20

	)

113 
	#FDC_ST0_SEEK_END
 (1 << 5)

	)

114 
	#FDC_ST0_IS_SUCCESS
(
code
Ë((((codeË>> 6Ë& 0x3Ë=0)

	)

120 
	#CMOS_OUT
 0x70

	)

121 
	#CMOS_IN
 0x71

	)

122 
	#CMOS_FLOPPY_INDEX
 0x10

	)

124 íum { 
	mFLOPPY_READ
, 
	mFLOPPY_WRITE
 };

127 #ifde‡
FLOPPY_DEBUG


128 
	#Debug
(
¨gs
...Ë
	`Pröt
◊rgs)

	)

130 
	#Debug
(
¨gs
...)

	)

140 
	sFl›py_P¨amëîs
 {

141 
	mcylödîs
;

142 
	mhóds
;

143 
	m£˘‹s
;

144 
	m£˘‹SizeCode
;

145 
	mg≠LígthCode
;

147 
	#INVALID_FLOPPY_TYPE
 { -1, -1, -1, -1, -1 }

	)

153 
Fl›py_P¨amëîs
 
	gs_Ê›pyP¨amsTabÀ
[] = {

154 
INVALID_FLOPPY_TYPE
,

155 
INVALID_FLOPPY_TYPE
,

156 
INVALID_FLOPPY_TYPE
,

157 
INVALID_FLOPPY_TYPE
,

159 
INVALID_FLOPPY_TYPE
,

162 
	#NUM_FLOPPY_TYPES
 ((
s_Ê›pyP¨amsTabÀ
Ë/ (
Fl›py_P¨amëîs
))

	)

163 
	#IS_VALID_FLOPPY_TYPE
(
ty≥
) \

164 ((
ty≥
Ë< 
NUM_FLOPPY_TYPES
 && 
s_Ê›pyP¨amsTabÀ
[—y≥)].
cylödîs
 > 0)

	)

169 
	sFl›py_Drive
 {

170 
Fl›py_P¨amëîs
 *
	m∑øms
;

176 
Fl›py_Drive
 
	gs_driveTabÀ
[2];

182 
Thªad_Queue
 
	gs_Ê›pyI¡îru±WaôQueue
;

187 
uch¨_t
 *
	gs_å™s„rBuf
;

192 
Block_Reque°_Li°
 
	gs_Ê›pyReque°Queue
;

198 
Thªad_Queue
 
	gs_Ê›pyWaôQueue
;

207 
	$Fl›py_O≥n
(
Block_Devi˚
 *
dev
) {

208 
	`KASSERT
(!
dev
->
öU£
);

210 
	}
}

215 
	$Fl›py_Clo£
(
Block_Devi˚
 *
dev
) {

216 
	`KASSERT
(
dev
->
öU£
);

218 
	}
}

223 
	$Fl›py_Gë_Num_Blocks
(
Block_Devi˚
 *
dev
) {

224 
Fl›py_Drive
 *
drive
;

225 
Fl›py_P¨amëîs
 *
∑øms
;

227 
	`KASSERT
(
dev
->
unô
 >= 0 && dev->unit <= 1);

228 
drive
 = &
s_driveTabÀ
[
dev
->
unô
];

230 
∑øms
 = 
drive
->params;

231 
	`KASSERT
(
∑øms
 != 0);

233  
∑øms
->
cylödîs
 *Ö¨ams->
hóds
 *Ö¨ams->
£˘‹s
;

234 
	}
}

239 
Block_Devi˚_Ops
 
	gs_Ê›pyDevi˚Ops
 = {

240 
Fl›py_O≥n
,

241 
Fl›py_Clo£
,

242 
Fl›py_Gë_Num_Blocks
,

253 
	$Fl›py_I¡îru±_H™dÀr
(
I¡îru±_Sèã
 *
°©e
) {

254 
	`Begö_IRQ
(
°©e
);

255 
	`Wake_Up
(&
s_Ê›pyI¡îru±WaôQueue
);

256 
	`End_IRQ
(
°©e
);

257 
	}
}

263 
	$Sëup_Drive_P¨amëîs
(
drive
, 
ty≥
) {

264 i‡(
	`IS_VALID_FLOPPY_TYPE
(
ty≥
)) {

265 
Fl›py_P¨amëîs
 *
∑øms
 = &
s_Ê›pyP¨amsTabÀ
[
ty≥
];

266 
dev«me
[
BLOCKDEV_MAX_NAME_LEN
 + 1];

267 
rc
;

269 
	`¢¥ötf
(
dev«me
, (dev«me), "fd%d", 
drive
);

270 
	`Pröt
(" %s: cyl=%d, hóds=%d, se˘‹s=%d\n", 
dev«me
,

271 
∑øms
->
cylödîs
,Ö¨ams->
hóds
,Ö¨ams->
£˘‹s
);

272 
s_driveTabÀ
[
drive
].
∑øms
 =Öarams;

275 
rc
 = 
	`Regi°î_Block_Devi˚
(
dev«me
, &
s_Ê›pyDevi˚Ops
, 
drive
, 0,

276 &
s_Ê›pyWaôQueue
, &
s_Ê›pyReque°Queue
);

277 i‡(
rc
 != 0)

278 
	`Pröt
(" Eº‹: couldÇŸ cª©êblock devi˚ f‹ %s\n", 
dev«me
);

280 
	}
}

285 
	$LBA_To_CHS
(
Fl›py_Drive
 *
drive
, 
lba
, *
cylödî
,

286 *
hód
, *
£˘‹
) {

287 
Fl›py_P¨amëîs
 *
∑øms
 = 
drive
->params;

289 
	`KASSERT
(
∑øms
 != 0);

291 *
cylödî
 = 
lba
 / (
∑øms
->
hóds
 *Ö¨ams->
£˘‹s
);

292 *
hód
 = (
lba
 / 
∑øms
->
£˘‹s
Ë%Ö¨ams->
hóds
;

293 *
£˘‹
 = (
lba
 % 
∑øms
->
£˘‹s
) + 1;

295 
	`KASSERT
(*
cylödî
 >0 && *cylödî < 
∑øms
->
cylödîs
);

296 
	`KASSERT
(*
hód
 >0 && *hód < 
∑øms
->
hóds
);

297 
	`KASSERT
(*
£˘‹
 > 0 && *£˘‹ <
∑øms
->
£˘‹s
);

298 
	}
}

305 
	$Waô_F‹_MRQ
(
uch¨_t
 
ªadyVÆue
) {

306 
	`KASSERT
(
ªadyVÆue
 =
FDC_STATUS_READY_READ
 ||

307 
ªadyVÆue
 =
FDC_STATUS_READY_WRITE
);

310 (
	`In_Byã
(
FDC_STATUS_REG
Ë& 
FDC_STATUS_READY_MASK
Ë!
ªadyVÆue
);

313 
	}
}

318 
uch¨_t
 
	$Fl›py_In
() {

319 
	`Waô_F‹_MRQ
(
FDC_STATUS_READY_READ
);

320  
	`In_Byã
(
FDC_DATA_REG
);

321 
	}
}

326 
	$Fl›py_Out
(
uch¨_t
 
vÆ
) {

327 
	`Waô_F‹_MRQ
(
FDC_STATUS_READY_WRITE
);

328 
	`Out_Byã
(
FDC_DATA_REG
, 
vÆ
);

329 
	}
}

335 
	$Waô_F‹_I¡îru±
() {

336 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

339 
	`Waô
(&
s_Ê›pyI¡îru±WaôQueue
);

340 
	}
}

342 
	$Sí£_I¡îru±_Sètus
(
uch¨_t
 * 
°0
, uch¨_à* 
p˙
) {

343 
	`Fl›py_Out
(
FDC_COMMAND_SENSE_INT_STATUS
);

344 *
°0
 = 
	`Fl›py_In
();

345 *
p˙
 = 
	`Fl›py_In
();

346 
	}
}

351 
boﬁ
 
	$CÆibøã
(
drive
) {

352 
numAâem±s
 = 4;

353 
boﬁ
 
suc˚ss
 = 
Ál£
;

354 
uch¨_t
 
°0
, 
p˙
;

356 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

358 
numAâem±s
-- > 0) {

360 
	`Fl›py_Out
(
FDC_COMMAND_CALIBRATE
);

361 
	`Fl›py_Out
((
uch¨_t
Ë
drive
);

362 
	`Waô_F‹_I¡îru±
();

365 
	`Sí£_I¡îru±_Sètus
(&
°0
, &
p˙
);

366 
	`Debug
("CÆibøã: st0=%02x,Ö˙=%02x\n", 
°0
, 
p˙
);

367 i‡(
°0
 & 
FDC_ST0_SEEK_END
) {

368 
suc˚ss
 = 
åue
;

373 
	`Debug
("Drivê%d cÆibøti⁄ %s\n", 
drive
,

374 
suc˚ss
 ? "succeeded" : "failed");

375  
suc˚ss
;

376 
	}
}

378 
	$Sèπ_MŸ‹
(
drive
) {

379 
	`Out_Byã
(
FDC_DOR_REG
,

380 
	`FDC_DOR_MOTOR
(
drive
Ë| 
FDC_DOR_DMA_ENABLE
 | 
FDC_DOR_RESET_DISABLE


381 | 
	`FDC_DOR_DRIVE_SELECT
(0));

382 
	}
}

384 
St›_MŸ‹
(
drive
 
__©åibuã__
 ((
unu£d
))) {

385 
Out_Byã
(
FDC_DOR_REG
,

386 
FDC_DOR_DMA_ENABLE
 | 
FDC_DOR_RESET_DISABLE
 |

387 
FDC_DOR_DRIVE_SELECT
(0));

394 
boﬁ
 
	$Re£t_C⁄åﬁÀr
() {

396 
	`Out_Byã
(
FDC_DOR_REG
, 0);

403 
	`Sèπ_MŸ‹
(0);

405  
	`CÆibøã
(0);

406 
	}
}

408 
boﬁ
 
	$Fl›py_Sìk
(
drive
, 
cylödî
, 
hód
) {

409 
uch¨_t
 
°0
, 
p˙
;

410 
numAâem±s
 = 4;

411 
boﬁ
 
suc˚ss
 = 
Ál£
;

413 
	`Debug
("Fl›py_Sìk(%d,%d,%d)\n", 
drive
, 
cylödî
, 
hód
);

415 
numAâem±s
-- > 0) {

416 
	`Sèπ_MŸ‹
(
drive
);

419 
	`DißbÀ_I¡îru±s
();

421 
	`Fl›py_Out
(
FDC_COMMAND_SEEK
);

422 
	`Fl›py_Out
((
hód
 << 2Ë| (
drive
 & 3));

423 
	`Fl›py_Out
(
cylödî
 & 0xFF);

425 
	`Debug
("Seek: waiting for interrupt\n");

426 
	`Waô_F‹_I¡îru±
();

427 
	`Debug
("Seek: got interrupt\n");

429 
	`E«bÀ_I¡îru±s
();

431 
	`St›_MŸ‹
(
drive
);

433 
	`Sí£_I¡îru±_Sètus
(&
°0
, &
p˙
);

434 i‡(
°0
 & 
FDC_ST0_SEEK_END
) {

436 i‡(
p˙
 !
cylödî
) {

437 
	`Debug
("Seekárrivedát wrong cylinder\n");

439 
	`Debug
("Seek complete!\n");

440 
suc˚ss
 = 
åue
;

446  
suc˚ss
;

447 
	}
}

449 
	$Fl›py_Tøns„r
(
dúe˘i⁄
, 
driveNum
, 
blockNum
) {

450 
Fl›py_Drive
 *
drive
 = &
s_driveTabÀ
[
driveNum
];

451 
Fl›py_P¨amëîs
 *
∑øms
 = 
drive
->params;

452 
cylödî
, 
hód
, 
£˘‹
;

453 
DMA_Dúe˘i⁄
 
dmaDúe˘i⁄
 =

454 
dúe˘i⁄
 =
FLOPPY_READ
 ? 
DMA_READ
 : 
DMA_WRITE
;

455 
uch¨_t
 
comm™d
;

456 
uch¨_t
 
°0
, 
°1
, 
°2
;

457 
ªsu…
 = -1;

459 
	`KASSERT
(
driveNum
 == 0);

460 
	`KASSERT
(
dúe˘i⁄
 =
FLOPPY_READ
 || dúe˘i⁄ =
FLOPPY_WRITE
);

461 
	`KASSERT
(
∑øms
 != 0);

463 
	`LBA_To_CHS
(&
s_driveTabÀ
[
driveNum
], 
blockNum
, &
cylödî
, &
hód
, &
£˘‹
);

465 i‡(!
	`Fl›py_Sìk
(
driveNum
, 
cylödî
, 
hód
))

468 
	`DißbÀ_I¡îru±s
();

471 
	`Sëup_DMA
(
dmaDúe˘i⁄
, 
FDC_DMA
, 
s_å™s„rBuf
, 
SECTOR_SIZE
);

474 
	`Sèπ_MŸ‹
(
driveNum
);

480 
	`Mi¸o_Dñay
(8000);

482 i‡(
dúe˘i⁄
 =
FLOPPY_READ
)

483 
comm™d
 = 
FDC_COMMAND_READ_SECTOR
 | 
FDC_MFM
 | 
FDC_SKIP_DELETED
;

485 
comm™d
 = 
FDC_COMMAND_WRITE_SECTOR
 | 
FDC_MFM
;

488 
	`Fl›py_Out
(
comm™d
);

489 
	`Fl›py_Out
((
hód
 << 2Ë| (
driveNum
 & 3));

490 
	`Fl›py_Out
(
cylödî
);

491 
	`Fl›py_Out
(
hód
);

492 
	`Fl›py_Out
(
£˘‹
);

493 
	`Fl›py_Out
(
∑øms
->
£˘‹SizeCode
);

494 
	`Fl›py_Out
(
∑øms
->
£˘‹s
);

495 
	`Fl›py_Out
(
∑øms
->
g≠LígthCode
);

496 
	`Fl›py_Out
(0xFF);

499 
	`Waô_F‹_I¡îru±
();

500 
	`Debug
("Floppy_Transfer:Ñeceived interrupt!\n");

503 
°0
 = 
	`Fl›py_In
();

504 
°1
 = 
	`Fl›py_In
();

505 
°2
 = 
	`Fl›py_In
();

506 
	`Fl›py_In
();

507 
	`Fl›py_In
();

508 
	`Fl›py_In
();

509 
	`Fl›py_In
();

511 
	`St›_MŸ‹
(
driveNum
);

513 i‡(
	`FDC_ST0_IS_SUCCESS
(
°0
)) {

514 
	`Debug
("Floppy_Transfer: successfulÅransfer!\n");

515 
ªsu…
 = 0;

518 
	`E«bÀ_I¡îru±s
();

521  
ªsu…
;

522 
	}
}

524 
	$Fl›py_Ród
(
driveNum
, 
blockNum
, *
buf„r
) {

525 
rc
;

527 
	`Debug
("Fl›py_Ród(%d,%d,%x)\n", 
driveNum
, 
blockNum
, 
buf„r
);

529 #i‚de‡
NDEBUG


530 
	`mem£t
(
buf„r
, ()0xcd, 
SECTOR_SIZE
);

531 
	`mem£t
(
s_å™s„rBuf
, ()0xcd, 
SECTOR_SIZE
);

534 
rc
 = 
	`Fl›py_Tøns„r
(
FLOPPY_READ
, 
driveNum
, 
blockNum
);

536 i‡(
rc
 == 0) {

541 
	`mem˝y
(
buf„r
, 
s_å™s„rBuf
, 
SECTOR_SIZE
);

544  
rc
;

545 
	}
}

547 
	$Fl›py_Wrôe
(
driveNum
, 
blockNum
, *
buf„r
) {

548 
	`Debug
("Fl›py_Wrôe(%d,%d,%x)\n", 
driveNum
, 
blockNum
, 
buf„r
);

550 
	`mem˝y
(
s_å™s„rBuf
, 
buf„r
, 
SECTOR_SIZE
);

551  
	`Fl›py_Tøns„r
(
FLOPPY_WRITE
, 
driveNum
, 
blockNum
);

552 
	}
}

557 
Fl›py_Reque°_Thªad
(
ul⁄g_t
 
¨g
 
__©åibuã__
 ((
unu£d
))) {

558 
	grc
;

560 
Debug
("FRQ: FloppyÑequestÅhread starting...\n");

563 
Block_Reque°
 *
	gªque°
;

566 
Debug
("FRQ: RequestÅhread waiting foráÑequest\n");

567 
	gªque°
 = 
Dequeue_Reque°
(&
s_Ê›pyReque°Queue
, &
s_Ê›pyWaôQueue
);

568 
Debug
("FRQ: GŸá fl›pyÑeque° [@%x]\n", 
ªque°
);

569 
KASSERT
(
ªque°
->
ty≥
 =
BLOCK_READ
 ||Ñeque°->ty≥ =
BLOCK_WRITE
);

572 i‡(
	gªque°
->
	gty≥
 =
BLOCK_READ
)

573 
rc
 = 
Fl›py_Ród
(
ªque°
->
dev
->
unô
,Ñeque°->
blockNum
,

574 
ªque°
->
buf
);

576 
	grc
 = 
Fl›py_Wrôe
(
ªque°
->
dev
->
unô
,Ñeque°->
blockNum
,

577 
ªque°
->
buf
);

580 
Debug
("FRQ: NotifyingÑequestingÅhread...\n");

581 
NŸify_Reque°_Com∂ëi⁄
(
ªque°
, 
rc
 =0 ? 
COMPLETED
 : 
ERROR
,Ñc);

582 
Debug
("FRQ: Completed floppyÑequest\n");

593 
	$Inô_Fl›py
() {

594 
uch¨_t
 
Ê›pyByã
;

595 
boﬁ
 
ªady
 = 
Ál£
;

596 
boﬁ
 
good
;

598 
	`Pröt
("Initializing floppy controller...\n");

601 
s_å™s„rBuf
 = (
uch¨_t
 *Ë
	`AŒoc_Page
();

604 
	`Out_Byã
(
CMOS_OUT
, 
CMOS_FLOPPY_INDEX
);

605 
Ê›pyByã
 = 
	`In_Byã
(
CMOS_IN
);

606 
	`Sëup_Drive_P¨amëîs
(0, (
Ê›pyByã
 >> 4) & 0xF);

607 
	`Sëup_Drive_P¨amëîs
(1, 
Ê›pyByã
 & 0xF);

610 
	`In°Æl_IRQ
(
FDC_IRQ
, &
Fl›py_I¡îru±_H™dÀr
);

611 
	`E«bÀ_IRQ
(
FDC_IRQ
);

614 
	`DißbÀ_I¡îru±s
();

615 
good
 = 
	`Re£t_C⁄åﬁÀr
();

616 
	`E«bÀ_I¡îru±s
();

617 i‡(!
good
) {

618 
	`Pröt
(" FailedÅoÑeset controller!\n");

619 
d⁄e
;

623 i‡(!
	`Re£rve_DMA
(
FDC_DMA
)) {

624 
	`Pröt
(" FailedÅoÑeserve DMA channel\n");

625 
d⁄e
;

632 
ªady
 = 
åue
;

633 
	`Sèπ_Kî√l_Thªad
(
Fl›py_Reque°_Thªad
, 0, 
PRIORITY_NORMAL
, 
åue
,

637 
d⁄e
:

638 i‡(!
ªady
)

639 
	`Pröt
(" Floppy controller initialization FAILED\n");

641 
	`Pröt
(" Floppy controller initialization complete\n");

642 
	}
}

	@gdt.c

10 
	~<gìkos/kas£π.h
>

11 
	~<gìkos/£gmít.h
>

12 
	~<gìkos/öt.h
>

13 
	~<gìkos/tss.h
>

14 
	~<gìkos/gdt.h
>

19 
Lﬂd_GDTR
(
ush‹t_t
 * 
limôAndBa£
);

29 
	#NUM_GDT_ENTRIES
 32

	)

34 
Segmít_Des¸ùt‹
 
	gs_GDT
[
NUM_GDT_ENTRIES
];

39 
	gs_numAŒoˇãd
 = 0;

49 
Segmít_Des¸ùt‹
 *
	$AŒoˇã_Segmít_Des¸ùt‹
() {

50 
Segmít_Des¸ùt‹
 *
ªsu…
 = 0;

51 
i
;

52 
boﬁ
 
iÊag
;

54 
iÊag
 = 
	`Begö_I¡_Atomic
();

57 
i
 = 1; i < 
NUM_GDT_ENTRIES
; ++i) {

58 
Segmít_Des¸ùt‹
 *
desc
 = &
s_GDT
[
i
];

59 i‡(
desc
->
avaû
) {

60 ++
s_numAŒoˇãd
;

61 
desc
->
avaû
 = 0;

62 
ªsu…
 = 
desc
;

67 
	`End_I¡_Atomic
(
iÊag
);

69  
ªsu…
;

70 
	}
}

75 
	$Fªe_Segmít_Des¸ùt‹
(
Segmít_Des¸ùt‹
 *
desc
) {

76 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

78 
	`KASSERT
(!
desc
->
avaû
);

80 
	`Inô_NuŒ_Segmít_Des¸ùt‹
(
desc
);

81 
desc
->
avaû
 = 1;

82 --
s_numAŒoˇãd
;

84 
	`End_I¡_Atomic
(
iÊag
);

85 
	}
}

90 
	$Gë_Des¸ùt‹_Index
(
Segmít_Des¸ùt‹
 *
desc
) {

91  ()(
desc
 - 
s_GDT
);

92 
	}
}

97 
	$Inô_GDT
(
˝uid
) {

98 
ush‹t_t
 
limôAndBa£
[3];

99 
ul⁄g_t
 
gdtBa£Addr
 = (ul⁄g_tË
s_GDT
;

100 
Segmít_Des¸ùt‹
 *
desc
;

101 
i
;

103 
	`KASSERT
((
Segmít_Des¸ùt‹
) == 8);

106 i‡(!
˝uid
) {

108 
i
 = 0; i < 
NUM_GDT_ENTRIES
; ++i) {

109 
desc
 = &
s_GDT
[
i
];

110 
	`Inô_NuŒ_Segmít_Des¸ùt‹
(
desc
);

111 
desc
->
avaû
 = 1;

115 
desc
 = 
	`AŒoˇã_Segmít_Des¸ùt‹
();

116 
	`Inô_Code_Segmít_Des¸ùt‹
(
desc
, 0,

120 
	`KASSERT
(
	`Gë_Des¸ùt‹_Index
(
desc
Ë=(
KERNEL_CS
 >> 3));

123 
desc
 = 
	`AŒoˇã_Segmít_Des¸ùt‹
();

124 
	`Inô_D©a_Segmít_Des¸ùt‹
(
desc
, 0,

128 
	`KASSERT
(
	`Gë_Des¸ùt‹_Index
(
desc
Ë=(
KERNEL_DS
 >> 3));

132 
limôAndBa£
[0] = (
Segmít_Des¸ùt‹
Ë* 
NUM_GDT_ENTRIES
;

133 
limôAndBa£
[1] = 
gdtBa£Addr
 & 0xffff;

134 
limôAndBa£
[2] = 
gdtBa£Addr
 >> 16;

135 
	`Lﬂd_GDTR
(
limôAndBa£
);

136 
	}
}

	@gfs2.c

15 
	~<limôs.h
>

16 
	~<gìkos/î∫o.h
>

17 
	~<gìkos/kas£π.h
>

18 
	~<gìkos/s¸ìn.h
>

19 
	~<gìkos/mÆloc.h
>

20 
	~<gìkos/°rög.h
>

21 
	~<gìkos/bô£t.h
>

22 
	~<gìkos/synch.h
>

23 
	~<gìkos/bufˇche.h
>

24 
	~<gìkos/gfs2.h
>

25 
	~<gìkos/¥oje˘s.h
>

39 
	$GFS2_FSèt
(
Fûe
 *
fûe
, 
VFS_Fûe_Sèt
 *
°©
) {

40 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem FStat operation");

42 
	}
}

47 
	$GFS2_Ród
(
Fûe
 *
fûe
, *
buf
, 
ul⁄g_t
 
numByãs
) {

48 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystemÑead operation");

50  
EUNSUPPORTED
;

51 
	}
}

56 
	$GFS2_Wrôe
(
Fûe
 *
fûe
, *
buf
, 
ul⁄g_t
 
numByãs
) {

57 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem write operation");

58  
EUNSUPPORTED
;

59 
	}
}

65 
	$GFS2_Sìk
(
Fûe
 *
fûe
, 
ul⁄g_t
 
pos
) {

66 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem seek operation");

67  
EUNSUPPORTED
;

68 
	}
}

73 
	$GFS2_Clo£
(
Fûe
 *
fûe
) {

74 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem close operation");

75  
EUNSUPPORTED
;

76 
	}
}

78  
Fûe_Ops
 
	gs_gfs2FûeOps
 = {

79 &
GFS2_FSèt
,

80 &
GFS2_Ród
,

81 &
GFS2_Wrôe
,

82 &
GFS2_Sìk
,

83 &
GFS2_Clo£
,

90 
	$GFS2_FSèt_Dúe˘‹y
(
Fûe
 *
dú
, 
VFS_Fûe_Sèt
 *
°©
) {

92 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem FStat directory operation");

94 
	}
}

99 
	$GFS2_Clo£_Dúe˘‹y
(
Fûe
 *
dú
) {

100 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem Close directory operation");

101  
EUNSUPPORTED
;

102 
	}
}

107 
	$GFS2_Ród_E¡ry
(
Fûe
 *
dú
, 
VFS_Dú_E¡ry
 *
íåy
) {

108 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem Read_Entry operation");

109  
EUNSUPPORTED
;

110 
	}
}

112  
Fûe_Ops
 
	gs_gfs2DúOps
 = {

113 &
GFS2_FSèt
,

117 &
GFS2_Clo£_Dúe˘‹y
,

118 &
GFS2_Ród_E¡ry
,

126 
	$GFS2_O≥n
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

127 
mode
, 
Fûe
 **
pFûe
) {

128 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem open operation");

129  
EUNSUPPORTED
;

130 
	}
}

135 
	$GFS2_Cª©e_Dúe˘‹y
(
Mou¡_Poöt
 *
mou¡Poöt
,

136 c⁄° *
∑th
) {

137 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem create directory operation");

138  
EUNSUPPORTED
;

139 
	}
}

144 
	$GFS2_O≥n_Dúe˘‹y
(
Mou¡_Poöt
 *
mou¡Poöt
,

145 c⁄° *
∑th
, 
Fûe
 **
pDú
) {

146 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem open directory operation");

147  
EUNSUPPORTED
;

148 
	}
}

153 
	$GFS2_Dñëe
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

154 
boﬁ
 
ªcursive
) {

155 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem delete operation");

156  
EUNSUPPORTED
;

157 
	}
}

162 
	$GFS2_Sèt
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

163 
VFS_Fûe_Sèt
 *
°©
) {

164 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem stat operation");

165  
EUNSUPPORTED
;

166 
	}
}

172 
	$GFS2_Sync
(
Mou¡_Poöt
 *
mou¡Poöt
) {

173 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem sync operation");

174  
EUNSUPPORTED
;

175 
	}
}

177 
	$GFS2_Disk_Pr›îtõs
(
Mou¡_Poöt
 *
mou¡Poöt
,

178 *
block_size
,

179 *
blocks_ö_disk
) {

180 
	`TODO_P
(
PROJECT_GFS2
,

182  
EUNSUPPORTED
;

183 
	}
}

185  
Mou¡_Poöt_Ops
 
	gs_gfs2Mou¡PoötOps
 = {

186 &
GFS2_O≥n
,

187 &
GFS2_Cª©e_Dúe˘‹y
,

188 &
GFS2_O≥n_Dúe˘‹y
,

189 &
GFS2_Sèt
,

190 &
GFS2_Sync
,

191 &
GFS2_Dñëe
,

197 &
GFS2_Disk_Pr›îtõs
,

200 
GFS2_F‹m©
(
Block_Devi˚
 *
blockDev
 
__©åibuã__
 ((
unu£d
))) {

201 
TODO_P
(
PROJECT_GFS2
,

203  
	gEUNSUPPORTED
;

206 
	$GFS2_Mou¡
(
Mou¡_Poöt
 *
mou¡Poöt
) {

207 
	`TODO_P
(
PROJECT_GFS2
, "GeekOS filesystem mount operation");

208  
EUNSUPPORTED
;

209 
	}
}

212 
Fûesy°em_Ops
 
	gs_gfs2Fûesy°emOps
 = {

213 &
GFS2_F‹m©
,

214 &
GFS2_Mou¡
,

221 
	$Inô_GFS2
() {

222 
	`Regi°î_Fûesy°em
("gfs2", &
s_gfs2Fûesy°emOps
);

223 
	}
}

	@gosfs.c

13 
	~<limôs.h
>

14 
	~<gìkos/î∫o.h
>

15 
	~<gìkos/kas£π.h
>

16 
	~<gìkos/s¸ìn.h
>

17 
	~<gìkos/mÆloc.h
>

18 
	~<gìkos/°rög.h
>

19 
	~<gìkos/bô£t.h
>

20 
	~<gìkos/synch.h
>

21 
	~<gìkos/bufˇche.h
>

22 
	~<gìkos/li°.h
>

23 
	~<gìkos/gosfs.h
>

24 
	~<gìkos/vfs.h
>

25 
	~<gìkos/°rög.h
>

26 
	~<gìkos/¥oje˘s.h
>

35 
	$GOSFS_F‹m©
(
Block_Devi˚
 *
blockDev
) {

36 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Format operation");

37  
EUNSUPPORTED
;

38 
	}
}

44 
	$GOSFS_Mou¡
(
Mou¡_Poöt
 *
mou¡Poöt
) {

45 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Mount operation");

46  
EUNSUPPORTED
;

47 
	}
}

52 
	$GOSFS_FSèt
(
Fûe
 *
fûe
, 
VFS_Fûe_Sèt
 *
°©
) {

53 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system FStat operation");

54  
EUNSUPPORTED
;

55 
	}
}

61 
	$GOSFS_O≥n
(
Mou¡_Poöt
 *
mp
, c⁄° *
c⁄°_∑th
, 
mode
,

62 
Fûe
 **
pFûe
) {

63 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Open operation");

64  
EUNSUPPORTED
;

65 
	}
}

71 
	$GOSFS_Ród
(
Fûe
 *
fûe
, *
±r
, 
ul⁄g_t
 
numByãs
) {

72 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Read operation");

73  
EUNSUPPORTED
;

74 
	}
}

80 
	$GOSFS_Wrôe
(
Fûe
 *
fûe
, *
±r
, 
ul⁄g_t
 
numByãs
) {

81 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Write operation");

82  
EUNSUPPORTED
;

83 
	}
}

88 
	$GOSFS_Sèt
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

89 
VFS_Fûe_Sèt
 *
°©
) {

90 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Stat operation");

91  
EUNSUPPORTED
;

92 
	}
}

98 
	$GOSFS_Sync
(
Mou¡_Poöt
 *
mou¡Poöt
) {

99 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Sync operation");

100  
EUNSUPPORTED
;

101 
	}
}

106 
	$GOSFS_Clo£
(
Fûe
 *
fûe
) {

107 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Close operation");

108  
EUNSUPPORTED
;

109 
	}
}

114 
	$GOSFS_Cª©e_Dúe˘‹y
(
Mou¡_Poöt
 *
mp
, c⁄° *
c⁄°_∑th
) {

115 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Create Directory operation");

116  
EUNSUPPORTED
;

117 
	}
}

122 
	$GOSFS_O≥n_Dúe˘‹y
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

123 
Fûe
 **
pDú
) {

124 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Open Directory operation");

125  
EUNSUPPORTED
;

126 
	}
}

131 
	$GOSFS_Sìk
(
Fûe
 *
fûe
, 
ul⁄g_t
 
pos
) {

132 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Seek operation");

133  
EUNSUPPORTED
;

134 
	}
}

140 
	$GOSFS_Dñëe
(
Mou¡_Poöt
 *
mp
, c⁄° *
c⁄°_∑th
,

141 
boﬁ
 
ªcursive
) {

142 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Delete operation");

143  
EUNSUPPORTED
;

144 
	}
}

147 
	$GOSFS_SëSëUid
(
Mou¡_Poöt
 *
mp
, c⁄° *
fûe
, 
£tuid
) {

148 
Fûe
 *
pFûe
;

150 
	`TODO_P
(
PROJECT_USER
, "GeekOS file system SetSetUID operation");

151  
EUNSUPPORTED
;

152 
	}
}

154 
	$GOSFS_SëA˛
(
Mou¡_Poöt
 *
mp
, c⁄° *
fûe
, 
uid
,

155 
≥rmissi⁄s
) {

156 
	`TODO_P
(
PROJECT_USER
, "GeekOS file system SetAcl operation");

157  
EUNSUPPORTED
;

158 
	}
}

163 
	$GOSFS_Ród_E¡ry
(
Fûe
 *
fûe
, 
VFS_Dú_E¡ry
 *
íåy
) {

164 
	`TODO_P
(
PROJECT_GOSFS
, "GeekOS file system Read Directory operation");

165  
EUNSUPPORTED
;

166 
	}
}

168 
Fûesy°em_Ops
 
	gs_gosfsFûesy°emOps
 = {

169 &
GOSFS_F‹m©
,

170 &
GOSFS_Mou¡
,

177 
	$Inô_GOSFS
() {

178 
	`Regi°î_Fûesy°em
("gosfs", &
s_gosfsFûesy°emOps
);

179 
	}
}

	@ide.c

21 
	~<gìkos/kty≥s.h
>

22 
	~<gìkos/kas£π.h
>

23 
	~<gìkos/î∫o.h
>

24 
	~<gìkos/mÆloc.h
>

25 
	~<gìkos/°rög.h
>

26 
	~<gìkos/io.h
>

27 
	~<gìkos/öt.h
>

28 
	~<gìkos/s¸ìn.h
>

29 
	~<gìkos/timî.h
>

30 
	~<gìkos/kthªad.h
>

31 
	~<gìkos/blockdev.h
>

32 
	~<gìkos/ide.h
>

35 
	#IDE_DATA_REGISTER
 0x1f0

	)

36 
	#IDE_ERROR_REGISTER
 0x1f1

	)

37 
	#IDE_FEATURE_REG
 
IDE_ERROR_REGISTER


	)

38 
	#IDE_SECTOR_COUNT_REGISTER
 0x1f2

	)

39 
	#IDE_SECTOR_NUMBER_REGISTER
 0x1f3

	)

40 
	#IDE_CYLINDER_LOW_REGISTER
 0x1f4

	)

41 
	#IDE_CYLINDER_HIGH_REGISTER
 0x1f5

	)

42 
	#IDE_DRIVE_HEAD_REGISTER
 0x1f6

	)

43 
	#IDE_STATUS_REGISTER
 0x1f7

	)

44 
	#IDE_COMMAND_REGISTER
 0x1f7

	)

45 
	#IDE_DEVICE_CONTROL_REGISTER
 0x3F6

	)

48 
	#IDE_DRIVE_BASE
 0xa0

	)

49 
	#IDE_DRIVE
(
driveNum
Ë(
IDE_DRIVE_BASE
 | (driveNum <<4))

	)

50 
	#IDE_MAX_DRIVES
 4

	)

54 
	#IDE_COMMAND_IDENTIFY_DRIVE
 0xEC

	)

55 
	#IDE_COMMAND_SEEK
 0x70

	)

56 
	#IDE_COMMAND_READ_SECTORS
 0x21

	)

57 
	#IDE_COMMAND_READ_BUFFER
 0xE4

	)

58 
	#IDE_COMMAND_WRITE_SECTORS
 0x30

	)

59 
	#IDE_COMMAND_WRITE_BUFFER
 0xE8

	)

60 
	#IDE_COMMAND_DIAGNOSTIC
 0x90

	)

61 
	#IDE_COMMAND_ATAPI_IDENT_DRIVE
 0xA1

	)

64 
	#IDE_INDENTIFY_NUM_CYLINDERS
 0x01

	)

65 
	#IDE_INDENTIFY_NUM_HEADS
 0x03

	)

66 
	#IDE_INDENTIFY_NUM_BYTES_TRACK
 0x04

	)

67 
	#IDE_INDENTIFY_NUM_BYTES_SECTOR
 0x05

	)

68 
	#IDE_INDENTIFY_NUM_SECTORS_TRACK
 0x06

	)

71 
	#IDE_STATUS_DRIVE_BUSY
 0x80

	)

72 
	#IDE_STATUS_DRIVE_READY
 0x40

	)

73 
	#IDE_STATUS_DRIVE_WRITE_FAULT
 0x20

	)

74 
	#IDE_STATUS_DRIVE_SEEK_COMPLETE
 0x10

	)

75 
	#IDE_STATUS_DRIVE_DATA_REQUEST
 0x08

	)

76 
	#IDE_STATUS_DRIVE_CORRECTED_DATA
 0x04

	)

77 
	#IDE_STATUS_DRIVE_INDEX
 0x02

	)

78 
	#IDE_STATUS_DRIVE_ERROR
 0x01

	)

81 
	#IDE_DCR_NOINTERRUPT
 0x02

	)

82 
	#IDE_DCR_RESET
 0x04

	)

85 
	#IDE_ERROR_NO_ERROR
 0

	)

86 
	#IDE_ERROR_BAD_DRIVE
 -1

	)

87 
	#IDE_ERROR_INVALID_BLOCK
 -2

	)

88 
	#IDE_ERROR_DRIVE_ERROR
 -3

	)

91 
	#IDE_CONTROL_REGISTER
 0x3F6

	)

92 
	#IDE_CONTROL_SOFTWARE_RESET
 0x04

	)

93 
	#IDE_CONTROL_INT_DISABLE
 0x02

	)

95 
	#LOW_BYTE
(
x
Ë(x & 0xff)

	)

96 
	#HIGH_BYTE
(
x
Ë((x >> 8Ë& 0xff)

	)

99 
	mnum_Cylödîs
;

100 
	mnum_Hóds
;

101 
	mnum_Se˘‹sPîTøck
;

102 
	mnum_ByãsPîSe˘‹
;

103 } 
	tideDisk
;

105 
	gideDebug
 = 0;

106 
	gnumDrives
;

107 
ideDisk
 
	gdrives
[
IDE_MAX_DRIVES
];

109 
Thªad_Queue
 
	gs_ideWaôQueue
;

110 
Block_Reque°_Li°
 
	gs_ideReque°Queue
;

116 
	$IDE_gëNumBlocks
(
driveNum
) {

117 i‡(
driveNum
 < 0 || driveNum > 
IDE_MAX_DRIVES
) {

118  
IDE_ERROR_BAD_DRIVE
;

121  (
drives
[
driveNum
].
num_Hóds
 *

122 
drives
[
driveNum
].
num_Se˘‹sPîTøck
 *

123 
drives
[
driveNum
].
num_Cylödîs
);

124 
	}
}

129 
	$IDE_Ród
(
driveNum
, 
blockNum
, *
buf„r
) {

130 
i
;

131 
hód
;

132 
£˘‹
;

133 
cylödî
;

134 *
buf„rW
;

135 
ªE«bÀ
 = 0;

137 i‡(
driveNum
 < 0 || driveNum > (
numDrives
 - 1)) {

138 i‡(
ideDebug
)

139 
	`Pröt
("ide: invÆid drivê%d\n", 
driveNum
);

140  
IDE_ERROR_BAD_DRIVE
;

143 i‡(
blockNum
 < 0 || blockNum >
	`IDE_gëNumBlocks
(
driveNum
)) {

144 i‡(
ideDebug
)

145 
	`Pröt
("ide: invÆid block %d\n", 
blockNum
);

146  
IDE_ERROR_INVALID_BLOCK
;

149 i‡(
	`I¡îru±s_E«bÀd
()) {

150 
	`DißbÀ_I¡îru±s
();

151 
ªE«bÀ
 = 1;

155 
£˘‹
 = 
blockNum
 % 
drives
[
driveNum
].
num_Se˘‹sPîTøck
 + 1;

156 
cylödî
 = 
blockNum
 / (
drives
[
driveNum
].
num_Hóds
 *

157 
drives
[
driveNum
].
num_Se˘‹sPîTøck
);

158 
hód
 = (
blockNum
 / 
drives
[
driveNum
].
num_Se˘‹sPîTøck
) %

159 
drives
[
driveNum
].
num_Hóds
;

161 i‡(
ideDebug
 >= 2) {

162 
	`Pröt
("ªque°Åÿªad block %d\n", 
blockNum
);

163 
	`Pröt
(" hód %d\n", 
hód
);

164 
	`Pröt
(" cylödî %d\n", 
cylödî
);

165 
	`Pröt
(" se˘‹ %d\n", 
£˘‹
);

168 
	`Out_Byã
(
IDE_SECTOR_COUNT_REGISTER
, 1);

169 
	`Out_Byã
(
IDE_SECTOR_NUMBER_REGISTER
, 
£˘‹
);

170 
	`Out_Byã
(
IDE_CYLINDER_LOW_REGISTER
, 
	`LOW_BYTE
(
cylödî
));

171 
	`Out_Byã
(
IDE_CYLINDER_HIGH_REGISTER
, 
	`HIGH_BYTE
(
cylödî
));

172 
	`Out_Byã
(
IDE_DRIVE_HEAD_REGISTER
, 
	`IDE_DRIVE
(
driveNum
Ë| 
hód
);

174 
	`Out_Byã
(
IDE_COMMAND_REGISTER
, 
IDE_COMMAND_READ_SECTORS
);

176 i‡(
ideDebug
 > 2)

177 
	`Pröt
("AboutÅo wait for Read \n");

180 
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_BUSY
);

182 i‡(
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_ERROR
) {

183 
	`Pröt
("ERROR: GŸ Ród %d\n", 
	`In_Byã
(
IDE_STATUS_REGISTER
));

184  
IDE_ERROR_DRIVE_ERROR
;

187 i‡(
ideDebug
 > 2)

188 
	`Pröt
("got buffer \n");

190 
buf„rW
 = (*)
buf„r
;

191 
i
 = 0; i < 256; i++) {

192 
buf„rW
[
i
] = 
	`In_W‹d
(
IDE_DATA_REGISTER
);

195 i‡(
ªE«bÀ
)

196 
	`E«bÀ_I¡îru±s
();

198  
IDE_ERROR_NO_ERROR
;

199 
	}
}

204 
	$IDE_Wrôe
(
driveNum
, 
blockNum
, *
buf„r
) {

205 
i
;

206 
hód
;

207 
£˘‹
;

208 
cylödî
;

209 *
buf„rW
;

210 
ªE«bÀ
 = 0;

212 i‡(
driveNum
 < 0 || driveNum > (
numDrives
 - 1)) {

213  
IDE_ERROR_BAD_DRIVE
;

216 i‡(
blockNum
 < 0 || blockNum >
	`IDE_gëNumBlocks
(
driveNum
)) {

217  
IDE_ERROR_INVALID_BLOCK
;

220 i‡(
	`I¡îru±s_E«bÀd
()) {

221 
	`DißbÀ_I¡îru±s
();

222 
ªE«bÀ
 = 1;

226 
£˘‹
 = 
blockNum
 % 
drives
[
driveNum
].
num_Se˘‹sPîTøck
 + 1;

227 
cylödî
 = 
blockNum
 / (
drives
[
driveNum
].
num_Hóds
 *

228 
drives
[
driveNum
].
num_Se˘‹sPîTøck
);

229 
hód
 = (
blockNum
 / 
drives
[
driveNum
].
num_Se˘‹sPîTøck
) %

230 
drives
[
driveNum
].
num_Hóds
;

232 i‡(
ideDebug
) {

233 
	`Pröt
("ªque°Åÿwrôêblock %d\n", 
blockNum
);

234 
	`Pröt
(" hód %d\n", 
hód
);

235 
	`Pröt
(" cylödî %d\n", 
cylödî
);

236 
	`Pröt
(" se˘‹ %d\n", 
£˘‹
);

239 
	`Out_Byã
(
IDE_SECTOR_COUNT_REGISTER
, 1);

240 
	`Out_Byã
(
IDE_SECTOR_NUMBER_REGISTER
, 
£˘‹
);

241 
	`Out_Byã
(
IDE_CYLINDER_LOW_REGISTER
, 
	`LOW_BYTE
(
cylödî
));

242 
	`Out_Byã
(
IDE_CYLINDER_HIGH_REGISTER
, 
	`HIGH_BYTE
(
cylödî
));

243 
	`Out_Byã
(
IDE_DRIVE_HEAD_REGISTER
, 
	`IDE_DRIVE
(
driveNum
Ë| 
hód
);

245 
	`Out_Byã
(
IDE_COMMAND_REGISTER
, 
IDE_COMMAND_WRITE_SECTORS
);

249 
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_BUSY
);

251 
buf„rW
 = (*)
buf„r
;

252 
i
 = 0; i < 256; i++) {

253 
	`Out_W‹d
(
IDE_DATA_REGISTER
, 
buf„rW
[
i
]);

256 i‡(
ideDebug
)

257 
	`Pröt
("AboutÅo wait for Write \n");

260 
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_BUSY
);

262 i‡(
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_ERROR
) {

263 
	`Pröt
("ERROR: GŸ Ród %d\n", 
	`In_Byã
(
IDE_STATUS_REGISTER
));

264  
IDE_ERROR_DRIVE_ERROR
;

267 i‡(
ideDebug
)

268 
	`Pröt
("write completed \n");

270 i‡(
ªE«bÀ
)

271 
	`E«bÀ_I¡îru±s
();

273  
IDE_ERROR_NO_ERROR
;

274 
	}
}

276 
	$IDE_O≥n
(
Block_Devi˚
 *
dev
) {

277 
	`KASSERT
(!
dev
->
öU£
);

279 
	}
}

281 
	$IDE_Clo£
(
Block_Devi˚
 *
dev
) {

282 
	`KASSERT
(
dev
->
öU£
);

284 
	}
}

286 
	$IDE_Gë_Num_Blocks
(
Block_Devi˚
 *
dev
) {

287  
	`IDE_gëNumBlocks
(
dev
->
unô
);

288 
	}
}

290 
Block_Devi˚_Ops
 
	gs_ideDevi˚Ops
 = {

291 
IDE_O≥n
,

292 
IDE_Clo£
,

293 
IDE_Gë_Num_Blocks
,

296 
IDE_Reque°_Thªad
(
ul⁄g_t
 
¨g
 
__©åibuã__
 ((
unu£d
))) {

298 
Block_Reque°
 *
	gªque°
;

299 
	grc
;

302 
	gªque°
 = 
Dequeue_Reque°
(&
s_ideReque°Queue
, &
s_ideWaôQueue
);

305 i‡(
	gªque°
->
	gty≥
 =
BLOCK_READ
)

306 
rc
 = 
IDE_Ród
(
ªque°
->
dev
->
unô
,Ñeque°->
blockNum
,

307 
ªque°
->
buf
);

309 
	grc
 = 
IDE_Wrôe
(
ªque°
->
dev
->
unô
,Ñeque°->
blockNum
,

310 
ªque°
->
buf
);

313 
NŸify_Reque°_Com∂ëi⁄
(
ªque°
, 
rc
 =0 ? 
COMPLETED
 : 
ERROR
,Ñc);

317 
	$ªadDriveC⁄fig
(
drive
) {

318 
i
;

319 
°©us
;

320 
öfo
[256];

321 
dev«me
[
BLOCKDEV_MAX_NAME_LEN
];

322 
rc
;

324 i‡(
ideDebug
 > 1)

325 
	`Pröt
("ide:ábouàtÿªad drivêc⁄fig f‹ drivê#%d\n", 
drive
);

327 
	`Out_Byã
(
IDE_DRIVE_HEAD_REGISTER
, 
	`IDE_DRIVE
(
drive
));

328 
	`Out_Byã
(
IDE_COMMAND_REGISTER
, 
IDE_COMMAND_IDENTIFY_DRIVE
);

329 
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_BUSY
);

331 
°©us
 = 
	`In_Byã
(
IDE_STATUS_REGISTER
);

336 i‡((
°©us
 & 
IDE_STATUS_DRIVE_DATA_REQUEST
)) {

337 
	`Pröt
("ide:Örobe found ATA drive: ");

339 
i
 = 0; i < 256; i++) {

340 
öfo
[
i
] = 
	`In_W‹d
(
IDE_DATA_REGISTER
);

343 
drives
[
drive
].
num_Cylödîs
 = 
öfo
[
IDE_INDENTIFY_NUM_CYLINDERS
];

344 
drives
[
drive
].
num_Hóds
 = 
öfo
[
IDE_INDENTIFY_NUM_HEADS
];

345 
drives
[
drive
].
num_Se˘‹sPîTøck
 =

346 
öfo
[
IDE_INDENTIFY_NUM_SECTORS_TRACK
];

347 
drives
[
drive
].
num_ByãsPîSe˘‹
 =

348 
öfo
[
IDE_INDENTIFY_NUM_BYTES_SECTOR
];

351 
	`Out_Byã
(
IDE_FEATURE_REG
, 0);

353 
	`Out_Byã
(
IDE_DRIVE_HEAD_REGISTER
, 
	`IDE_DRIVE
(
drive
));

354 
	`Out_Byã
(
IDE_COMMAND_REGISTER
, 
IDE_COMMAND_ATAPI_IDENT_DRIVE
);

355 
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_BUSY
);

356 
°©us
 = 
	`In_Byã
(
IDE_STATUS_REGISTER
);

357 
	`Pröt
("°©u†i†%x\n", 
°©us
);

358 i‡((
°©us
 & 
IDE_STATUS_DRIVE_DATA_REQUEST
)) {

359 
	`Pröt
("ide: foundátapi drive\n");

361 
	`Pröt
("ide: foundÇÿdrivê%d\n", 
drive
);

366 
	`Pröt
(" ide%d: cyl=%d, hóds=%d, se˘‹s=%d\n", 
drive
,

367 
drives
[
drive
].
num_Cylödîs
, drives[drive].
num_Hóds
,

368 
drives
[
drive
].
num_Se˘‹sPîTøck
);

371 
	`¢¥ötf
(
dev«me
, (dev«me), "ide%d", 
drive
);

372 
rc
 = 
	`Regi°î_Block_Devi˚
(
dev«me
, &
s_ideDevi˚Ops
, 
drive
, 0,

373 &
s_ideWaôQueue
, &
s_ideReque°Queue
);

374 i‡(
rc
 != 0)

375 
	`Pröt
(" Eº‹: couldÇŸ cª©êblock devi˚ f‹ %s\n", 
dev«me
);

378 
	}
}

381 
	$Inô_IDE
() {

382 
îr‹Code
;

384 
	`Pröt
("Initializing IDE controller...\n");

387 
	`Out_Byã
(
IDE_DEVICE_CONTROL_REGISTER
,

388 
IDE_DCR_NOINTERRUPT
 | 
IDE_DCR_RESET
);

389 
	`Mi¸o_Dñay
(100);

390 
	`Out_Byã
(
IDE_DEVICE_CONTROL_REGISTER
, 
IDE_DCR_NOINTERRUPT
);

399 
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_BUSY
);

401 i‡(
ideDebug
)

402 
	`Pröt
("AboutÅoÑun drive Diagnosis\n");

404 
	`Out_Byã
(
IDE_COMMAND_REGISTER
, 
IDE_COMMAND_DIAGNOSTIC
);

405 
	`In_Byã
(
IDE_STATUS_REGISTER
Ë& 
IDE_STATUS_DRIVE_BUSY
);

406 
îr‹Code
 = 
	`In_Byã
(
IDE_ERROR_REGISTER
);

407 i‡(
ideDebug
 > 1)

408 
	`Pröt
("ide: idêîr‹Ñegi°î = %x\n", 
îr‹Code
);

411 
i
;

412 
i
 = 0; i < 
IDE_MAX_DRIVES
; i++) {

413 i‡(
	`ªadDriveC⁄fig
(
i
) == 0)

414 ++
numDrives
;

416 i‡(
ideDebug
)

417 
	`Pröt
("Found %d IDE drives\n", 
numDrives
);

420 i‡(
numDrives
 > 0)

421 
	`Sèπ_Kî√l_Thªad
(
IDE_Reque°_Thªad
, 0, 
PRIORITY_NORMAL
, 
åue
,

423 
	}
}

	@idt.c

10 
	~<gìkos/kas£π.h
>

11 
	~<gìkos/defs.h
>

12 
	~<gìkos/idt.h
>

13 
	~<gìkos/smp.h
>

22 
IDT_Des¸ùt‹
 
	gs_IDT
[4][
NUM_IDT_ENTRIES
];

30 
g_íåyPoötTabÀSèπ
, 
g_íåyPoötTabÀEnd
;

31 
g_h™dÀrSizeNoEº
, 
g_h™dÀrSizeEº
;

38 
I¡îru±_H™dÀr
 
	gg_öãºu±TabÀ
[
NUM_IDT_ENTRIES
];

51 
	$Inô_IDT
(
˝uID
) {

52 
i
;

53 
ush‹t_t
 
limôAndBa£
[3];

55 
	`KASSERT0
(
˝uID
 < 4, "Only supports upÅo 4 coresÑightÇow");

56 
ul⁄g_t
 
idtBa£Addr
 = (ul⁄g_tË
s_IDT
[
˝uID
];

57 
ul⁄g_t
 
èbÀBa£Addr
 = (ul⁄g_tË& 
g_íåyPoötTabÀSèπ
;

58 
ul⁄g_t
 
addr
;

60 
	`Pröt
("Initializing IDT...\n");

63 
	`KASSERT
(
g_h™dÀrSizeNoEº
 =
g_h™dÀrSizeEº
);

64 
	`KASSERT
((&
g_íåyPoötTabÀEnd
 - &
g_íåyPoötTabÀSèπ
) ==

65 
g_h™dÀrSizeNoEº
 * 
NUM_IDT_ENTRIES
);

73 
i
 = 0, 
addr
 = 
èbÀBa£Addr
; i < 
NUM_IDT_ENTRIES
; ++i) {

78 
d∂
 = (
i
 =
SYSCALL_INT
Ë? 
USER_PRIVILEGE
 : 
KERNEL_PRIVILEGE
;

79 
	`Inô_I¡îru±_G©e
(&
s_IDT
[
˝uID
][
i
], 
addr
, 
d∂
);

80 
addr
 +
g_h™dÀrSizeNoEº
;

87 
limôAndBa£
[0] = 8 * 
NUM_IDT_ENTRIES
;

88 
limôAndBa£
[1] = 
idtBa£Addr
 & 0xffff;

89 
limôAndBa£
[2] = 
idtBa£Addr
 >> 16;

92 
	`Lﬂd_IDTR
(
limôAndBa£
);

93 
	}
}

99 
	$Inô_I¡îru±_G©e
(
IDT_Des¸ùt‹
 *
desc
, 
ul⁄g_t
 
addr
, 
d∂
) {

100 
	`KASSERT
(
desc
);

101 
desc
->
ig
.
off£tLow
 = 
addr
 & 0xffff;

102 
desc
->
ig
.
£gmítSñe˘‹
 = 
KERNEL_CS
;

103 
desc
->
ig
.
ª£rved
 = 0;

104 
desc
->
ig
.
sig«tuª
 = 0x70;

105 
desc
->
ig
.
d∂
 = dpl;

106 
desc
->
ig
.
¥e£¡
 = 1;

107 
desc
->
ig
.
off£tHigh
 = 
addr
 >> 16;

108 
	}
}

116 
	$In°Æl_I¡îru±_H™dÀr
(
öãºu±
, 
I¡îru±_H™dÀr
 
h™dÀr
) {

117 
	`KASSERT
(
öãºu±
 >0 && i¡îru± < 
NUM_IDT_ENTRIES
);

118 
g_öãºu±TabÀ
[
öãºu±
] = 
h™dÀr
;

119 
	}
}

	@int.c

10 
	~<gìkos/idt.h
>

11 
	~<gìkos/s¸ìn.h
>

12 
	~<gìkos/kas£π.h
>

13 
	~<gìkos/∑gög.h
>

14 
	~<gìkos/öt.h
>

19 
ul⁄g_t
 
Gë_Cuºít_EFLAGS
();

30 
	$Dummy_I¡îru±_H™dÀr
(
I¡îru±_Sèã
 *
°©e
) {

31 
	`Pröt
("*** Unexpected interrupt! ***\n");

32 
	`Dump_I¡îru±_Sèã
(
°©e
);

33 
	`STOP
();

34 
	}
}

36 
	$Pröt_Sñe˘‹
(c⁄° *
ªgName
, 
uöt_t
 
vÆue
)

37 
	`__©åibuã__
 ((
unu£d
));

38 
	$Pröt_Sñe˘‹
(c⁄° *
ªgName
, 
uöt_t
 
vÆue
) {

39 
	`Pröt
("%s: index=%d,Åi=%d,Ñpl=%d\n",

40 
ªgName
, 
vÆue
 >> 3, (value >> 2) & 1, value & 3);

41 
	}
}

50 
	$Inô_I¡îru±s
(
˝uID
) {

51 
i
;

54 
	`Inô_IDT
(
˝uID
);

56 i‡(!
˝uID
) {

61 
i
 = 0; i < 
NUM_IDT_ENTRIES
; ++i) {

62 
	`In°Æl_I¡îru±_H™dÀr
(
i
, 
Dummy_I¡îru±_H™dÀr
);

68 
	`__E«bÀ_I¡îru±s
();

69 
	}
}

74 
boﬁ
 
	$I¡îru±s_E«bÀd
() {

75 
ul⁄g_t
 
eÊags
 = 
	`Gë_Cuºít_EFLAGS
();

76  (
eÊags
 & 
EFLAGS_IF
) != 0;

77 
	}
}

82 
	$Dump_I¡îru±_Sèã
(
I¡îru±_Sèã
 *
°©e
) {

83 
uöt_t
 
îr‹Code
 = 
°©e
->errorCode;

85 
	`Pröt
("eax=%08xÉbx=%08xÉcx=%08xÉdx=%08x\n"

90 
°©e
->
óx
, sèã->
ebx
, sèã->
ecx
, sèã->
edx
,

91 
°©e
->
esi
, sèã->
edi
, sèã->
ebp
,

92 
°©e
->
eù
, sèã->
cs
, sèã->
eÊags
,

93 
°©e
->
ötNum
, 
îr‹Code
,

94 
îr‹Code
 >> 3, (errorCode >> 2) & 1, (errorCode >> 1) & 1,

95 
îr‹Code
 & 1);

96 i‡(
	`Is_U£r_I¡îru±
(
°©e
)) {

97 
U£r_I¡îru±_Sèã
 *
u°©e
 =

98 (
U£r_I¡îru±_Sèã
 *)
°©e
;

99 
	`Pröt
("u£∏e•=%08x, u£∏ss=%08x\n", 
u°©e
->
e•U£r
,

100 
u°©e
->
ssU£r
);

102 i‡(
°©e
->
ötNum
 == 14) {

105 
Áu…code_t
 
pfEº‹Code
;

106 
vÆue
;

107 } 
u
;

109 
u
.
vÆue
 = 
îr‹Code
;

110 
	`Pröt
("Page fault: ");

111 i‡(
u
.
pfEº‹Code
.
¥Ÿe˘i⁄Viﬁ©i⁄
)

112 
	`Pröt
("[protection]");

113 
	`Pröt
("[%s]", 
u
.
pfEº‹Code
.
wrôeFau…
 ? "write" : "read");

114 i‡(
u
.
pfEº‹Code
.
u£rModeFau…
)

115 
	`Pröt
("[user mode]");

116 
	`Pröt
("[addªss=%lx]\n", 
	`Gë_Page_Fau…_Addªss
());

118 
	`H¨dw¨e_Shutdown
();

119 
submôTe°ög
;

121 i‡(
submôTe°ög
)

122 
	`H¨dw¨e_Shutdown
();

123 
	`Pröt_Sñe˘‹
("cs", 
°©e
->
cs
);

124 
	`Pröt_Sñe˘‹
("ds", 
°©e
->
ds
);

125 
	`Pröt_Sñe˘‹
("es", 
°©e
->
es
);

126 
	`Pröt_Sñe˘‹
("fs", 
°©e
->
fs
);

127 
	`Pröt_Sñe˘‹
("gs", 
°©e
->
gs
);

128 
	}
}

	@io.c

10 
	~<gìkos/io.h
>

15 
	$Out_Byã
(
ush‹t_t
 
p‹t
, 
uch¨_t
 
vÆue
) {

16 
__asm__
 
	`__vﬁ©ûe__
("outb %b0, %w1"::"a"(
vÆue
), "Nd"(
p‹t
)

18 
	}
}

23 
uch¨_t
 
	$In_Byã
(
ush‹t_t
 
p‹t
) {

24 
uch¨_t
 
vÆue
;

26 
__asm__
 
	`__vﬁ©ûe__
("öb %w1, %b0":"˜"(
vÆue
)

27 :"Nd"(
p‹t
)

30  
vÆue
;

31 
	}
}

36 
	$Out_W‹d
(
ush‹t_t
 
p‹t
, ush‹t_à
vÆue
) {

37 
__asm__
 
	`__vﬁ©ûe__
("outw %w0, %w1"::"a"(
vÆue
), "Nd"(
p‹t
)

39 
	}
}

44 
ush‹t_t
 
	$In_W‹d
(
ush‹t_t
 
p‹t
) {

45 
ush‹t_t
 
vÆue
;

47 
__asm__
 
	`__vﬁ©ûe__
("öw %w1, %w0":"˜"(
vÆue
)

48 :"Nd"(
p‹t
)

51  
vÆue
;

52 
	}
}

58 
	$IO_Dñay
() {

59 
uch¨_t
 
vÆue
 = 0;

60 
__asm__
 
	`__vﬁ©ûe__
("outb %0, $0x80"::"a"(
vÆue
)

62 
	}
}

	@irq.c

21 
	~<gìkos/kas£π.h
>

22 
	~<gìkos/idt.h
>

23 
	~<gìkos/io.h
>

24 
	~<gìkos/úq.h
>

25 
	~<gìkos/smp.h
>

36 
ush‹t_t
 
	gs_úqMask
 = 0xff7b;

41 
	#MASTER
(
mask
Ë((maskË& 0xff)

	)

42 
	#SLAVE
(
mask
Ë(((mask)>>8Ë& 0xff)

	)

53 
	$In°Æl_IRQ
(
úq
, 
I¡îru±_H™dÀr
 
h™dÀr
) {

54 
	`M≠_IO_APIC_IRQ
(
úq
, 
h™dÀr
);

55 
	}
}

61 
ush‹t_t
 
	$Gë_IRQ_Mask
() {

62  
s_úqMask
;

63 
	}
}

68 
	$Së_IRQ_Mask
(
ush‹t_t
 
mask
) {

69 
uch¨_t
 
ﬁdMask
, 
√wMask
;

71 
ﬁdMask
 = 
	`MASTER
(
s_úqMask
);

72 
√wMask
 = 
	`MASTER
(
mask
);

73 i‡(
√wMask
 !
ﬁdMask
) {

74 
	`Out_Byã
(0x21, 
√wMask
);

77 
ﬁdMask
 = 
	`SLAVE
(
s_úqMask
);

78 
√wMask
 = 
	`SLAVE
(
mask
);

79 i‡(
√wMask
 !
ﬁdMask
) {

80 
	`Out_Byã
(0xA1, 
√wMask
);

83 
s_úqMask
 = 
mask
;

84 
	}
}

89 
	$E«bÀ_IRQ
(
úq
) {

90 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

91 
ush‹t_t
 
mask
 = 
	`Gë_IRQ_Mask
();

93 
	`KASSERT
(
úq
 >= 0 && irq <= 32);

94 
mask
 &~(1 << 
úq
);

95 
	`Së_IRQ_Mask
(
mask
);

97 
	`End_I¡_Atomic
(
iÊag
);

98 
	}
}

103 
	$DißbÀ_IRQ
(
úq
) {

104 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

105 
ush‹t_t
 
mask
 = 
	`Gë_IRQ_Mask
();

107 
	`KASSERT
(
úq
 >= 0 && irq < 16);

108 
mask
 |(1 << 
úq
);

109 
	`Së_IRQ_Mask
(
mask
);

111 
	`End_I¡_Atomic
(
iÊag
);

112 
	}
}

118 
Begö_IRQ
(
I¡îru±_Sèã
 *
°©e
 
__©åibuã__
 ((
unu£d
))) {

125 
	$End_IRQ
(
I¡îru±_Sèã
 *
°©e
) {

126 
úq
 = 
°©e
->
ötNum
 - 
FIRST_EXTERNAL_INT
;

127 
uch¨_t
 
comm™d
 = 0x60 | (
úq
 & 0x7);

129 i‡(
úq
 < 8) {

131 
	`Out_Byã
(0x20, 
comm™d
);

134 
	`Out_Byã
(0xA0, 
comm™d
);

135 
	`Out_Byã
(0x20, 0x62);

137 
	}
}

	@keyboard.c

33 
	~<gìkos/kthªad.h
>

34 
	~<gìkos/kas£π.h
>

35 
	~<gìkos/s¸ìn.h
>

36 
	~<gìkos/úq.h
>

37 
	~<gìkos/io.h
>

38 
	~<gìkos/keybﬂrd.h
>

40 
	#DEBUG_KEYBOARD
(
x
...)

	)

50 
	#LEFT_SHIFT
 0x01

	)

51 
	#RIGHT_SHIFT
 0x02

	)

52 
	#LEFT_CTRL
 0x04

	)

53 
	#RIGHT_CTRL
 0x08

	)

54 
	#LEFT_ALT
 0x10

	)

55 
	#RIGHT_ALT
 0x20

	)

56 
	#SHIFT_MASK
 (
LEFT_SHIFT
 | 
RIGHT_SHIFT
)

	)

57 
	#CTRL_MASK
 (
LEFT_CTRL
 | 
RIGHT_CTRL
)

	)

58 
	#ALT_MASK
 (
LEFT_ALT
 | 
RIGHT_ALT
)

	)

59 
	gs_shi·Sèã
 = 0;

65 
	#QUEUE_SIZE
 256

	)

66 
	#QUEUE_MASK
 0xff

	)

67 
	#NEXT
(
ödex
Ë(((ödexË+ 1Ë& 
QUEUE_MASK
)

	)

68 
Keycode
 
	gs_queue
[
QUEUE_SIZE
];

69 
	gs_queueHód
, 
	gs_queueTaû
;

74 
Thªad_Queue
 
	gs_waôQueue
;

79 c⁄° 
Keycode
 
	gs_sˇnTabÀNoShi·
[] = {

80 
KEY_UNKNOWN
, 
ASCII_ESC
, '1', '2',

83 '-', '=', 
ASCII_BS
, '\t',

87 '\r', 
KEY_LCTRL
, 'a', 's',

90 '\'', '`', 
KEY_LSHIFT
, '\\',

93 '.', '/', 
KEY_RSHIFT
, 
KEY_PRINTSCRN
,

94 
KEY_LALT
, ' ', 
KEY_CAPSLOCK
, 
KEY_F1
,

95 
KEY_F2
, 
KEY_F3
, 
KEY_F4
, 
KEY_F5
,

96 
KEY_F6
, 
KEY_F7
, 
KEY_F8
, 
KEY_F9
,

97 
KEY_F10
, 
KEY_NUMLOCK
, 
KEY_SCRLOCK
, 
KEY_KPHOME
,

98 
KEY_KPUP
, 
KEY_KPPGUP
, 
KEY_KPMINUS
, 
KEY_KPLEFT
,

99 
KEY_KPCENTER
, 
KEY_KPRIGHT
, 
KEY_KPPLUS
, 
KEY_KPEND
,

100 
KEY_KPDOWN
, 
KEY_KPPGDN
, 
KEY_KPINSERT
, 
KEY_KPDEL
,

101 
KEY_SYSREQ
, 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN,

104 
	#SCAN_TABLE_SIZE
 ((
s_sˇnTabÀNoShi·
Ë/ (
Keycode
))

	)

111 c⁄° 
Keycode
 
	gs_sˇnTabÀWôhShi·
[] = {

112 
KEY_UNKNOWN
, 
ASCII_ESC
, '!', '@',

115 '_', '+', 
ASCII_BS
, '\t',

119 '\r', 
KEY_LCTRL
, 'A', 'S',

122 '"', '~', 
KEY_LSHIFT
, '|',

125 '>', '?', 
KEY_RSHIFT
, 
KEY_PRINTSCRN
,

126 
KEY_LALT
, ' ', 
KEY_CAPSLOCK
, 
KEY_F1
,

127 
KEY_F2
, 
KEY_F3
, 
KEY_F4
, 
KEY_F5
,

128 
KEY_F6
, 
KEY_F7
, 
KEY_F8
, 
KEY_F9
,

129 
KEY_F10
, 
KEY_NUMLOCK
, 
KEY_SCRLOCK
, 
KEY_KPHOME
,

130 
KEY_KPUP
, 
KEY_KPPGUP
, 
KEY_KPMINUS
, 
KEY_KPLEFT
,

131 
KEY_KPCENTER
, 
KEY_KPRIGHT
, 
KEY_KPPLUS
, 
KEY_KPEND
,

132 
KEY_KPDOWN
, 
KEY_KPPGDN
, 
KEY_KPINSERT
, 
KEY_KPDEL
,

133 
KEY_SYSREQ
, 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN,

137 c⁄° 
Keycode
 
	gs_sˇnTabÀE0
[] = {

138 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

139 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

140 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

141 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

142 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

143 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

144 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

145 
KEY_UNKNOWN
, 
KEY_RCTRL
, KEY_UNKNOWN, KEY_UNKNOWN,

146 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

147 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

148 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

149 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

150 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

151 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

152 
KEY_RALT
, 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN,

153 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

154 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

155 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

156 
KEY_KPUP
, 
KEY_KPPGUP
, 
KEY_KPMINUS
, 
KEY_KPLEFT
,

157 
KEY_KPCENTER
, 
KEY_KPRIGHT
, 
KEY_KPPLUS
, 
KEY_KPEND
,

158 
KEY_KPDOWN
, 
KEY_KPPGDN
, 
KEY_KPINSERT
, 
KEY_KPDEL
,

159 
KEY_UNKNOWN
, KEY_UNKNOWN, KEY_UNKNOWN, KEY_UNKNOWN,

162 
__ölöe__
 
boﬁ
 
	$Is_Queue_Em±y
() {

163  
s_queueHód
 =
s_queueTaû
;

164 
	}
}

166 
__ölöe__
 
boﬁ
 
	$Is_Queue_FuŒ
() {

167  
	`NEXT
(
s_queueTaû
Ë=
s_queueHód
;

168 
	}
}

170 
__ölöe__
 
	$Enqueue_Keycode
(
Keycode
 
keycode
) {

171 i‡(!
	`Is_Queue_FuŒ
()) {

172 
s_queue
[
s_queueTaû
] = 
keycode
;

173 
s_queueTaû
 = 
	`NEXT
(s_queueTail);

175 
	}
}

177 
__ölöe__
 
Keycode
 
	$Dequeue_Keycode
() {

178 
Keycode
 
ªsu…
;

179 
	`KASSERT
(!
	`Is_Queue_Em±y
());

180 
ªsu…
 = 
s_queue
[
s_queueHód
];

181 
s_queueHód
 = 
	`NEXT
(s_queueHead);

182  
ªsu…
;

183 
	}
}

188 
	$Keybﬂrd_I¡îru±_H™dÀr
(
I¡îru±_Sèã
 *
°©e
) {

189 
uch¨_t
 
°©us
, 
sˇnCode
;

190 
Êag
 = 0;

191 
boﬁ
 
ªÀa£
 = 
Ál£
, 
shi·
;

192 
Keycode
 
keycode
;

194 
	`Begö_IRQ
(
°©e
);

196 
°©us
 = 
	`In_Byã
(
KB_CMD
);

197 
	`IO_Dñay
();

199 i‡((
°©us
 & 
KB_OUTPUT_FULL
) != 0) {

201 
sˇnCode
 = 
	`In_Byã
(
KB_DATA
);

202 
	`IO_Dñay
();

204 
	`DEBUG_KEYBOARD
("code=%x%s\n", 
sˇnCode
,

205 (
sˇnCode
 & 0x80) ? " [release]" : "");

207 
shi·
 = ((
s_shi·Sèã
 & 
SHIFT_MASK
) != 0);

209 c⁄° 
Keycode
 *
sˇ¡abÀ_usög_cuºít_modifõrs
;

210 
sˇ¡abÀ_usög_cuºít_modifõrs
 =

211 
shi·
 ? 
s_sˇnTabÀWôhShi·
 : 
s_sˇnTabÀNoShi·
;

212 i‡(
sˇnCode
 == 0xe0) {

214 
sˇnCode
 = 
	`In_Byã
(
KB_DATA
);

215 
	`IO_Dñay
();

216 
sˇ¡abÀ_usög_cuºít_modifõrs
 = 
s_sˇnTabÀE0
;

217 
	`DEBUG_KEYBOARD
("suffixcode=%x%s\n", 
sˇnCode
,

218 (
sˇnCode
 & 0x80) ? " [release]" : "");

221 i‡(
sˇnCode
 & 
KB_KEY_RELEASE
) {

222 
ªÀa£
 = 
åue
;

223 
sˇnCode
 &~(
KB_KEY_RELEASE
);

226 i‡(
sˇnCode
 >
SCAN_TABLE_SIZE
) {

227 
	`Pröt
("Unknow¿sˇ¿code: 0x%x\n", 
sˇnCode
);

228 
d⁄e
;

231 
keycode
 = 
sˇ¡abÀ_usög_cuºít_modifõrs
[
sˇnCode
];

234 
keycode
) {

235 
KEY_LSHIFT
:

236 
Êag
 = 
LEFT_SHIFT
;

238 
KEY_RSHIFT
:

239 
Êag
 = 
RIGHT_SHIFT
;

241 
KEY_LCTRL
:

242 
Êag
 = 
LEFT_CTRL
;

244 
KEY_RCTRL
:

245 
Êag
 = 
RIGHT_CTRL
;

247 
KEY_LALT
:

248 
Êag
 = 
LEFT_ALT
;

250 
KEY_RALT
:

251 
Êag
 = 
RIGHT_ALT
;

254 
noÊagch™ge
;

257 i‡(
ªÀa£
)

258 
s_shi·Sèã
 &~(
Êag
);

260 
s_shi·Sèã
 |
Êag
;

266 
d⁄e
;

268 
noÊagch™ge
:

270 i‡(
shi·
)

271 
keycode
 |
KEY_SHIFT_FLAG
;

272 i‡((
s_shi·Sèã
 & 
CTRL_MASK
) != 0)

273 
keycode
 |
KEY_CTRL_FLAG
;

274 i‡((
s_shi·Sèã
 & 
ALT_MASK
) != 0)

275 
keycode
 |
KEY_ALT_FLAG
;

276 i‡(
ªÀa£
)

277 
keycode
 |
KEY_RELEASE_FLAG
;

280 
	`Enqueue_Keycode
(
keycode
);

283 
	`Wake_Up
(&
s_waôQueue
);

289 
g_√edRescheduÀ
[
	`Gë_CPU_ID
()] = 
åue
;

292 
d⁄e
:

293 
	`End_IRQ
(
°©e
);

294 
	}
}

300 
	$Inô_Keybﬂrd
() {

301 
ush‹t_t
 
úqMask
;

303 
	`Pröt
("Initializing keyboard...\n");

306 
s_shi·Sèã
 = 0;

309 
s_queueHód
 = 
s_queueTaû
 = 0;

312 
	`In°Æl_IRQ
(
KB_IRQ
, 
Keybﬂrd_I¡îru±_H™dÀr
);

315 
úqMask
 = 
	`Gë_IRQ_Mask
();

316 
úqMask
 &~(1 << 
KB_IRQ
);

317 
	`Së_IRQ_Mask
(
úqMask
);

319 
	}
}

328 
boﬁ
 
	$Ród_Key
(
Keycode
 * 
keycode
) {

329 
boﬁ
 
ªsu…
, 
iÊag
;

331 
iÊag
 = 
	`Begö_I¡_Atomic
();

333 
ªsu…
 = !
	`Is_Queue_Em±y
();

334 i‡(
ªsu…
) {

335 *
keycode
 = 
	`Dequeue_Keycode
();

338 
	`End_I¡_Atomic
(
iÊag
);

340  
ªsu…
;

341 
	}
}

343 
Keycode
 
	$Gë_Te°_I≈ut
() {

344 
Keycode
 
ªt
;

345 
ªt
 = 
	`In_Byã
(0x510);

346 i‡(!
ªt
)

347  
KEY_UNKNOWN
;

349  
ªt
;

350 
	}
}

357 
Keycode
 
	$Waô_F‹_Key
() {

358 
boﬁ
 
gŸKey
, 
iÊag
;

359 
Keycode
 
keycode
 = 
KEY_UNKNOWN
;

362 
keycode
 = 
	`Gë_Te°_I≈ut
();

363 i‡(
keycode
 !
KEY_UNKNOWN
) {

364  
keycode
;

367 
iÊag
 = 
	`Begö_I¡_Atomic
();

370 
gŸKey
 = !
	`Is_Queue_Em±y
();

371 i‡(
gŸKey
)

372 
keycode
 = 
	`Dequeue_Keycode
();

374 
	`Waô
(&
s_waôQueue
);

376 !
gŸKey
);

378 
	`End_I¡_Atomic
(
iÊag
);

380  
keycode
;

381 
	}
}

	@kthread.c

15 
	~<gìkos/kas£π.h
>

16 
	~<gìkos/defs.h
>

17 
	~<gìkos/s¸ìn.h
>

18 
	~<gìkos/öt.h
>

19 
	~<gìkos/mem.h
>

20 
	~<gìkos/symbﬁ.h
>

21 
	~<gìkos/°rög.h
>

22 
	~<gìkos/kthªad.h
>

23 
	~<gìkos/mÆloc.h
>

24 
	~<gìkos/u£r.h
>

25 
	~<gìkos/Æ¨m.h
>

26 
	~<gìkos/¥oje˘s.h
>

27 
	~<gìkos/smp.h
>

29 
Spö_Lock_t
 
kthªadLock
;

38 
AŒ_Thªad_Li°
 
	gs_ÆlThªadLi°
;

43 
Thªad_Queue
 
	gs_runQueue
;

48 
Kî√l_Thªad
 *
	gg_cuºítThªads
[
MAX_CPUS
];

55 
	gg_√edRescheduÀ
[
MAX_CPUS
];

62 vﬁ©ûê
	gg_¥ìm±i⁄DißbÀd
[
MAX_CPUS
];

69 
Thªad_Queue
 
	gs_gøvey¨dQueue
;

70 
Thªad_Queue
 
	gs_ª≠îWaôQueue
;

77 
	gs_éoˇlKeyCou¡î
 = 0;

78 
éoˇl_de°ru˘‹_t
 
	gs_éoˇlDe°ru˘‹s
[
MAX_TLOCAL_KEYS
];

80 
Kî√l_Thªad
 *
Gë_Next_Ru¬abÀ_Locked
();

87 
Spö_Lock_t
 
	gpidLock
;

89 
	$√xtPid
() {

90 
ªt
;

91 
√xtFªePid
 = 1;

93 
	`Spö_Lock
(&
pidLock
);

94 
ªt
 = 
√xtFªePid
++;

95 
	`Spö_U∆ock
(&
pidLock
);

96  
ªt
;

97 
	}
}

103 
	$Inô_Thªad
(
Kî√l_Thªad
 *
kthªad
, *
°ackPage
,

104 
¥i‹ôy
, 
boﬁ
 
dëached
) {

105 
Kî√l_Thªad
 *
ow√r
 = 
CURRENT_THREAD
;

107 
	`mem£t
(
kthªad
, '\0', (*kthread));

108 
kthªad
->
°ackPage
 = stackPage;

109 
	`KASSERT
(
°ackPage
);

110 
kthªad
->
e•
 = ((
ul⁄g_t
Ëkthªad->
°ackPage
Ë+ 
PAGE_SIZE
;

111 
kthªad
->
numTicks
 = 0;

112 
kthªad
->
dëached
 = detached;

113 
kthªad
->
¥i‹ôy
 =Öriority;

114 
kthªad
->
u£rC⁄ãxt
 = 0;

115 
kthªad
->
ow√r
 = owner;

116 
kthªad
->
afföôy
 = 
AFFINITY_ANY_CORE
;

117 
kthªad
->
tŸÆTime
 = 0;

118 
kthªad
->
›í_cou¡
 = 0;

119 
kthªad
->
tŸÆ_cou¡
 = 0;

125 
kthªad
->
ªfCou¡
 = 
dëached
 ? 1 : 2;

126 
kthªad
->
Æive
 = 
åue
;

127 
	`CÀ¨_Thªad_Queue
(&
kthªad
->
joöQueue
);

128 
kthªad
->
pid
 = 
	`√xtPid
();

129 
	}
}

135 
Kî√l_Thªad
 *
	$Cª©e_Thªad
(
¥i‹ôy
, 
boﬁ
 
dëached
) {

136 
Kî√l_Thªad
 *
kthªad
;

137 *
°ackPage
 = 0;

143 
kthªad
 = 
	`AŒoc_Page
();

144 i‡(
kthªad
 == 0)

147 
°ackPage
 = 
	`AŒoc_Page
();

148 i‡(
°ackPage
 == 0) {

149 
	`Fªe_Page
(
kthªad
);

159 
	`Inô_Thªad
(
kthªad
, 
°ackPage
, 
¥i‹ôy
, 
dëached
);

162 
	`Add_To_Back_Of_AŒ_Thªad_Li°
(&
s_ÆlThªadLi°
, 
kthªad
);

164  
kthªad
;

165 
	}
}

172 
__ölöe__
 
	$Push
(
Kî√l_Thªad
 *
kthªad
, 
ul⁄g_t
 
vÆue
) {

173 
kthªad
->
e•
 -= 4;

174 *((
ul⁄g_t
 *Ë
kthªad
->
e•
Ë
vÆue
;

175 
	}
}

183 
	$De°roy_Thªad
(
Kî√l_Thªad
 *
kthªad
) {

188 i‡(
kthªad
->
u£rC⁄ãxt
 != 0)

189 
	`Dëach_U£r_C⁄ãxt
(
kthªad
);

192 
	`Remove_From_AŒ_Thªad_Li°
(&
s_ÆlThªadLi°
, 
kthªad
);

195 
	`Fªe_Page
(
kthªad
->
°ackPage
);

196 
	`Fªe_Page
(
kthªad
);

197 
	}
}

203 
	$Róp_Thªad
(
Kî√l_Thªad
 *
kthªad
) {

205 
	`KASSERT
(
kthªad
 !
CPUs
[0].
idÀThªad
);

206 
	`KASSERT
(
kthªad
 !
CPUs
[1].
idÀThªad
);

207 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

208 
	`Enqueue_Thªad
(&
s_gøvey¨dQueue
, 
kthªad
);

209 
	`Wake_Up
(&
s_ª≠îWaôQueue
);

210 
	}
}

215 
	$Dëach_Thªad
(
Kî√l_Thªad
 *
kthªad
) {

216 
cou¡
;

218 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

220 
	`KASSERT
(
kthªad
->
ªfCou¡
 > 0);

222 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

223 
cou¡
 = --
kthªad
->
ªfCou¡
;

225 i‡(
cou¡
 == 0) {

226 
	`Róp_Thªad
(
kthªad
);

228 
	`End_I¡_Atomic
(
iÊag
);

229 
	}
}

237 
	$Launch_Thªad
() {

238 
	`E«bÀ_I¡îru±s
();

239 
	}
}

244 
	$Push_GíîÆ_Regi°îs
(
Kî√l_Thªad
 *
kthªad
) {

249 
	`Push
(
kthªad
, 0);

250 
	`Push
(
kthªad
, 0);

251 
	`Push
(
kthªad
, 0);

252 
	`Push
(
kthªad
, 0);

253 
	`Push
(
kthªad
, 0);

254 
	`Push
(
kthªad
, 0);

255 
	`Push
(
kthªad
, 0);

256 
	}
}

263 
	$Shutdown_Thªad
() {

264 
	`Exô
(0);

265 
	}
}

270 
	$Sëup_Kî√l_Thªad
(
Kî√l_Thªad
 *
kthªad
,

271 
Thªad_Sèπ_Func
 
°¨tFunc
, 
ul⁄g_t
 
¨g
) {

277 
	`Push
(
kthªad
, 
¨g
);

278 
	`Push
(
kthªad
, (
ul⁄g_t
Ë& 
Shutdown_Thªad
);

281 
	`Push
(
kthªad
, (
ul⁄g_t
Ë
°¨tFunc
);

296 
	`Push
(
kthªad
, 0UL);

302 
	`Push
(
kthªad
, 
KERNEL_CS
);

303 
	`Push
(
kthªad
, (
ul⁄g_t
Ë& 
Launch_Thªad
);

306 
	`Push
(
kthªad
, 0);

307 
	`Push
(
kthªad
, 0);

310 
	`Push_GíîÆ_Regi°îs
(
kthªad
);

318 
	`Push
(
kthªad
, 
KERNEL_DS
);

319 
	`Push
(
kthªad
, 
KERNEL_DS
);

320 
	`Push
(
kthªad
, 0);

321 
	`Push
(
kthªad
, 0);

322 
	}
}

327  
	$Sëup_U£r_Thªad
(

328 
Kî√l_Thªad
 *
kthªad
,

329 
U£r_C⁄ãxt
 *
u£rC⁄ãxt
) {

330 
u£rDebug
;

336 
ul⁄g_t
 
eÊags
 = 
EFLAGS_IF
;

338 
csSñe˘‹
 = 
u£rC⁄ãxt
->csSelector;

339 
dsSñe˘‹
 = 
u£rC⁄ãxt
->dsSelector;

341 
	`Aâach_U£r_C⁄ãxt
(
kthªad
, 
u£rC⁄ãxt
);

349 
	`Push
(
kthªad
, 
dsSñe˘‹
);

350 
	`Push
(
kthªad
, 
u£rC⁄ãxt
->
°ackPoöãrAddr
);

353 
	`Push
(
kthªad
, 
eÊags
);

354 
	`Push
(
kthªad
, 
csSñe˘‹
);

355 
	`Push
(
kthªad
, 
u£rC⁄ãxt
->
íåyAddr
);

356 i‡(
u£rDebug
)

357 
	`Pröt
("E¡ryáddr=%lx\n", 
u£rC⁄ãxt
->
íåyAddr
);

360 
	`Push
(
kthªad
, 0);

361 
	`Push
(
kthªad
, 0);

368 
	`Push
(
kthªad
, 0);

369 
	`Push
(
kthªad
, 0);

370 
	`Push
(
kthªad
, 0);

371 
	`Push
(
kthªad
, 0);

372 
	`Push
(
kthªad
, 
u£rC⁄ãxt
->
¨gBlockAddr
);

373 
	`Push
(
kthªad
, 0);

374 
	`Push
(
kthªad
, 0);

377 
	`Push
(
kthªad
, 
dsSñe˘‹
);

378 
	`Push
(
kthªad
, 
dsSñe˘‹
);

379 
	`Push
(
kthªad
, 
dsSñe˘‹
);

380 
	`Push
(
kthªad
, 
dsSñe˘‹
);

383 
kthªad
->
afföôy
 = -1;

384 
	}
}

392 
IdÀ
(
ul⁄g_t
 
¨g
 
__©åibuã__
 ((
unu£d
))) {

393 
	gåue
) {

399 
__asm__
("hlt");

401 
Yõld
();

409 
Ró≥r
(
ul⁄g_t
 
¨g
 
__©åibuã__
 ((
unu£d
))) {

410 
Kî√l_Thªad
 *
	gkthªad
;

412 
DißbÀ_I¡îru±s
();

414 
	gåue
) {

415 
Spö_Lock
(&
kthªadLock
);

417 i‡((
	gkthªad
 = 
s_gøvey¨dQueue
.
hód
) == 0) {

419 
Spö_U∆ock
(&
kthªadLock
);

420 
Waô
(&
s_ª≠îWaôQueue
);

423 
CÀ¨_Thªad_Queue
(&
s_gøvey¨dQueue
);

426 
	gkthªad
 != 0) {

427 
Kî√l_Thªad
 *
√xt
 =

428 
Gë_Next_In_Thªad_Queue
(
kthªad
);

431 
De°roy_Thªad
(
kthªad
);

432 
KASSERT
(
kthªad
 !
√xt
);

433 
	gkthªad
 = 
√xt
;

437 
Spö_U∆ock
(&
kthªadLock
);

439 
E«bÀ_I¡îru±s
();

440 
Yõld
();

441 
DißbÀ_I¡îru±s
();

450 
__ölöe__
 
Kî√l_Thªad
 *
	$Föd_Be°
(
Thªad_Queue
 *
queue
) {

451 
˝uID
;

453 
	`KASSERT
(
	`Is_Locked
(&
kthªadLock
));

455 
˝uID
 = 
	`Gë_CPU_ID
();

458 
Kî√l_Thªad
 *
kthªad
 = 
queue
->
hód
, *
be°
 = 0;

459 
kthªad
 != 0) {

460 i‡(
kthªad
->
afföôy
 =
AFFINITY_ANY_CORE
 ||

461 
kthªad
->
afföôy
 =
˝uID
) {

462 i‡(
be°
 =0 || 
kthªad
->
¥i‹ôy
 > best->priority)

464 
be°
 = 
kthªad
;

466 
kthªad
 = 
	`Gë_Next_In_Thªad_Queue
(kthread);

469  
be°
;

470 
	}
}

477 
__ölöe__
 c⁄° **
	$Gë_Tloˇl_Poöãr
(
éoˇl_key_t
 
k
) {

478 
Kî√l_Thªad
 *
cuºít
 = 
CURRENT_THREAD
;

480 
	`KASSERT
(
k
 < 
MAX_TLOCAL_KEYS
);

482  &
cuºít
->
éoˇlD©a
[
k
];

483 
	}
}

493 
	$Tloˇl_Exô
(
Kî√l_Thªad
 *
cuº
) {

494 
i
, 
j
, 
ˇŒed
 = 0;

496 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

498 
j
 = 0; j < 
MIN_DESTRUCTOR_ITERATIONS
; j++) {

500 
i
 = 0; i < 
MAX_TLOCAL_KEYS
; i++) {

502 *
x
 = (*)
cuº
->
éoˇlD©a
[
i
];

503 i‡(
x
 !
NULL
 && 
s_éoˇlDe°ru˘‹s
[
i
] != NULL) {

505 
cuº
->
éoˇlD©a
[
i
] = 
NULL
;

506 
ˇŒed
 = 1;

508 
	`E«bÀ_I¡îru±s
();

509 
s_éoˇlDe°ru˘‹s
[
i
] (
x
);

510 
	`DißbÀ_I¡îru±s
();

513 i‡(!
ˇŒed
)

516 
	}
}

523 
	$Inô_ScheduÀr
(
˝uID
, *
°ack
) {

524 
Kî√l_Thªad
 *
maöThªad
 = (Kî√l_Thªad *)
	`AŒoc_Page
();

526 
	`mem˝y
(
maöThªad
, (*)
KERN_THREAD_OBJ
, (
Kî√l_Thªad
));

532 
	`Inô_Thªad
(
maöThªad
, 
°ack
, 
PRIORITY_NORMAL
, 
åue
);

533 
CURRENT_THREAD
 = 
maöThªad
;

534 
	`Add_To_Back_Of_AŒ_Thªad_Li°
(&
s_ÆlThªadLi°
, 
maöThªad
);

535 
	`°r˝y
(
maöThªad
->
thªadName
, "{Main}");

541 
«me
[30];

542 
	`°r˝y
(
«me
, "{Idle-#?}");

543 
«me
[7] = 
˝uID
 + '0';

544 
CPUs
[
˝uID
].
idÀThªad
 =

545 
	`Sèπ_Kî√l_Thªad
(
IdÀ
, 0, 
PRIORITY_IDLE
, 
åue
, 
«me
);

546 
CPUs
[
˝uID
].
idÀThªad
->
ow√r
 = 
NULL
;

547 
CPUs
[
˝uID
].
idÀThªad
->
afföôy
 = cpuID;

549 i‡(!
˝uID
) {

554 
Kî√l_Thªad
 *
ª≠î
;

556 
ª≠î
 =

557 
	`Sèπ_Kî√l_Thªad
(
Ró≥r
, 0, 
PRIORITY_NORMAL
, 
åue
, "{Reaper}");

559 
	}
}

572 
Kî√l_Thªad
 *
	$Sèπ_Kî√l_Thªad
(
Thªad_Sèπ_Func
 
°¨tFunc
,

573 
ul⁄g_t
 
¨g
,

574 
¥i‹ôy
,

575 
boﬁ
 
dëached
, c⁄° *
«me
) {

576 
Kî√l_Thªad
 *
kthªad
 = 
	`Cª©e_Thªad
(
¥i‹ôy
, 
dëached
);

577 i‡(
kthªad
 != 0) {

582 
	`Sëup_Kî√l_Thªad
(
kthªad
, 
°¨tFunc
, 
¨g
);

586 
	`Make_Ru¬abÀ_Atomic
(
kthªad
);

588 
	`°r˝y
(
kthªad
->
thªadName
, 
«me
);

591  
kthªad
;

592 
	}
}

598 
Kî√l_Thªad
 *
	$Sèπ_U£r_Thªad
(
U£r_C⁄ãxt
 *
u£rC⁄ãxt
,

599 
boﬁ
 
dëached
) {

600 
Kî√l_Thªad
 *
kthªad
 = 
	`Cª©e_Thªad
(
PRIORITY_USER
, 
dëached
);

601 i‡(
kthªad
 != 0) {

603 
	`Sëup_U£r_Thªad
(
kthªad
, 
u£rC⁄ãxt
);

604 
	`Make_Ru¬abÀ_Atomic
(
kthªad
);

607  
kthªad
;

608 
	}
}

614 
	$Make_Ru¬abÀ
(
Kî√l_Thªad
 *
kthªad
) {

615 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

617 
	`Enqueue_Thªad
(&
s_runQueue
, 
kthªad
);

618 
	`TODO_P
(
PROJECT_SCHEDULING
, "replace makeÑunnableásÇeeded");

619 
	}
}

627 
	$Make_Ru¬abÀ_Atomic
(
Kî√l_Thªad
 *
kthªad
) {

628 
	`DißbÀ_I¡îru±s
();

629 
	`Spö_Lock
(&
kthªadLock
);

630 
	`Make_Ru¬abÀ
(
kthªad
);

631 
	`Spö_U∆ock
(&
kthªadLock
);

632 
	`E«bÀ_I¡îru±s
();

633 
	}
}

638 
Kî√l_Thªad
 *
	$Gë_Cuºít
() {

639  
CURRENT_THREAD
;

640 
	}
}

646 
Kî√l_Thªad
 *
	$Gë_Next_Ru¬abÀ_Locked
() {

647 
Kî√l_Thªad
 *
be°
 = 0;

648 
be°
 = 
	`Föd_Be°
(&
s_runQueue
);

649 
	`KASSERT
(
be°
 != 0);

650 
	`Remove_Thªad
(&
s_runQueue
, 
be°
);

651 
˝uID
 = 
	`Gë_CPU_ID
();

653 
	`KASSERT
(
	`Is_Locked
(&
kthªadLock
));

654 
	`TODO_P
(
PROJECT_SCHEDULING
, "fix Get_Next_Runnable");

655  
be°
;

656 
	}
}

658 
Kî√l_Thªad
 *
	$Gë_Next_Ru¬abÀ
() {

659 
Kî√l_Thªad
 *
ªt
;

661 
	`Spö_Lock
(&
kthªadLock
);

663 
ªt
 = 
	`Gë_Next_Ru¬abÀ_Locked
();

666 
	`Spö_U∆ock
(&
kthªadLock
);

668  
ªt
;

669 
	}
}

679 
	$ScheduÀ
() {

680 
Kî√l_Thªad
 *
ru¬abÀ
;

683 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

687 
	`KASSERT
(!
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()]);

689 
ru¬abÀ
 = 
	`Gë_Next_Ru¬abÀ
();

698 
	`Swôch_To_Thªad
(
ru¬abÀ
);

699 
	}
}

705 
	$Yõld
() {

706 
	`DißbÀ_I¡îru±s
();

707 
	`Make_Ru¬abÀ
(
CURRENT_THREAD
);

708 
	`ScheduÀ
();

709 
	`E«bÀ_I¡îru±s
();

710 
	}
}

717 
	$Exô
(
exôCode
) {

718 
	`Munm≠_Im∂
(
uöt_t
 
addr
);

720 
Kî√l_Thªad
 *
cuºít
 = 
CURRENT_THREAD
;

722 i‡(
	`I¡îru±s_E«bÀd
())

723 
	`DißbÀ_I¡îru±s
();

726 
cuºít
->
exôCode
 =ÉxitCode;

727 
cuºít
->
Æive
 = 
Ál£
;

731 
	`Aœrm_C™˚l_F‹_Thªad
(
cuºít
);

734 
	`Tloˇl_Exô
(
CURRENT_THREAD
);

736  
	`Wake_Up
(&
cuºít
->
joöQueue
);

739 
	`Dëach_Thªad
(
CURRENT_THREAD
);

747 
	`ScheduÀ
();

750 
	`KASSERT
(
Ál£
);

751 
	}
}

758 
	$Joö
(
Kî√l_Thªad
 *
kthªad
) {

759 
exôCode
;

761 
	`KASSERT
(
	`I¡îru±s_E«bÀd
());

764 
	`KASSERT
(
kthªad
->
ow√r
 =
CURRENT_THREAD
);

766 
	`DißbÀ_I¡îru±s
();

768 
kthªad
->
Æive
) {

769 
	`Waô
(&
kthªad
->
joöQueue
);

772 
exôCode
 = 
kthªad
->exitCode;

776 
kthªad
->
dëached
 = 1;

779 
	`Dëach_Thªad
(
kthªad
);

781 
	`E«bÀ_I¡îru±s
();

783  
exôCode
;

784 
	}
}

794 
Kî√l_Thªad
 *
	$Lookup_Thªad
(
pid
, 
nŸOw√r
) {

795 
Kî√l_Thªad
 *
ªsu…
 = 0;

797 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

805 
	`Spö_Lock
(&
kthªadLock
);

806 
ªsu…
 = 
	`Gë_Fr⁄t_Of_AŒ_Thªad_Li°
(&
s_ÆlThªadLi°
);

807 
ªsu…
 != 0) {

808 i‡(
ªsu…
->
pid
 ==Öid) {

809 i‡(
CURRENT_THREAD
 !
ªsu…
->
ow√r
 && !
nŸOw√r
)

810 
ªsu…
 = 0;

813 
ªsu…
 = 
	`Gë_Next_In_AŒ_Thªad_Li°
(result);

815 
	`Spö_U∆ock
(&
kthªadLock
);

817 
	`End_I¡_Atomic
(
iÊag
);

819  
ªsu…
;

820 
	}
}

833 
	$Waô
(
Thªad_Queue
 *
waôQueue
) {

834 
Kî√l_Thªad
 *
cuºít
 = 
CURRENT_THREAD
;

836 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

837 
	`KASSERT
(
waôQueue
 !
NULL
);

839 
	`Enqueue_Thªad
(
waôQueue
, 
cuºít
);

841 
	`ScheduÀ
();

842 
	}
}

844 
	$Wake_Up_Locked
(
Thªad_Queue
 *
waôQueue
) {

845 
Kî√l_Thªad
 *
kthªad
 = 
waôQueue
->
hód
, *
√xt
;

847 
	`KASSERT
(
	`Is_Locked
(&
kthªadLock
));

848 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

849 
	`KASSERT
(
waôQueue
 !
NULL
);

855 
kthªad
 = 
waôQueue
->
hód
; kthªad !0; kthªad = 
√xt
) {

856 
√xt
 = 
	`Gë_Next_In_Thªad_Queue
(
kthªad
);

857 *
«me
;

859 i‡(
kthªad
->
u£rC⁄ãxt
) {

860 
«me
 = 
kthªad
->
u£rC⁄ãxt
->name;

862 
«me
 = 
kthªad
->
thªadName
;

866 
	`Make_Ru¬abÀ
(
kthªad
);

870 
	`CÀ¨_Thªad_Queue
(
waôQueue
);

871 
	}
}

880 
	$Wake_Up
(
Thªad_Queue
 *
waôQueue
) {

881 
	`Spö_Lock
(&
kthªadLock
);

882 
	`Wake_Up_Locked
(
waôQueue
);

883 
	`Spö_U∆ock
(&
kthªadLock
);

884 
	}
}

892 
	$Wake_Up_O√
(
Thªad_Queue
 *
waôQueue
) {

893 
Kî√l_Thªad
 *
be°
;

895 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

896 
	`KASSERT
(
waôQueue
 !
NULL
);

898 
	`Spö_Lock
(&
kthªadLock
);

900 
be°
 = 
	`Föd_Be°
(
waôQueue
);

902 i‡(
be°
 != 0) {

903 
	`Remove_Thªad
(
waôQueue
, 
be°
);

904 
	`Make_Ru¬abÀ
(
be°
);

908 
	`Spö_U∆ock
(&
kthªadLock
);

909 
	}
}

914 
	$Tloˇl_Cª©e
(
éoˇl_key_t
 * 
key
, 
éoˇl_de°ru˘‹_t
 
de°ru˘‹
) {

915 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

917 
	`KASSERT
(
key
);

919 i‡(
s_éoˇlKeyCou¡î
 =
MAX_TLOCAL_KEYS
)

921 
s_éoˇlDe°ru˘‹s
[
s_éoˇlKeyCou¡î
] = 
de°ru˘‹
;

922 *
key
 = 
s_éoˇlKeyCou¡î
++;

924 
	`End_I¡_Atomic
(
iÊag
);

927 
	}
}

932 
	$Tloˇl_Put
(
éoˇl_key_t
 
k
, c⁄° *
v
) {

933 c⁄° **
pv
;

935 
	`KASSERT
(
k
 < 
s_éoˇlKeyCou¡î
);

937 
pv
 = 
	`Gë_Tloˇl_Poöãr
(
k
);

938 *
pv
 = 
v
;

939 
	}
}

944 *
	$Tloˇl_Gë
(
éoˇl_key_t
 
k
) {

945 c⁄° **
pv
;

947 
	`KASSERT
(
k
 < 
s_éoˇlKeyCou¡î
);

949 
pv
 = 
	`Gë_Tloˇl_Poöãr
(
k
);

950  (*)*
pv
;

951 
	}
}

957 
	$Dump_AŒ_Thªad_Li°
() {

958 
Kî√l_Thªad
 *
kthªad
;

959 
cou¡
 = 0;

960 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

962 
	`Spö_Lock
(&
kthªadLock
);

964 
kthªad
 = 
	`Gë_Fr⁄t_Of_AŒ_Thªad_Li°
(&
s_ÆlThªadLi°
);

966 
	`Pröt
("[");

967 
kthªad
 != 0) {

968 ++
cou¡
;

969 
	`Pröt
("<%lx,%lx,%lx>",

970 (
ul⁄g_t
Ë
	`Gë_Pªv_In_AŒ_Thªad_Li°
(
kthªad
),

971 (
ul⁄g_t
Ë
kthªad
,

972 (
ul⁄g_t
Ë
	`Gë_Next_In_AŒ_Thªad_Li°
(
kthªad
));

973 
	`KASSERT
(
kthªad
 !
	`Gë_Next_In_AŒ_Thªad_Li°
(kthread));

974 
kthªad
 = 
	`Gë_Next_In_AŒ_Thªad_Li°
(kthread);

976 
	`Pröt
("]\n");

977 
	`Pröt
("%dÅhªad†¨êru¬ög\n", 
cou¡
);

979 
	`Spö_U∆ock
(&
kthªadLock
);

980 
	`End_I¡_Atomic
(
iÊag
);

981 
	}
}

	@main.c

19 
	~<gìkos/boŸöfo.h
>

20 
	~<gìkos/°rög.h
>

21 
	~<gìkos/s¸ìn.h
>

22 
	~<gìkos/mem.h
>

23 
	~<gìkos/¸c32.h
>

24 
	~<gìkos/tss.h
>

25 
	~<gìkos/öt.h
>

26 
	~<gìkos/kthªad.h
>

27 
	~<gìkos/å≠.h
>

28 
	~<gìkos/timî.h
>

29 
	~<gìkos/keybﬂrd.h
>

30 
	~<gìkos/dma.h
>

31 
	~<gìkos/ide.h
>

32 
	~<gìkos/Ê›py.h
>

33 
	~<gìkos/pÁt.h
>

34 
	~<gìkos/vfs.h
>

35 
	~<gìkos/u£r.h
>

36 
	~<gìkos/∑gög.h
>

37 
	~<gìkos/gosfs.h
>

38 
	~<gìkos/gfs2.h
>

39 
	~<gìkos/cfs.h
>

40 
	~<gìkos/√t/√2000.h
>

41 
	~<gìkos/√t/√t.h
>

42 
	~<gìkos/√t/√tbuf.h
>

43 
	~<gìkos/√t/¨p.h
>

44 
	~<gìkos/Æ¨m.h
>

45 
	~<gìkos/√t/ù.h
>

46 
	~<gìkos/√t/routög.h
>

47 
	~<gìkos/√t/sockë.h
>

48 
	~<gìkos/√t/rù.h
>

49 
	~<gìkos/¥oje˘s.h
>

50 
	~<gìkos/sound.h
>

51 
	~<gìkos/smp.h
>

52 
	~<gìkos/io.h
>

62 #ifde‡
FD_BOOT


63 
	#ROOT_DEVICE
 "fd0"

	)

64 
	#ROOT_PREFIX
 "a"

	)

66 
	#ROOT_DEVICE
 "ide0"

	)

67 
	#ROOT_PREFIX
 "c"

	)

70 
	#INIT_PROGRAM
 "/" 
ROOT_PREFIX
 "/shñl.exe"

	)

74 
Mou¡_RoŸ_Fûesy°em
();

75 
S∑wn_Inô_Pro˚ss
();

83 
checkPagög
();

86 
	$H¨dw¨e_Shutdown
() {

89 
	`Out_Byã
(0x501, 0x00);

92 
	`Out_Byã
(0x8900, 'S');

93 
	`Out_Byã
(0x8900, 'h');

94 
	`Out_Byã
(0x8900, 'u');

95 
	`Out_Byã
(0x8900, 't');

96 
	`Out_Byã
(0x8900, 'd');

97 
	`Out_Byã
(0x8900, 'o');

98 
	`Out_Byã
(0x8900, 'w');

99 
	`Out_Byã
(0x8900, 'n');

100 
	}
}

102 
	$Maö
(
BoŸ_Info
 *
boŸInfo
) {

103 
	`Inô_BSS
();

104 
	`Inô_S¸ìn
();

105 
	`Inô_Mem
(
boŸInfo
);

106 
	`Inô_CRC32
();

107 
	`Inô_TSS
();

109 
	`lockKî√l
();

110 
	`Inô_I¡îru±s
(0);

111 
	`Inô_VM
(
boŸInfo
);

112 
	`Inô_SMP
();

113 
	`TODO_P
(
PROJECT_VIRTUAL_MEMORY_A
,

115 
	`Inô_ScheduÀr
(0, (*)
KERN_STACK
);

116 
	`Inô_Tøps
();

117 
	`Inô_Loˇl_APIC
(0);

118 
	`Inô_Timî
();

120 
	`Inô_Keybﬂrd
();

121 
	`Inô_DMA
();

123 
	`Inô_IDE
();

124 
	`Inô_PFAT
();

125 
	`Inô_GFS2
();

126 
	`Inô_GOSFS
();

127 
	`Inô_CFS
();

128 
	`Inô_Aœrm
();

130 
	`Rñó£_SMP
();

133 
	`Inô_Nëw‹k_Devi˚s
();

134 
	`Inô_ARP_PrŸocﬁ
();

135 
	`Inô_IP
();

136 
	`Inô_Routög
();

137 
	`Inô_Sockës
();

138 
	`Inô_RIP
();

142 
	`Inô_Sound_Devi˚s
();

145 
	`Mou¡_RoŸ_Fûesy°em
();

147 
	`TODO_P
(
PROJECT_VIRTUAL_MEMORY_A
, "initializeÖage file.");

149 
	`Së_Cuºít_Aâr
(
	`ATTRIB
(
BLACK
, 
GREEN
 | 
BRIGHT
));

150 
	`Pröt
("WelcomeÅo GeekOS!\n");

151 
	`Së_Cuºít_Aâr
(
	`ATTRIB
(
BLACK
, 
GRAY
));

153 
	`TODO_P
(
PROJECT_SOUND
, "play startup sound");

155 
	`S∑wn_Inô_Pro˚ss
();

158 
	`H¨dw¨e_Shutdown
();

161 
	}
}

165 
	$Mou¡_RoŸ_Fûesy°em
() {

166 i‡(
	`Mou¡
(
ROOT_DEVICE
, 
ROOT_PREFIX
, "pfat") != 0)

167 
	`Pröt
("FaûedÅÿmou¡ /" 
ROOT_PREFIX
 " filesystem\n");

169 
	`Pröt
("Mou¡ed /" 
ROOT_PREFIX
 " filesystem!\n");

171 
	}
}

178 
	$S∑wn_Inô_Pro˚ss
() {

179 
rc
;

180 
Kî√l_Thªad
 *
öôPro˚ss
;

183 
	`Pröt
("S∑wnög inôÖro˚s†(%s)\n", 
INIT_PROGRAM
);

184 
rc
 = 
	`S∑wn_F‹eground
(
INIT_PROGRAM
, INIT_PROGRAM, &
öôPro˚ss
);

186 i‡(
rc
 != 0) {

187 
	`Pröt
("FaûedÅÿ•aw¿öôÖro˚ss:Éº‹ codê%d\n", 
rc
);

190 
exôCode
 = 
	`Joö
(
öôPro˚ss
);

191 
	`Pröt
("InôÖro˚s†exôed wôh codê%d\n", 
exôCode
);

193 
	}
}

	@malloc.c

10 
	~<gìkos/s¸ìn.h
>

11 
	~<gìkos/öt.h
>

12 
	~<gìkos/bgë.h
>

13 
	~<gìkos/kas£π.h
>

14 
	~<gìkos/mÆloc.h
>

15 
	~<gìkos/lock.h
>

16 
	~<°rög.h
>

22 
	$Inô_Hóp
(
ul⁄g_t
 
°¨t
, ul⁄g_à
size
) {

23 
	`Pröt
("Cª©ög kî√»hóp: sèπ=%lx, size=%ld\n", 
°¨t
, 
size
);

24 
	`bpoﬁ
((*)
°¨t
, 
size
);

25 
	}
}

27 
Spö_Lock_t
 
	gmÆlocLock
;

34 *
	$MÆloc
(
ul⁄g_t
 
size
) {

35 
boﬁ
 
iÊag
;

36 *
ªsu…
;

38 
	`KASSERT
(
size
 > 0);

40 
iÊag
 = 
	`Begö_I¡_Atomic
();

41 
ªsu…
 = 
	`bgë
(
size
);

42 
	`End_I¡_Atomic
(
iÊag
);

44 i‡(
ªsu…
)

45 
	`mem£t
(
ªsu…
, '\0', 
size
);

47 i‡(!
ªsu…
) {

49 
	`H¨dw¨e_Shutdown
();

50 
	`H¨dw¨e_Shutdown
();

52  
ªsu…
;

53 
	}
}

58 
	$Fªe
(*
buf
) {

59 
boﬁ
 
iÊag
;

61 
	`KASSERT0
(((()
buf
) & 0x3) == 0,

64 
iÊag
 = 
	`Begö_I¡_Atomic
();

65 
	`bªl
(
buf
);

66 
	`End_I¡_Atomic
(
iÊag
);

67 
	}
}

	@mem.c

18 
	~<gìkos/defs.h
>

19 
	~<gìkos/kty≥s.h
>

20 
	~<gìkos/kas£π.h
>

21 
	~<gìkos/kthªad.h
>

22 
	~<gìkos/boŸöfo.h
>

23 
	~<gìkos/gdt.h
>

24 
	~<gìkos/s¸ìn.h
>

25 
	~<gìkos/öt.h
>

26 
	~<gìkos/mÆloc.h
>

27 
	~<gìkos/°rög.h
>

28 
	~<gìkos/∑gög.h
>

29 
	~<gìkos/mem.h
>

38 
Page
 *
	gg_∑geLi°
;

43 
uöt_t
 
	gg_‰ìPageCou¡
 = 0;

52 
debugFau…s
;

53 
	#Debug
(
¨gs
...Ëi‡(
debugFau…s
Ë
	`Pröt
◊rgs)

	)

58 
Page_Li°
 
	gs_‰ìLi°
;

63 
	gs_numPages
;

68 
	$Add_Page_R™ge
(
ul⁄g_t
 
°¨t
, ul⁄g_à
íd
, 
Êags
) {

69 
ul⁄g_t
 
addr
;

71 
	`KASSERT
(
	`Is_Page_Mu…ùÀ
(
°¨t
));

72 
	`KASSERT
(
	`Is_Page_Mu…ùÀ
(
íd
));

73 
	`KASSERT
(
°¨t
 < 
íd
);

75 
addr
 = 
°¨t
;ádd∏< 
íd
;ádd∏+
PAGE_SIZE
) {

76 
Page
 *
∑ge
 = 
	`Gë_Page
(
addr
);

78 
∑ge
->
Êags
 = flags;

80 i‡(
Êags
 =
PAGE_AVAIL
) {

82 
	`Unchecked_Add_To_Back_Of_Page_Li°
(&
s_‰ìLi°
, 
∑ge
);

85 ++
g_‰ìPageCou¡
;

87 
	`Së_Next_In_Page_Li°
(
∑ge
, 0);

88 
	`Së_Pªv_In_Page_Li°
(
∑ge
, 0);

91 
∑ge
->
˛ock
 = 0;

92 
∑ge
->
vaddr
 = 0;

93 
∑ge
->
c⁄ãxt
 = 
NULL
;

94 
∑ge
->
íåy
 = 0;

96 
	}
}

106 
íd
;

112 
	$Inô_Mem
(
BoŸ_Info
 *
boŸInfo
) {

113 i‡(!
boŸInfo
->
memSizeKB
) {

115 
i
;

117 
i
 = 0; i < 
boŸInfo
->
numMemRegi⁄s
; i++) {

118 i‡((
boŸInfo
->
memRegi⁄s
[
i
].
ba£Addr_low
 == 0x100000) &&

119 (
boŸInfo
->
memRegi⁄s
[
i
].
ty≥
 == 1)) {

120 
boŸInfo
->
memSizeKB
 =

121 
boŸInfo
->
memRegi⁄s
[
i
].
Àngth_low
 / 1024;

124 
boŸInfo
->
memSizeKB
 += 0x1000;

127 
ul⁄g_t
 
numPages
 = 
boŸInfo
->
memSizeKB
 >> 2;

128 
ul⁄g_t
 
ídOfMem
 = 
numPages
 * 
PAGE_SIZE
;

129 
numPageLi°Byãs
 = (
Page
Ë* 
numPages
;

130 
ul⁄g_t
 
∑geLi°Addr
;

131 
ul⁄g_t
 
kînEnd
;

132 
ul⁄g_t
 
∑geLi°End
;

134 
	`KASSERT
(
boŸInfo
->
memSizeKB
 > 0);

140 
	`Inô_GDT
(0);

148 
∑geLi°Addr
 = (
HIGHMEM_START
 + 
KERNEL_HEAP_SIZE
);

149 i‡(
∑geLi°Addr
 >
ídOfMem
) {

150 
Pröt


152 
KERNEL_HEAP_SIZE
, 
HIGHMEM_START
, 
ídOfMem
);

153 
	`KASSERT0
(
∑geLi°Addr
 < 
ídOfMem
,

156 
g_∑geLi°
 = (
Page
 *)
∑geLi°Addr
;

157 
∑geLi°End
 = 
	`Round_Up_To_Page
(
∑geLi°Addr
 + 
numPageLi°Byãs
);

160 
	`mem£t
((*)
g_∑geLi°
, '\0', (
∑geLi°End
 - (
ul⁄g_t
) g_pageList));

162 
kînEnd
 = 
	`Round_Up_To_Page
(()&
íd
);

163 
s_numPages
 = 
numPages
;

169 
	`KASSERT
(
ISA_HOLE_END
 =
KERN_THREAD_OBJ
);

170 
	`KASSERT
(
KERN_STACK
 =
KERN_THREAD_OBJ
 + 
PAGE_SIZE
);

184 
	`Add_Page_R™ge
(0, 
PAGE_SIZE
, 
PAGE_UNUSED
);

185 
	`Add_Page_R™ge
(
PAGE_SIZE
, 
KERNEL_START_ADDR
, 
PAGE_AVAIL
);

186 
	`Add_Page_R™ge
(
KERNEL_START_ADDR
, 
kînEnd
, 
PAGE_KERN
);

187 
	`Add_Page_R™ge
(
kînEnd
, 
ISA_HOLE_START
, 
PAGE_AVAIL
);

188 
	`Add_Page_R™ge
(
ISA_HOLE_START
, 
ISA_HOLE_END
, 
PAGE_HW
);

189 
	`Add_Page_R™ge
(
ISA_HOLE_END
, 
HIGHMEM_START
, 
PAGE_ALLOCATED
);

190 
	`Add_Page_R™ge
(
HIGHMEM_START
, HIGHMEM_START + 
KERNEL_HEAP_SIZE
,

191 
PAGE_HEAP
);

192 
	`Add_Page_R™ge
(
∑geLi°Addr
, 
∑geLi°End
, 
PAGE_KERN
);

193 i‡(
∑geLi°End
 > 
ídOfMem
) {

194 
	`KASSERT0
(
∑geLi°End
 < 
ídOfMem
,

198 
	`Add_Page_R™ge
(
∑geLi°End
, 
ídOfMem
, 
PAGE_AVAIL
);

201 
	`Inô_Hóp
(
HIGHMEM_START
, 
KERNEL_HEAP_SIZE
);

203 
Pröt


205 
boŸInfo
->
memSizeKB
, 
g_‰ìPageCou¡
, 
KERNEL_HEAP_SIZE
);

206 
	}
}

211 
	$Inô_BSS
() {

212 
BSS_START
, 
BSS_END
;

215 
	`mem£t
(&
BSS_START
, '\0', &
BSS_END
 - &BSS_START);

216 
	}
}

218 *
	$AŒoc_Page_Føme
() {

219 
Page
 *
∑ge
;

220 *
ªsu…
 = 0;

223 i‡(!
	`Is_Page_Li°_Em±y
(&
s_‰ìLi°
)) {

225 
∑ge
 = 
	`Gë_Fr⁄t_Of_Page_Li°
(&
s_‰ìLi°
);

226 
	`KASSERT
((
∑ge
->
Êags
 & 
PAGE_ALLOCATED
) == 0);

227 
	`Remove_From_Fr⁄t_Of_Page_Li°
(&
s_‰ìLi°
);

230 
∑ge
->
Êags
 |
PAGE_ALLOCATED
;

231 
g_‰ìPageCou¡
--;

232 
ªsu…
 = (*)
	`Gë_Page_Addªss
(
∑ge
);

235 i‡(
ªsu…
) {

236 
	`mem£t
(
ªsu…
, '\0', 4096);

239  
ªsu…
;

240 
	}
}

246 
Page
 *
	$Föd_Page_To_Page_Out
() {

247 
i
;

248 
Page
 *
cuº
, *
be°
;

249 
be°
 = 
NULL
;

250 
i
 = 0; i < 
s_numPages
; i++) {

251 i‡((
g_∑geLi°
[
i
].
Êags
 & 
PAGE_PAGEABLE
) &&

252 (
g_∑geLi°
[
i
].
Êags
 & 
PAGE_ALLOCATED
)) {

253 i‡(!
be°
)

254 
be°
 = &
g_∑geLi°
[
i
];

255 
cuº
 = &
g_∑geLi°
[
i
];

256 i‡((
cuº
->
˛ock
 < 
be°
->˛ockË&& (cuº->
Êags
 & 
PAGE_PAGEABLE
)) {

257 
be°
 = 
cuº
;

261  
be°
;

264 
	}
}

275 *
	$AŒoc_Or_Re˛aim_Page
(
±e_t
 * 
íåy
, 
ul⁄g_t
 
vaddr
,

276 
boﬁ
 
pö√dPage
) {

277 
boﬁ
 
iÊag
;

278 
boﬁ
 
m≠≥dPage
;

279 *
∑ddr
 = 0;

280 
Page
 *
∑ge
 = 0;

282 
iÊag
 = 
	`Begö_I¡_Atomic
();

284 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

285 
	`KASSERT
(
	`Is_Page_Mu…ùÀ
(
vaddr
));

287 
∑ddr
 = 
	`AŒoc_Page_Føme
();

288 i‡(
∑ddr
 != 0) {

289 
∑ge
 = 
	`Gë_Page
((
ul⁄g_t
Ë
∑ddr
);

290 
	`KASSERT
((
∑ge
->
Êags
 & 
PAGE_PAGEABLE
) == 0);

292 
∑gefûeIndex
;

295 
	`Debug
("AboutÅo hunt foráÖageÅoÖage out\n");

296 
∑ge
 = 
	`Föd_Page_To_Page_Out
();

297 
	`KASSERT
(
∑ge
->
Êags
 & 
PAGE_PAGEABLE
);

299 
∑ddr
 = (*)
	`Gë_Page_Addªss
(
∑ge
);

300 
	`Debug
("Sñe˘edÖagê©ádd∏%∞◊gê%d)\n", 
∑ddr
, 
∑ge
->
˛ock
);

303 
∑ge
->
Êags
 &~(
PAGE_PAGEABLE
);

306 
∑ge
->
Êags
 |
PAGE_LOCKED
;

309 i‡(
	`Is_Mm≠ed_Page
(
∑ge
->
c⁄ãxt
,Öage->
vaddr
)) {

310 
m≠≥dPage
 = 
åue
;

311 i‡(
∑ge
->
íåy
->
dúty
) {

312 
	`E«bÀ_I¡îru±s
();

313 
	`Wrôe_Out_Mm≠ed_Page
(
∑ge
->
c⁄ãxt
,Öage->
vaddr
);

314 
	`DißbÀ_I¡îru±s
();

315 
∑ge
->
íåy
->
dúty
 = 0;

317 
∑ge
->
íåy
->
¥e£¡
 = 0;

319 
m≠≥dPage
 = 
Ál£
;

322 
∑gefûeIndex
 = 
	`Föd_S∑˚_On_Pagög_Fûe
();

323 i‡(
∑gefûeIndex
 < 0) {

325 
	`KASSERT0
(
∑ddr
 =
NULL
,

327 
d⁄e
;

329 
	`Debug
("FªêdiskÖagê© index %d\n", 
∑gefûeIndex
);

332 
	`Debug
("WrôögÖhysiˇ»‰amê%∞tÿ∑gög fûê© %d\n", 
∑ddr
,

333 
∑gefûeIndex
);

334 
	`E«bÀ_I¡îru±s
();

335 
	`Wrôe_To_Pagög_Fûe
(
∑ddr
, 
∑ge
->
vaddr
, 
∑gefûeIndex
);

336 
	`DißbÀ_I¡îru±s
();

338 
	`Debug
("WrŸêphysiˇ»‰amê%∞tÿ∑gög fûê© %d\n", 
∑ddr
,

339 
∑gefûeIndex
);

343 i‡(
∑ge
->
Êags
 & 
PAGE_ALLOCATED
) {

346 
∑ge
->
íåy
->
¥e£¡
 = 0;

347 i‡(!
m≠≥dPage
) {

348 
∑ge
->
íåy
->
kî√lInfo
 = 
KINFO_PAGE_ON_DISK
;

349 
∑ge
->
íåy
->
∑geBa£Addr
 = 
∑gefûeIndex
;

353 i‡(!
m≠≥dPage
) {

354 
	`Fªe_S∑˚_On_Pagög_Fûe
(
∑gefûeIndex
);

358 
∑ge
->
Êags
 |
PAGE_ALLOCATED
;

362 
∑ge
->
Êags
 &~(
PAGE_LOCKED
);

365 
	`Flush_TLB
();

369 i‡(
pö√dPage
) {

370 
∑ge
->
Êags
 |
PAGE_LOCKED
;

371 
∑ge
->
íåy
 = 
NULL
;

372 
∑ge
->
vaddr
 = 0;

373 
∑ge
->
c⁄ãxt
 = 
NULL
;

375 
∑ge
->
Êags
 |
PAGE_PAGEABLE
;

376 
∑ge
->
íåy
 =Éntry;

377 
∑ge
->
íåy
->
kî√lInfo
 = 0;

378 
∑ge
->
vaddr
 = vaddr;

379 
∑ge
->
c⁄ãxt
 = 
CURRENT_THREAD
->
u£rC⁄ãxt
;

380 
	`KASSERT
(
∑ge
->
Êags
 & 
PAGE_ALLOCATED
);

383 
d⁄e
:

384 
	`End_I¡_Atomic
(
iÊag
);

385  
∑ddr
;

386 
	}
}

391 *
	$AŒoc_Page
() {

392 *
ªt
;

394 
ªt
 = 
	`AŒoc_Or_Re˛aim_Page
(
NULL
, 0, 
åue
);

395 i‡(!
ªt
) {

397 
	`H¨dw¨e_Shutdown
();

398 
	`H¨dw¨e_Shutdown
();

401  
ªt
;

402 
	}
}

413 *
	$AŒoc_PagóbÀ_Page
(
±e_t
 * 
íåy
, 
ul⁄g_t
 
vaddr
) {

414  
	`AŒoc_Or_Re˛aim_Page
(
íåy
, 
vaddr
, 
Ál£
);

415 
	}
}

420 
	$Fªe_Page
(*
∑geAddr
) {

421 
ul⁄g_t
 
addr
 = (ul⁄g_tË
∑geAddr
;

422 
Page
 *
∑ge
;

424 
	`mem£t
(
∑geAddr
, '\0', 4096);

426 
	`KASSERT
(
	`Is_Page_Mu…ùÀ
(
addr
));

429 
∑ge
 = 
	`Gë_Page
(
addr
);

430 
	`KASSERT0
(
∑ge
, "Couldn't findá struct Page * forÅhe givenÖageAddr");

432 
	`KASSERT0
((
∑ge
->
Êags
 & 
PAGE_ALLOCATED
) != 0,

436 
∑ge
->
Êags
 &~(
PAGE_ALLOCATED
);

439 i‡(
∑ge
->
Êags
 & 
PAGE_LOCKED
)

443 
∑ge
->
Êags
 &~(
PAGE_PAGEABLE
);

446 
∑ge
->
íåy
 = 0;

449 
	`Add_To_Back_Of_Page_Li°
(&
s_‰ìLi°
, 
∑ge
);

450 
g_‰ìPageCou¡
++;

452 
	}
}

	@paging.c

18 
	~<gìkos/°rög.h
>

19 
	~<gìkos/öt.h
>

20 
	~<gìkos/idt.h
>

21 
	~<gìkos/kthªad.h
>

22 
	~<gìkos/kas£π.h
>

23 
	~<gìkos/s¸ìn.h
>

24 
	~<gìkos/mem.h
>

25 
	~<gìkos/mÆloc.h
>

26 
	~<gìkos/gdt.h
>

27 
	~<gìkos/£gmít.h
>

28 
	~<gìkos/u£r.h
>

29 
	~<gìkos/vfs.h
>

30 
	~<gìkos/¸c32.h
>

31 
	~<gìkos/∑gög.h
>

32 
	~<gìkos/î∫o.h
>

33 
	~<gìkos/¥oje˘s.h
>

34 
	~<gìkos/smp.h
>

36 
	~<libc/mm≠.h
>

45 
	#SECTORS_PER_PAGE
 (
PAGE_SIZE
 / 
SECTOR_SIZE
)

	)

50 
	gdebugFau…s
 = 0;

52 
	#Debug
(
¨gs
...Ëi‡(
debugFau…s
Ë
	`Pröt
◊rgs)

	)

55 c⁄° 
pde_t
 *
	$Kî√l_Page_Dú
() {

59  
PageDú
;

60 
	}
}

67 
	$Pröt_Fau…_Info
(
uöt_t
 
addªss
, 
Áu…code_t
 
Áu…Code
) {

68 
uöt_t
 
g_‰ìPageCou¡
;

70 
	`Pröt
("Pid %d: ", 
CURRENT_THREAD
->
pid
);

71 
	`Pröt
("\n Page FaultÑeceived,átáddress %p (%dÖages free)\n",

72 (*)
addªss
, 
g_‰ìPageCou¡
);

73 i‡(
Áu…Code
.
¥Ÿe˘i⁄Viﬁ©i⁄
)

74 
	`Pröt
(" Protection Violation, ");

76 
	`Pröt
(" Non-presentÖage, ");

77 i‡(
Áu…Code
.
wrôeFau…
)

78 
	`Pröt
("Write Fault, ");

80 
	`Pröt
("Read Fault, ");

81 i‡(
Áu…Code
.
u£rModeFau…
)

82 
	`Pröt
("in User Mode\n");

84 
	`Pröt
("in Supervisor Mode\n");

85 
	}
}

93  
	$Page_Fau…_H™dÀr
(
I¡îru±_Sèã
 *
°©e
) {

94 
ul⁄g_t
 
addªss
;

95 
Áu…code_t
 
Áu…Code
;

97 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

100 
addªss
 = 
	`Gë_Page_Fau…_Addªss
();

101 
	`Debug
("PagêÁu… @%lx\n", 
addªss
);

103 i‡(
addªss
 < 0xfec01000 &&áddress > 0xf0000000) {

104 
	`KASSERT0
(0, "page faultáddress in APIC/IOAPICÑange\n");

108 
Áu…Code
 = *((
Áu…code_t
 *Ë& (
°©e
->
îr‹Code
));

111 
	`TODO_P
(
PROJECT_VIRTUAL_MEMORY_B
, "handleÖage faults");

113 
	`Pröt
("Lookög f‹ %x\n", ()
addªss
);

115 
	`TODO_P
(
PROJECT_MMAP
, "handle mmap'dÖage faults");

118 
îr‹
:

119 
	`Pröt
("Unexpected Page FaultÑeceived\n");

120 
	`Pröt_Fau…_Info
(
addªss
, 
Áu…Code
);

121 
	`Dump_I¡îru±_Sèã
(
°©e
);

123 i‡(!
Áu…Code
.
u£rModeFau…
)

124 
	`KASSERT0
(0, "unhandled kernel-modeÖage fault.");

127 
	`Exô
(-1);

128 
	}
}

130 
	$Idíôy_M≠_Page
(
pde_t
 * 
cuºítPageDú
, 
addªss
, 
Êags
) {

131 
	}
}

142 
	$Inô_VM
(
BoŸ_Info
 *
boŸInfo
) {

152 
ul⁄g_t
 
numPages
 = 
boŸInfo
->
memSizeKB
 >> 2;

154 
	`Pröt
("NumÖage†%lu\n", 
numPages
);

155 
ul⁄g_t
 
numPdE¡
 = 
numPages
/
NUM_PAGE_TABLE_ENTRIES
;

157 
PageDú
=
	`AŒoc_Page
();

158 
	`mem£t
(
PageDú
, '\0', 4096);

160 if(
numPages
%
NUM_PAGE_TABLE_ENTRIES
!=0)

162 
numPdE¡
++;

165 
	`Pröt
("Initializing Virtual Memory... \n");

167 
uöt_t
 
i
,
j
;

168 
i
=0;i<
numPdE¡
;i++){

169 
pde_t
 
íåy
 = {0};

170 
±e_t
 *
∑geTabÀ
;

172 
∑geTabÀ
 = 
	`AŒoc_Page
();

173 
	`mem£t
(
∑geTabÀ
, '\0', 4096);

176 
íåy
.
¥e£¡
 = 1;

177 
íåy
.
∑geTabÀBa£Addr
 = ((
ul⁄g_t
Ë
∑geTabÀ
) >> 12;

178 
íåy
.
Êags
 = 
VM_WRITE
;

181 
PageDú
[
i
] = 
íåy
;

184 
i
=
numPdE¡
;i<
NUM_PAGE_DIR_ENTRIES
;i++){

186 
pde_t
 
íåy
 = {0};

187 
PageDú
[
i
] = 
íåy
;

191 
pde_t
 
íåy
 = {0};

192 
±e_t
 *
∑geTabÀ
;

194 
∑geTabÀ
 = 
	`AŒoc_Page
();

195 
	`mem£t
(
∑geTabÀ
, '\0', 4096);

198 
íåy
.
¥e£¡
 = 1;

199 
íåy
.
∑geTabÀBa£Addr
 = ((
ul⁄g_t
Ë
∑geTabÀ
) >> 12;

200 
íåy
.
Êags
 = 
VM_WRITE
;

205 
j
=0;j<256;j++){

208 
±e_t
 
íåy
 = {0};

209 
ul⁄g_t
 
addr
;

211 
íåy
.
¥e£¡
 = 1;

212 
íåy
.
Êags
 = 
VM_WRITE
;

213 
addr
=1019 << 10;

214 
addr
˜dd∏| ((
ul⁄g_t
Ë
j
);

215 
íåy
.
∑geBa£Addr
 = 
addr
;

218 
∑geTabÀ
[
j
] = 
íåy
;

221 
j
=512;j<768;j++){

224 
±e_t
 
íåy
 = {0};

225 
ul⁄g_t
 
addr
;

227 
íåy
.
¥e£¡
 = 1;

228 
íåy
.
Êags
 = 
VM_WRITE
;

229 
addr
=1019 << 10;

230 
addr
˜dd∏| ((
ul⁄g_t
Ë
j
);

231 
íåy
.
∑geBa£Addr
 = 
addr
;

234 
∑geTabÀ
[
j
] = 
íåy
;

237 
PageDú
[1019] = 
íåy
;

241 
i
=0;i<
numPdE¡
;i++){

242 
±e_t
 *
PageTabÀ
 = (±e_à*Ë(
PageDú
[
i
].
∑geTabÀBa£Addr
 << 12);

244 
j
=0;j<
NUM_PAGE_TABLE_ENTRIES
;j++){

246 if(
numPages
%
NUM_PAGE_TABLE_ENTRIES
!=0 && 
i
==
numPdE¡
-1 && 
j
==(numPages%NUM_PAGE_TABLE_ENTRIES)){

249 i‡(
i
==0 && 
j
==0)

251 
±e_t
 
íåy
 = {0};

252 
PageTabÀ
[
j
] = 
íåy
;

257 
±e_t
 
íåy
 = {0};

258 
ul⁄g_t
 
addr
;

260 
íåy
.
¥e£¡
 = 1;

261 
íåy
.
Êags
 = 
VM_WRITE
;

262 
addr
=((
ul⁄g_t
Ë
i
) << 10;

263 
addr
˜dd∏| ((
ul⁄g_t
Ë
j
);

264 
íåy
.
∑geBa£Addr
 = 
addr
;

267 
PageTabÀ
[
j
] = 
íåy
;

273 
	`E«bÀ_Pagög
(
PageDú
);

276 
	`In°Æl_I¡îru±_H™dÀr
(14, 
Page_Fau…_H™dÀr
);

277 
	`In°Æl_I¡îru±_H™dÀr
(46, 
Page_Fau…_H™dÀr
);

280 
	}
}

282 
	$Inô_Sec⁄d¨y_VM
() {

283 
	`TODO_P
(
PROJECT_VIRTUAL_MEMORY_A
, "enableÖaging on secondary cores");

284 
	}
}

291 
	$Inô_Pagefûe
() {

293 
i
;

294 
	`Pröt
("Initializing Pagefile...\n");

295 
i
 = 0; i < 
BITMAP_SIZE
; i++) {

296 
Fªe_BôM≠
[
i
] = 0x11111111;

300 
	`mem£t
(
PF_M≠
, -1, (
ul⁄g_t
) * 33504);

304 
pdev
 = 
	`Gë_Pagög_Devi˚
()->
dev
;

309 
	}
}

317 
	$Föd_S∑˚_On_Pagög_Fûe
() {

318 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

320 
ödex
 = 0, 
i
;

321 
i
 = 0; i < 
BITMAP_SIZE
; i++) {

322 i‡(
Fªe_BôM≠
[
i
]) {

323 
l_ödex
 = 
	`__buûtö_˛zl
(
Fªe_BôM≠
[
i
]);

324 
Fªe_BôM≠
[
i
] ^(1 << (31 - 
l_ödex
));

325  
ödex
 + 
l_ödex
;

328 
ödex
 +
CHAR_BIT
 * (
ul⁄g_t
);

334 
	}
}

341 
	$Fªe_S∑˚_On_Pagög_Fûe
(
∑gefûeIndex
) {

342 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

343 
	`TODO_P
(
PROJECT_VIRTUAL_MEMORY_B
, "FreeÖage inÖaging file");

344 
	}
}

354 
	$Wrôe_To_Pagög_Fûe
(*
∑ddr
, 
ul⁄g_t
 
vaddr
, 
∑gefûeIndex
) {

355 
Page
 *
∑ge
 = 
	`Gë_Page
((
ul⁄g_t
Ë
∑ddr
);

356 
	`KASSERT
(!(
∑ge
->
Êags
 & 
PAGE_PAGEABLE
));

358 
i
;

359 
i
 = 0; i < 8; i++) {

360 
	`Block_Wrôe
(
pdev
, 8 * 
∑gefûeIndex
 + 
i
, (*)
∑ge
 + 512 * i);

363 
Page
 *
g_∑geLi°
;

364 
ul⁄g_t
 
ödex
 = 
∑ge
 - 
g_∑geLi°
;

365 
PF_M≠
[
ödex
] = 
∑gefûeIndex
;

367 
	}
}

378 
	$Ród_From_Pagög_Fûe
(*
∑ddr
, 
ul⁄g_t
 
vaddr
, 
∑gefûeIndex
) {

379 
Page
 *
∑ge
 = 
	`Gë_Page
((
ul⁄g_t
Ë
∑ddr
);

380 
	`KASSERT
(!(
∑ge
->
Êags
 & 
PAGE_PAGEABLE
));

381 
	`TODO_P
(
PROJECT_VIRTUAL_MEMORY_B
, "ReadÖage data fromÖaging file");

382 
	}
}

385 *
	$Mm≠_Im∂
(*
±r
, 
Àngth
, 
¥Ÿ
, 
Êags
, 
fd
) {

386 
	`TODO_P
(
PROJECT_MMAP
, "Mmap setup mapping");

387  
NULL
;

388 
	}
}

390 
boﬁ
 
	$Is_Mm≠ed_Page
(
U£r_C⁄ãxt
 * 
c⁄ãxt
, 
ul⁄g_t
 
vaddr
) {

391 
	`TODO_P
(
PROJECT_MMAP
, "isÅhisÖassed vaddrán mmap'dÖage inÅheÖassed user context");

393  
Ál£
;

394 
	}
}

396 
	$Wrôe_Out_Mm≠ed_Page
(
U£r_C⁄ãxt
 *
c⁄ãxt
, 
ul⁄g_t
 
vaddr
) {

397 
	`TODO_P
(
PROJECT_MMAP
, "Mmap write back dirty mmap'dÖage");

398 
	}
}

400 
	$Munm≠_Im∂
(
ul⁄g_t
 
±r
) {

401 
	`TODO_P
(
PROJECT_MMAP
, "unmappÅheÖages");

402 
	}
}

	@pfat.c

16 
	~<limôs.h
>

17 
	~<gìkos/î∫o.h
>

18 
	~<gìkos/s¸ìn.h
>

19 
	~<gìkos/°rög.h
>

20 
	~<gìkos/mÆloc.h
>

21 
	~<gìkos/ide.h
>

22 
	~<gìkos/blockdev.h
>

23 
	~<gìkos/bô£t.h
>

24 
	~<gìkos/vfs.h
>

25 
	~<gìkos/li°.h
>

26 
	~<gìkos/synch.h
>

27 
	~<gìkos/pÁt.h
>

28 
	~<gìkos/¥oje˘s.h
>

47 
	#PAGEFILE_FILENAME
 "/∑gefûe.bö"

	)

49 
	gdebugPFAT
 = 0;

50 
	#Debug
(
¨gs
...Ëi‡(
debugPFAT
Ë
	`Pröt
("PFAT: "árgs)

	)

52 
	gPFAT_Fûe
;

53 
DEFINE_LIST
(
PFAT_Fûe_Li°
, 
PFAT_Fûe
);

59 
	sPFAT_In°™˚
 {

60 
boŸSe˘‹
 
	mfsöfo
;

61 *
	mÁt
;

62 
dúe˘‹yE¡ry
 *
	mroŸDú
;

63 
dúe˘‹yE¡ry
 
	mroŸDúE¡ry
;

64 
Muãx
 
	mlock
;

65 
PFAT_Fûe_Li°
 
	mfûeLi°
;

74 
	sPFAT_Fûe
 {

75 
dúe˘‹yE¡ry
 *
	míåy
;

76 
ul⁄g_t
 
	mnumBlocks
;

77 
	mcuºBlock
;

78 *
	mfûeD©aCache
;

79 
Muãx
 
	mlock
;

80 
DEFINE_LINK
(
PFAT_Fûe_Li°
, 
PFAT_Fûe
);

82 
IMPLEMENT_LIST
(
PFAT_Fûe_Li°
, 
PFAT_Fûe
);

88 
	$C›y_Sèt
(
VFS_Fûe_Sèt
 *
°©
, 
dúe˘‹yE¡ry
 * 
íåy
) {

89 
°©
->
size
 = 
íåy
->
fûeSize
;

90 
°©
->
isDúe˘‹y
 = 
íåy
->
dúe˘‹y
;

92 
°©
->
isSëuid
 = 
íåy
->
isSëUid
;

93 
	`mem˝y
(
°©
->
a˛s
, 
íåy
->acls, (stat->acls));

94 
	}
}

99 
	$PFAT_FSèt
(
Fûe
 *
fûe
, 
VFS_Fûe_Sèt
 *
°©
) {

100 
PFAT_Fûe
 *
pÁtFûe
 = (PFAT_Fûê*)
fûe
->
fsD©a
;

101 
	`C›y_Sèt
(
°©
, 
pÁtFûe
->
íåy
);

103 
	}
}

108 
	$PFAT_Ród
(
Fûe
 *
fûe
, *
buf
, 
ul⁄g_t
 
numByãs
) {

109 
PFAT_Fûe
 *
pÁtFûe
 = (PFAT_Fûê*)
fûe
->
fsD©a
;

110 
PFAT_In°™˚
 *
ö°™˚
 =

111 (
PFAT_In°™˚
 *)
fûe
->
mou¡Poöt
->
fsD©a
;

112 
ul⁄g_t
 
°¨t
 = 
fûe
->
fûePos
;

113 
ul⁄g_t
 
íd
 = 
fûe
->
fûePos
 + 
numByãs
;

115 i‡(
pÁtFûe
->
íåy
->
dúe˘‹y
)

116  
EINVALID
;

118 i‡(
íd
 > 
fûe
->
ídPos
) {

119 
numByãs
 = 
fûe
->
ídPos
 - fûe->
fûePos
;

120 
íd
 = 
fûe
->
ídPos
;

124 
ul⁄g_t
 
°¨tBlock
, 
ídBlock
, 
curBlock
;

125 
ul⁄g_t
 
i
;

128 i‡(
numByãs
 > 
INT_MAX
)

129  
EINVALID
;

134 i‡(
°¨t
 =
fûe
->
ídPos
) {

139 i‡(
°¨t
 >
fûe
->
ídPos
 || 
íd
 > file->endPos ||Énd < start) {

140 
Debug


142 
fûe
->
fûePos
, 
numByãs
, fûe->
ídPos
);

143  
EINVALID
;

150 
°¨tBlock
 = 
°¨t
 / 
SECTOR_SIZE
;

151 
ídBlock
 = 
	`Round_Up_To_Block
(
íd
Ë/ 
SECTOR_SIZE
;

154 
ul⁄g_t
 
°¨tOff£t
 = 
°¨t
 - (
°¨tBlock
 * 
SECTOR_SIZE
);

161 
	`KASSERT
(
pÁtFûe
->
íåy
);

162 
curBlock
 = 
pÁtFûe
->
cuºBlock
;

163 
ul⁄g_t
 
cuºOff£t
;

164 
ul⁄g_t
 
fú°Block
;

166 
i
 = 
°¨tBlock
; i < 
ídBlock
; ++i) {

168 i‡(
curBlock
 =
FAT_ENTRY_FREE
 || curBlock =
FAT_ENTRY_EOF
) {

169 
	`Pröt
("U√x≥˘edÉnd o‡fûêö FATáàfûêblock %lu\n", 
i
);

170  
EIO
;

174 i‡(
i
 >
°¨tBlock
) {

175 
rc
 = 0;

178 
	`Muãx_Lock
(&
pÁtFûe
->
lock
);

180 
rc
 = 
	`Block_Ród
(
fûe
->
mou¡Poöt
->
dev
, 
curBlock
,

181 
pÁtFûe
->
fûeD©aCache
);

183 i‡(
i
 =
°¨tBlock
) {

185 
sh¨e
;

186 i‡(
numByãs
 < 
SECTOR_SIZE
 - 
°¨tOff£t
) {

188 
	`mem˝y
(
buf
, 
pÁtFûe
->
fûeD©aCache
 + 
°¨tOff£t
,

189 
numByãs
);

190 
cuºOff£t
 = 
numByãs
;

192 
	`mem˝y
(
buf
, 
pÁtFûe
->
fûeD©aCache
 + 
°¨tOff£t
,

193 
SECTOR_SIZE
 - 
°¨tOff£t
);

194 
cuºOff£t
 = 
SECTOR_SIZE
 - 
°¨tOff£t
;

196 
curBlock
 = 
ö°™˚
->
Át
[curBlock];

198 } i‡(
i
 =
ídBlock
 - 1) {

199 
	`mem˝y
(
buf
 + 
cuºOff£t
, 
pÁtFûe
->
fûeD©aCache
,

200 
numByãs
 - 
cuºOff£t
);

201 i‡(
numByãs
 - 
cuºOff£t
 =
SECTOR_SIZE
) {

202 
curBlock
 = 
ö°™˚
->
Át
[curBlock];

204 
cuºOff£t
 +
numByãs
 - currOffset;

206 
	`mem˝y
(
buf
 + 
cuºOff£t
, 
pÁtFûe
->
fûeD©aCache
,

207 
SECTOR_SIZE
);

208 
cuºOff£t
 +
SECTOR_SIZE
;

210 
curBlock
 = 
ö°™˚
->
Át
[curBlock];

214 
	`Muãx_U∆ock
(&
pÁtFûe
->
lock
);

219 
fûe
->
fûePos
 +
numByãs
;

220 
pÁtFûe
->
cuºBlock
 = 
curBlock
;

222 
	`KASSERT
(
cuºOff£t
 =
numByãs
);

223 
	`Debug
("Read satisfied!\n");

225  
numByãs
;

226 
	}
}

231 
	$PFAT_Wrôe
(
Fûe
 *
fûe
, *
±r
, 
ul⁄g_t
 
numByãs
) {

232 *
buf
 = (*)
±r
;

233 
PFAT_Fûe
 *
pÁtFûe
 = (PFAT_Fûê*)
fûe
->
fsD©a
;

234 
PFAT_In°™˚
 *
ö°™˚
 =

235 (
PFAT_In°™˚
 *)
fûe
->
mou¡Poöt
->
fsD©a
;

236 
ul⁄g_t
 
°¨t
 = 
fûe
->
fûePos
;

237 
ul⁄g_t
 
íd
 = 
fûe
->
fûePos
 + 
numByãs
;

239 i‡(
pÁtFûe
->
íåy
->
dúe˘‹y
)

240  
EINVALID
;

242 i‡(!(
fûe
->
mode
 & 
O_WRITE
)) {

243  
EINVALID
;

246 i‡(
numByãs
 % 
SECTOR_SIZE
) {

248  
EINVALID
;

251 i‡(
fûe
->
fûePos
 % 
SECTOR_SIZE
) {

253  
EINVALID
;

256 
	`KASSERT
(
fûe
->
fûePos
 <fûe->
ídPos
);

258 i‡(
fûe
->
fûePos
 + 
numByãs
 > fûe->
ídPos
) {

259 
numByãs
 = 
fûe
->
ídPos
 - fûe->
fûePos
;

265 
ul⁄g_t
 
°¨tBlock
 = 
°¨t
 / 
SECTOR_SIZE
;

266 
ul⁄g_t
 
ídBlock
 = 
	`Round_Up_To_Block
(
íd
Ë/ 
SECTOR_SIZE
;

269 
°¨tOff£t
 = 
°¨t
 - (
°¨tBlock
 * 
SECTOR_SIZE
);

275 
	`KASSERT
(
pÁtFûe
->
íåy
);

276 
ul⁄g_t
 
curBlock
 = 
pÁtFûe
->
íåy
->
fú°Block
;

277 
ul⁄g_t
 
cuºOff£t
 = 0;

278 
ul⁄g_t
 
i
;

279 
i
 = 0; i < 
ídBlock
; ++i) {

281 i‡(
curBlock
 =
FAT_ENTRY_FREE
 || curBlock =
FAT_ENTRY_EOF
) {

282 
	`Pröt
("U√x≥˘edÉnd o‡fûêö FATáàfûêblock %lu\n", 
i
);

283  
EIO
;

287 i‡(
i
 >
°¨tBlock
) {

288 
rc
 = 0;

291 
	`Muãx_Lock
(&
pÁtFûe
->
lock
);

293 
rc
 = 
	`Block_Wrôe
(
fûe
->
mou¡Poöt
->
dev
, 
curBlock
,

294 &
buf
[
cuºOff£t
]);

296 
cuºOff£t
 +
SECTOR_SIZE
;

299 
	`Muãx_U∆ock
(&
pÁtFûe
->
lock
);

301 i‡(
rc
 != 0)

302  
rc
;

306 
ul⁄g_t
 
√xtBlock
 = 
ö°™˚
->
Át
[
curBlock
];

307 
curBlock
 = 
√xtBlock
;

311 
fûe
->
fûePos
 +
numByãs
;

312 
pÁtFûe
->
cuºBlock
 = 
curBlock
;

314  
numByãs
;

315 
	}
}

320 
	$PFAT_Sìk
(
Fûe
 *
fûe
, 
ul⁄g_t
 
pos
) {

321 
PFAT_Fûe
 *
pÁtFûe
 = (PFAT_Fûê*)
fûe
->
fsD©a
;

322 
PFAT_In°™˚
 *
ö°™˚
 =

323 (
PFAT_In°™˚
 *)
fûe
->
mou¡Poöt
->
fsD©a
;

325 i‡(
pos
 >
fûe
->
ídPos
)

326  
EINVALID
;

327 i‡(
fûe
->
fûePos
 !
pos
) {

329 
fûe
->
fûePos
 = 
pos
;

330 
	`KASSERT
(
pÁtFûe
->
íåy
);

331 
ul⁄g_t
 
curBlock
 = 
pÁtFûe
->
íåy
->
fú°Block
;

332 
uöt_t
 
i
;

333 
i
 = 0; i < 
pos
; i += 512) {

334 
curBlock
 = 
ö°™˚
->
Át
[curBlock];

336 
pÁtFûe
->
cuºBlock
 = 
curBlock
;

339 
	}
}

344 
PFAT_Clo£
(
Fûe
 *
fûe
 
__©åibuã__
 ((
unu£d
))) {

356 
Fûe_Ops
 
	gs_pÁtFûeOps
 = {

357 &
PFAT_FSèt
,

358 &
PFAT_Ród
,

359 &
PFAT_Wrôe
,

360 &
PFAT_Sìk
,

361 &
PFAT_Clo£
,

365 
	$PFAT_FSèt_Dú
(
Fûe
 *
dú
, 
VFS_Fûe_Sèt
 *
°©
) {

367 
PFAT_In°™˚
 *
ö°™˚
 =

368 (
PFAT_In°™˚
 *)
dú
->
mou¡Poöt
->
fsD©a
;

369 
	`C›y_Sèt
(
°©
, &
ö°™˚
->
roŸDúE¡ry
);

371 
	}
}

376 
PFAT_Clo£_Dú
(
Fûe
 *
dú
 
__©åibuã__
 ((
unu£d
))) {

384 
	$PFAT_Ród_E¡ry
(
Fûe
 *
dú
, 
VFS_Dú_E¡ry
 *
íåy
) {

385 
dúe˘‹yE¡ry
 *
dúe˘‹y
;

386 
dúe˘‹yE¡ry
 *
pÁtDúE¡ry
;

387 
PFAT_In°™˚
 *
ö°™˚
 =

388 (
PFAT_In°™˚
 *)
dú
->
mou¡Poöt
->
fsD©a
;

390 i‡(
dú
->
fûePos
 >dú->
ídPos
)

391  
VFS_NO_MORE_DIR_ENTRIES
;

393 
dúe˘‹y
 = (
dúe˘‹yE¡ry
 *Ë
dú
->
fsD©a
;

394 
pÁtDúE¡ry
 = &
dúe˘‹y
[
dú
->
fûePos
++];

401 
	`°∫˝y
(
íåy
->
«me
, 
pÁtDúE¡ry
->
fûeName
,

402 (
pÁtDúE¡ry
->
fûeName
));

403 
íåy
->
«me
[(
pÁtDúE¡ry
->
fûeName
)] = '\0';

405 
	`C›y_Sèt
(&
íåy
->
°©s
, 
pÁtDúE¡ry
);

408 
	}
}

413 
Fûe_Ops
 
	gs_pÁtDúOps
 = {

414 &
PFAT_FSèt_Dú
,

418 &
PFAT_Clo£_Dú
,

419 &
PFAT_Ród_E¡ry
,

425 
dúe˘‹yE¡ry
 *
	$PFAT_Lookup
(
Mou¡_Poöt
 *
mou¡Poöt
,

426 
PFAT_In°™˚
 *
ö°™˚
,

427 c⁄° *
∑th
) {

428 
dúe˘‹yE¡ry
 *
roŸDú
 = 
ö°™˚
->rootDir;

429 
boŸSe˘‹
 *
fsöfo
 = &
ö°™˚
->fsinfo;

430 
i
;

432 
	`KASSERT
(*
∑th
 == '/');

435 i‡(
	`°rcmp
(
∑th
, "/") == 0)

436  &
ö°™˚
->
roŸDúE¡ry
;

439 ++
∑th
;

441 
dúe˘‹yE¡ry
 *
cuºDú
 = 
roŸDú
;

442 
dúSize
 = 
fsöfo
->
roŸDúe˘‹yCou¡
;

443 
∑th
) {

444 *
ª°
 = 
	`°rchr
(
∑th
, '/');

445 i‡(
ª°
) {

446 *
ª°
 = '\0';

447 
ª°
++;

449 
found
 = 0;

450 
i
 = 0; i < 
dúSize
; ++i) {

451 
dúe˘‹yE¡ry
 *
íåy
 = &
cuºDú
[
i
];

452 i‡(
	`°rcmp
(
íåy
->
fûeName
, 
∑th
) == 0) {

454 
found
 = 1;

455 i‡(!
ª°
) {

456 
	`Debug
("Found m©chög dúÉ¡ry f‹ %s\n", 
∑th
);

457  
íåy
;

460 
cuºDú
 = 
	`MÆloc
(512);

462 
dúSize
 = 
íåy
->
fûeSize
 / (
dúe˘‹yE¡ry
);

463 
	`Block_Ród
(
mou¡Poöt
->
dev
, 
íåy
->
fú°Block
, 
cuºDú
);

464 
∑th
 = 
ª°
;

469 i‡(!
found
)

475 
	}
}

481 
PFAT_Fûe
 *
	$Gë_PFAT_Fûe
(
PFAT_In°™˚
 *
ö°™˚
,

482 
dúe˘‹yE¡ry
 * 
íåy
) {

483 
ul⁄g_t
 
numBlocks
;

484 
PFAT_Fûe
 *
pÁtFûe
 = 0;

485 *
fûeD©aCache
 = 0;

487 
	`KASSERT
(
íåy
 != 0);

488 
	`KASSERT
(
ö°™˚
 != 0);

490 
	`Muãx_Lock
(&
ö°™˚
->
lock
);

496 
pÁtFûe
 = 
	`Gë_Fr⁄t_Of_PFAT_Fûe_Li°
(&
ö°™˚
->
fûeLi°
);

497 
pÁtFûe
 !0;ÖÁtFûê
	`Gë_Next_In_PFAT_Fûe_Li°
(pfatFile)) {

498 i‡(
pÁtFûe
->
íåy
 ==Éntry)

502 i‡(
pÁtFûe
 == 0) {

504 
numBlocks
 = 
	`Round_Up_To_Block
(
íåy
->
fûeSize
Ë/ 
SECTOR_SIZE
;

510 i‡((
pÁtFûe
 = (
PFAT_Fûe
 *)
	`MÆloc
((*pfatFile))) == 0 ||

511 (
fûeD©aCache
 = 
	`MÆloc
(
SECTOR_SIZE
)) == 0) {

512 
memÁû
;

516 
pÁtFûe
->
íåy
 =Éntry;

517 
pÁtFûe
->
numBlocks
 =ÇumBlocks;

518 
pÁtFûe
->
fûeD©aCache
 = fileDataCache;

519 
	`Muãx_Inô
(&
pÁtFûe
->
lock
);

522 
	`Add_To_Back_Of_PFAT_Fûe_Li°
(&
ö°™˚
->
fûeLi°
, 
pÁtFûe
);

523 
	`KASSERT
(
pÁtFûe
->
√xtPFAT_Fûe_Li°
 == 0);

527 
d⁄e
;

529 
memÁû
:

530 i‡(
pÁtFûe
 != 0)

531 
	`Fªe
(
pÁtFûe
);

532 i‡(
fûeD©aCache
 != 0)

533 
	`Fªe
(
fûeD©aCache
);

534 
pÁtFûe
 = 
NULL
;

536 
d⁄e
:

537 
	`Muãx_U∆ock
(&
ö°™˚
->
lock
);

538  
pÁtFûe
;

539 
	}
}

541 
GëUid
();

547 
	$PFAT_O≥n
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

548 
mode
, 
Fûe
 **
pFûe
) {

549 
rc
 = 0;

550 
PFAT_In°™˚
 *
ö°™˚
 =

551 (
PFAT_In°™˚
 *)
mou¡Poöt
->
fsD©a
;

552 
dúe˘‹yE¡ry
 *
íåy
;

553 
PFAT_Fûe
 *
pÁtFûe
 = 0;

554 
Fûe
 *
fûe
 = 0;

557 i‡((
mode
 & 
O_CREATE
) != 0)

558  
EACCESS
;

561 
íåy
 = 
	`PFAT_Lookup
(
mou¡Poöt
, 
ö°™˚
, 
∑th
);

562 i‡(
íåy
 == 0)

563  
ENOTFOUND
;

567 
pÁtFûe
 = 
	`Gë_PFAT_Fûe
(
ö°™˚
, 
íåy
);

568 i‡(
pÁtFûe
 == 0) {

569 *
pFûe
 = 
NULL
;

570 
rc
 = 
ENOMEM
;

571 
d⁄e
;

574 
pÁtFûe
->
cuºBlock
 =ÖÁtFûe->
íåy
->
fú°Block
;

577 
fûe
 =

578 
	`AŒoˇã_Fûe
(&
s_pÁtFûeOps
, 0, 
íåy
->
fûeSize
, 
pÁtFûe
, 
mode
, 0);

579 i‡(
fûe
 == 0) {

580 
rc
 = 
ENOMEM
;

581 
d⁄e
;

585 *
pFûe
 = 
fûe
;

587 
d⁄e
:

588  
rc
;

589 
	}
}

594 
	$PFAT_O≥n_Dúe˘‹y
(
Mou¡_Poöt
 *
mou¡Poöt
,

595 c⁄° *
∑th
, 
Fûe
 **
pDú
) {

601 
PFAT_In°™˚
 *
ö°™˚
 =

602 (
PFAT_In°™˚
 *)
mou¡Poöt
->
fsD©a
;

603 
Fûe
 *
dú
;

605 i‡(
	`°rcmp
(
∑th
, "/") == 0) {

606 
dú
 = (
Fûe
 *)
	`MÆloc
((*dir));

607 i‡(
dú
 == 0)

608  
ENOMEM
;

610 
dú
->
›s
 = &
s_pÁtDúOps
;

611 
dú
->
fûePos
 = 0;

612 
dú
->
ídPos
 = 
ö°™˚
->
fsöfo
.
roŸDúe˘‹yCou¡
;

613 
dú
->
fsD©a
 = (*)
ö°™˚
->
roŸDú
;

614 *
pDú
 = 
dú
;

617 
dúe˘‹yE¡ry
 *
íåy
;

618 
íåy
 = 
	`PFAT_Lookup
(
mou¡Poöt
, 
ö°™˚
, 
∑th
);

619 i‡(!
íåy
) {

620  
ENOTFOUND
;

622 i‡(!
íåy
->
dúe˘‹y
) {

623  
ENOTFOUND
;

626 
dú
 = (
Fûe
 *)
	`MÆloc
((*dir));

627 i‡(
dú
 == 0)

628  
ENOMEM
;

630 
dú
->
›s
 = &
s_pÁtDúOps
;

631 
dú
->
fûePos
 = 0;

634 
dúe˘‹yE¡ry
 *
ôems
 = (dúe˘‹yE¡ry *Ë
	`MÆloc
(
íåy
->
fûeSize
);

635 i‡(
	`Block_Ród
(
mou¡Poöt
->
dev
, 
íåy
->
fú°Block
, 
ôems
) < 0) {

636 
	`Pröt
("blockÑódáà%d se˘‹ faûed\n", 
íåy
->
fú°Block
);

637  
ENOMEM
;

639 
dú
->
fsD©a
 = (*)
ôems
;

640 
i
;

641 
i
 = 0; i < 
íåy
->
fûeSize
 / (
dúe˘‹yE¡ry
); i++) {

642 i‡(
ôems
[
i
].
fûeName
[0] == '\0')

645 
dú
->
ídPos
 = 
i
;

646 *
pDú
 = 
dú
;

649 
	}
}

654 
	$PFAT_Sèt
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

655 
VFS_Fûe_Sèt
 *
°©
) {

656 
PFAT_In°™˚
 *
ö°™˚
 =

657 (
PFAT_In°™˚
 *)
mou¡Poöt
->
fsD©a
;

658 
dúe˘‹yE¡ry
 *
íåy
;

660 
	`KASSERT
(
∑th
 != 0);

661 
	`KASSERT
(
°©
 != 0);

663 
	`Debug
("PFAT_Sèt(%s)\n", 
∑th
);

665 
íåy
 = 
	`PFAT_Lookup
(
mou¡Poöt
, 
ö°™˚
, 
∑th
);

666 i‡(
íåy
 == 0)

667  
ENOTFOUND
;

669 
	`C›y_Sèt
(
°©
, 
íåy
);

672 
	}
}

677 
PFAT_Sync
(
Mou¡_Poöt
 *
mou¡Poöt
 
__©åibuã__
 ((
unu£d
))) {

682 
	$PFAT_SëSëUid
(
Mou¡_Poöt
 *
mp
, c⁄° *
fûe
,

683 
£tuid
) {

684 
	`TODO_P
(
PROJECT_USER
, "pfat file system SetSetUID operation");

685  
EUNSUPPORTED
;

686 
	}
}

688 
	$PFAT_SëA˛
(
Mou¡_Poöt
 *
mp
, c⁄° *
fûe
, 
uid
,

689 
≥rmissi⁄s
) {

690 
	`TODO_P
(
PROJECT_USER
, "pfat file system SetAcl operation");

691  
EUNSUPPORTED
;

692 
	}
}

697 
Mou¡_Poöt_Ops
 
	gs_pÁtMou¡PoötOps
 = {

698 
PFAT_O≥n
,

700 
PFAT_O≥n_Dúe˘‹y
,

701 
PFAT_Sèt
,

702 
PFAT_Sync
,

707 
PFAT_SëSëUid
,

708 
PFAT_SëA˛
,

717 
	$PFAT_Regi°î_Pagög_Fûe
(
Mou¡_Poöt
 *
mou¡Poöt
,

718 
PFAT_In°™˚
 *
ö°™˚
) {

719 
dúe˘‹yE¡ry
 *
∑gefûeE¡ry
;

720 
Pagög_Devi˚
 *
∑gedev
 = 0;

721 
size_t
 
«meLí
;

722 *
fûeName
 = 0;

724 i‡(
	`Gë_Pagög_Devi˚
() != 0)

727 
∑gefûeE¡ry
 = 
	`PFAT_Lookup
(
mou¡Poöt
, 
ö°™˚
, 
PAGEFILE_FILENAME
);

728 i‡(
∑gefûeE¡ry
 == 0)

734 
∑gedev
 = (
Pagög_Devi˚
 *)
	`MÆloc
((*pagedev));

735 i‡(
∑gedev
 == 0)

736 
memÁû
;

737 
«meLí
 = 
	`°æí
(
mou¡Poöt
->
∑thPªfix
Ë+ såÀn(
PAGEFILE_FILENAME
) + 3;

738 
fûeName
 = (*)
	`MÆloc
(
«meLí
);

739 i‡(
fûeName
 == 0)

740 
memÁû
;

743 
	`¢¥ötf
(
fûeName
, 
«meLí
, "/%s%s", 
mou¡Poöt
->
∑thPªfix
,

744 
PAGEFILE_FILENAME
);

747 
∑gedev
->
fûeName
 = fileName;

748 
∑gedev
->
dev
 = 
mou¡Poöt
->dev;

749 
∑gedev
->
°¨tSe˘‹
 = 
∑gefûeE¡ry
->
fú°Block
;

750 
∑gedev
->
numSe˘‹s
 = 
∑gefûeE¡ry
->
fûeSize
 / 
SECTOR_SIZE
;

753 
	`Regi°î_Pagög_Devi˚
(
∑gedev
);

756 
memÁû
:

757 
	`Pröt
(" Error: couldÇot createÖaging device forÖfat on %s (%s)\n",

758 
mou¡Poöt
->
∑thPªfix
, mou¡Poöt->
dev
->
«me
);

759 i‡(
∑gedev
 != 0)

760 
	`Fªe
(
∑gedev
);

761 i‡(
fûeName
 != 0)

762 
	`Fªe
(
fûeName
);

763 
	}
}

768 
	$PFAT_Mou¡
(
Mou¡_Poöt
 *
mou¡Poöt
) {

769 
PFAT_In°™˚
 *
ö°™˚
 = 0;

770 
boŸSe˘‹
 *
fsöfo
;

771 *
boŸSe˘
 = 0;

772 
roŸDúSize
;

773 
rc
;

774 
i
;

777 
ö°™˚
 = (
PFAT_In°™˚
 *)
	`MÆloc
((*instance));

778 i‡(
ö°™˚
 == 0)

779 
memÁû
;

780 
	`mem£t
(
ö°™˚
, '\0', (*instance));

781 
fsöfo
 = &
ö°™˚
->fsinfo;

782 
	`Debug
("Created instance object\n");

788 
boŸSe˘
 = 
	`MÆloc
(
SECTOR_SIZE
);

789 i‡(
boŸSe˘
 == 0)

790 
memÁû
;

793 i‡((
rc
 = 
	`Block_Ród
(
mou¡Poöt
->
dev
, 0, 
boŸSe˘
)) < 0)

794 
Áû
;

795 
	`Debug
("Read boot sector\n");

798 
	`mem˝y
(&
ö°™˚
->
fsöfo
, ((*)
boŸSe˘
Ë+ 
PFAT_BOOT_RECORD_OFFSET
,

799 (
boŸSe˘‹
));

800 
	`Debug
("Copied bootÑecord\n");

803 i‡(
fsöfo
->
magic
 !
PFAT_MAGIC
) {

804 
	`Pröt
("Bad magi¯numbî (%xËf‹ PFAT fûesy°em\n", 
fsöfo
->
magic
);

805 
övÆidfs
;

807 
	`Debug
("MagicÇumber is good!\n");

810 i‡(
fsöfo
->
fûeAŒoˇti⁄Off£t
 <= 0 ||

811 
fsöfo
->
fûeAŒoˇti⁄Lígth
 <= 0 ||

812 
fsöfo
->
roŸDúe˘‹yCou¡
 < 0 || fsöfo->
roŸDúe˘‹yOff£t
 <= 0) {

813 
	`Pröt
("InvalidÖarameters for PFAT filesystem\n");

814 
övÆidfs
;

816 
	`Debug
("PFAT filesystemÖarametersáppearÅo be good!\n");

819 
ö°™˚
->
Át
 = (*)
	`MÆloc
(
fsöfo
->
fûeAŒoˇti⁄Lígth
 * 
SECTOR_SIZE
);

820 i‡(
ö°™˚
->
Át
 == 0)

821 
memÁû
;

824 
i
 = 0; i < 
fsöfo
->
fûeAŒoˇti⁄Lígth
; ++i) {

825 
blockNum
 = 
fsöfo
->
fûeAŒoˇti⁄Off£t
 + 
i
;

826 *
p
 = ((*)
ö°™˚
->
Át
Ë+ (
i
 * 
SECTOR_SIZE
);

827 i‡((
rc
 = 
	`Block_Ród
(
mou¡Poöt
->
dev
, 
blockNum
, 
p
)) < 0)

828 
Áû
;

830 
	`Debug
("Read FAT successfully!\n");

832 i‡(
fsöfo
->
roŸDúe˘‹yCou¡
 > 0) {

834 
roŸDúSize
 =

835 
	`Round_Up_To_Block
((
dúe˘‹yE¡ry
) *

836 
fsöfo
->
roŸDúe˘‹yCou¡
);

837 
ö°™˚
->
roŸDú
 = (
dúe˘‹yE¡ry
 *Ë
	`MÆloc
(
roŸDúSize
);

840 
	`Debug
("RoŸ dúe˘‹y sizê%d\n", 
roŸDúSize
);

841 
i
 = 0; i < 
roŸDúSize
; i +
SECTOR_SIZE
) {

842 
blockNum
 = 
fsöfo
->
roŸDúe˘‹yOff£t
 + 
i
 / 
SECTOR_SIZE
;

843 i‡((
rc
 =

844 
	`Block_Ród
(
mou¡Poöt
->
dev
, 
blockNum
,

845 (*)(()
ö°™˚
->
roŸDú
 + 
i
))) < 0)

846 
Áû
;

848 
	`Debug
("ReadÑoot directory successfully!\n");

850 
	`Pröt
("Warning: missingÑoot directory in PFAT");

851 
ö°™˚
->
roŸDú
 = 
NULL
;

855 
	`mem£t
(&
ö°™˚
->
roŸDúE¡ry
, '\0', (
dúe˘‹yE¡ry
));

856 
ö°™˚
->
roŸDúE¡ry
.
ªadO∆y
 = 1;

857 
ö°™˚
->
roŸDúE¡ry
.
dúe˘‹y
 = 1;

858 
ö°™˚
->
roŸDúE¡ry
.
fûeSize
 =

859 
ö°™˚
->
fsöfo
.
roŸDúe˘‹yCou¡
 * (
dúe˘‹yE¡ry
);

862 
	`Muãx_Inô
(&
ö°™˚
->
lock
);

863 
	`CÀ¨_PFAT_Fûe_Li°
(&
ö°™˚
->
fûeLi°
);

866 
	`PFAT_Regi°î_Pagög_Fûe
(
mou¡Poöt
, 
ö°™˚
);

873 
mou¡Poöt
->
›s
 = &
s_pÁtMou¡PoötOps
;

874 
mou¡Poöt
->
fsD©a
 = 
ö°™˚
;

877 
memÁû
:

878 
rc
 = 
ENOMEM
;

879 
Áû
;

880 
övÆidfs
:

881 
rc
 = 
EINVALIDFS
;

882 
Áû
;

883 
Áû
:

884 i‡(
ö°™˚
 != 0) {

885 i‡(
ö°™˚
->
Át
 != 0)

886 
	`Fªe
(
ö°™˚
->
Át
);

887 i‡(
ö°™˚
->
roŸDú
 != 0)

888 
	`Fªe
(
ö°™˚
->
roŸDú
);

889 
	`Fªe
(
ö°™˚
);

891 i‡(
boŸSe˘
 != 0)

892 
	`Fªe
(
boŸSe˘
);

893  
rc
;

894 
	}
}

896 
Fûesy°em_Ops
 
	gs_pÁtFûesy°emOps
 = {

898 &
PFAT_Mou¡
,

905 
	$Inô_PFAT
() {

906 
	`Regi°î_Fûesy°em
("pÁt", &
s_pÁtFûesy°emOps
);

907 
	}
}

	@pipe.c

13 
	~<gìkos/pùe.h
>

14 
	~<gìkos/mÆloc.h
>

15 
	~<gìkos/°rög.h
>

16 
	~<gìkos/î∫o.h
>

17 
	~<gìkos/¥oje˘s.h
>

18 
	~<gìkos/öt.h
>

21 
Fûe_Ops
 
	gPùe_Ród_Ops
 =

22 { 
NULL
, 
Pùe_Ród
, NULL, NULL, 
Pùe_Clo£
, NULL };

23 
Fûe_Ops
 
	gPùe_Wrôe_Ops
 =

24 { 
NULL
, NULL, 
Pùe_Wrôe
, NULL, 
Pùe_Clo£
, NULL };

26 
	$Pùe_Cª©e
(
Fûe
 **
ªad_fûe
, Fûê**
wrôe_fûe
) {

27 
	`TODO_P
(
PROJECT_PIPE
, "CreateáÖipe");

28 
	}
}

30 
	$Pùe_Ród
(
Fûe
 *
f
, *
buf
, 
ul⁄g_t
 
numByãs
) {

31 
	`TODO_P
(
PROJECT_PIPE
, "PipeÑead");

32 
	}
}

34 
	$Pùe_Wrôe
(
Fûe
 *
f
, *
buf
, 
ul⁄g_t
 
numByãs
) {

35 
	`TODO_P
(
PROJECT_PIPE
, "Pipe write");

36 
	}
}

38 
	$Pùe_Clo£
(
Fûe
 *
f
) {

39 
	`TODO_P
(
PROJECT_PIPE
, "Pipe close");

41 
	}
}

	@screen.c

10 
	~<°d¨g.h
>

11 
	~<gìkos/kas£π.h
>

12 
	~<gìkos/kty≥s.h
>

13 
	~<gìkos/io.h
>

14 
	~<gìkos/öt.h
>

15 
	~<gìkos/fmtout.h
>

16 
	~<gìkos/s¸ìn.h
>

17 
	~<gìkos/lock.h
>

29 
	#ESC
 ((Ë0x1B)

	)

30 
	#DEFAULT_ATTRIBUTE
 
	`ATTRIB
(
BLACK
, 
GRAY
)

	)

32 
	eSèã
 {

33 
	mS_NORMAL
,

34 
	mS_ESC
,

35 
	mS_ESC2
,

36 
	mS_ARG
,

37 
	mS_CMD
,

40 
	#MAXARGS
 8

	)

42 
	sC⁄sﬁe_Sèã
 {

44 
	mrow
, 
	mcﬁ
;

45 
	mßveRow
, 
	mßveCﬁ
;

46 
uch¨_t
 
	mcuºítAâr
;

49 
Sèã
 
	m°©e
;

50 
	m¨gLi°
[
MAXARGS
];

51 
	mnumArgs
;

54 
C⁄sﬁe_Sèã
 
	gs_c⁄s
;

56 
	#NUM_SCREEN_DWORDS
 ((
NUMROWS
 * 
NUMCOLS
 * 2Ë/ 4)

	)

57 
	#NUM_SCROLL_DWORDS
 (((
NUMROWS
-1Ë* 
NUMCOLS
 * 2Ë/ 4)

	)

58 
	#NUM_DWORDS_PER_LINE
 ((
NUMCOLS
*2)/4)

	)

59 
	#FILL_DWORD
 (0x00200020 | (
s_c⁄s
.
cuºítAâr
<<24Ë| (s_c⁄s.cuºítAâr<<8))

	)

65 
	$S¸ﬁl
() {

66 
uöt_t
 *
v
;

67 
i
, 
n
 = 
NUM_SCROLL_DWORDS
;

68 
uöt_t
 
fûl
 = 
FILL_DWORD
;

71 
v
 = (
uöt_t
 *Ë
VIDMEM
, 
i
 = 0; i < 
n
; ++i) {

72 *
v
 = *(v + 
NUM_DWORDS_PER_LINE
);

73 ++
v
;

77 
v
 = (
uöt_t
 *Ë
VIDMEM
 + 
n
, 
i
 = 0; i < 
NUM_DWORDS_PER_LINE
; ++i)

78 *
v
++ = 
fûl
;

79 
	}
}

85 
	$CÀ¨_To_EOL
() {

86 
n
 = (
NUMCOLS
 - 
s_c⁄s
.
cﬁ
);

87 
uch¨_t
 *
v
 = 
VIDMEM
 + 
s_c⁄s
.
row
 * (
NUMCOLS
 * 2Ë+ s_c⁄s.
cﬁ
 * 2;

88 
n
-- > 0) {

89 *
v
++ = ' ';

90 *
v
++ = 
s_c⁄s
.
cuºítAâr
;

92 
	}
}

98 
	$Newlöe
() {

99 ++
s_c⁄s
.
row
;

100 
s_c⁄s
.
cﬁ
 = 0;

101 i‡(
s_c⁄s
.
row
 =
NUMROWS
) {

102 
	`S¸ﬁl
();

103 
s_c⁄s
.
row
 = 
NUMROWS
 - 1;

105 
	}
}

112 
	$Put_Gøphic_Ch¨
(
c
) {

113 
uch¨_t
 *
v
 = 
VIDMEM
 + 
s_c⁄s
.
row
 * (
NUMCOLS
 * 2Ë+ s_c⁄s.
cﬁ
 * 2;

116 *
v
++ = (
uch¨_t
Ë
c
;

117 *
v
 = 
s_c⁄s
.
cuºítAâr
;

119 i‡(
s_c⁄s
.
cﬁ
 < 
NUMCOLS
 - 1)

120 ++
s_c⁄s
.
cﬁ
;

122 
	`Newlöe
();

123 
	}
}

130 
	$Ouçut_LôîÆ_Ch¨a˘î
(
c
) {

131 
numS∑˚s
;

133 
c
) {

135 
	`CÀ¨_To_EOL
();

136 
	`Newlöe
();

140 
numS∑˚s
 = 
TABWIDTH
 - (
s_c⁄s
.
cﬁ
 % TABWIDTH);

141 
numS∑˚s
-- > 0)

142 
	`Put_Gøphic_Ch¨
(' ');

146 
	`Put_Gøphic_Ch¨
(
c
);

150 #i‚de‡
NDEBUG


157 
	`Out_Byã
(0xE9, 
c
);

159 
	}
}

164 
	$Move_Curs‹
(
row
, 
cﬁ
) {

165 i‡(
row
 < 0)

166 
row
 = 0;

167 i‡(
row
 >
NUMROWS
)

168 
row
 = 
NUMROWS
 - 1;

170 i‡(
cﬁ
 < 0)

171 
cﬁ
 = 0;

172 i‡(
cﬁ
 >
NUMCOLS
)

173 
cﬁ
 = 
NUMCOLS
 - 1;

175 
s_c⁄s
.
row
 =Ñow;

176 
s_c⁄s
.
cﬁ
 = col;

177 
	}
}

182 c⁄° 
uch¨_t
 
	gs_™siToVgaCﬁ‹
[] = {

183 
BLACK
, 
RED
, 
GREEN
, 
AMBER
, 
BLUE
, 
MAGENTA
, 
CYAN
, 
GRAY


190 
	$Upd©e_Aâribuãs
() {

191 
i
;

192 
©å
 = 
s_c⁄s
.
cuºítAâr
 & ~(
BRIGHT
);

194 
i
 = 0; i < 
s_c⁄s
.
numArgs
; ++i) {

195 
vÆue
 = 
s_c⁄s
.
¨gLi°
[
i
];

196 i‡(
vÆue
 == 0)

197 
©å
 = 
DEFAULT_ATTRIBUTE
;

198 i‡(
vÆue
 == 1)

199 
©å
 |
BRIGHT
;

200 i‡(
vÆue
 >= 30 && value <= 37)

201 
©å
 = (©å & ~0x7Ë| 
s_™siToVgaCﬁ‹
[
vÆue
 - 30];

202 i‡(
vÆue
 >= 40 && value <= 47)

203 
©å
 = (©å & ~(0x7 << 4)Ë| (
s_™siToVgaCﬁ‹
[
vÆue
 - 40] << 4);

205 
s_c⁄s
.
cuºítAâr
 = 
©å
;

206 
	}
}

209 
	$Re£t
() {

210 
s_c⁄s
.
°©e
 = 
S_NORMAL
;

211 
s_c⁄s
.
numArgs
 = 0;

212 
	}
}

215 
	$Sèπ_Esˇ≥
() {

216 
s_c⁄s
.
°©e
 = 
S_ESC
;

217 
s_c⁄s
.
numArgs
 = 0;

218 
	}
}

221 
	$Sèπ_Arg
(
¨gNum
) {

222 
	`KASSERT
(
s_c⁄s
.
numArgs
 =
¨gNum
);

223 
s_c⁄s
.
numArgs
++;

224 
s_c⁄s
.
°©e
 = 
S_ARG
;

225 i‡(
¨gNum
 < 
MAXARGS
)

226 
s_c⁄s
.
¨gLi°
[
¨gNum
] = 0;

227 
	}
}

230 
	$Save_Curs‹
() {

231 
s_c⁄s
.
ßveRow
 = s_c⁄s.
row
;

232 
s_c⁄s
.
ßveCﬁ
 = s_c⁄s.
cﬁ
;

233 
	}
}

236 
	$Re°‹e_Curs‹
() {

237 
s_c⁄s
.
row
 = s_c⁄s.
ßveRow
;

238 
s_c⁄s
.
cﬁ
 = s_c⁄s.
ßveCﬁ
;

239 
	}
}

242 
	$Add_Digô
(
c
) {

243 
	`KASSERT
(
	`ISDIGIT
(
c
));

244 i‡(
s_c⁄s
.
numArgs
 < 
MAXARGS
) {

245 
¨gNum
 = 
s_c⁄s
.
numArgs
 - 1;

246 
s_c⁄s
.
¨gLi°
[
¨gNum
] *= 10;

247 
s_c⁄s
.
¨gLi°
[
¨gNum
] +(
c
 - '0');

249 
	}
}

255 
	$Gë_Arg
(
¨gNum
) {

256  
¨gNum
 < 
s_c⁄s
.
numArgs
 ? s_c⁄s.
¨gLi°
[argNum] : 0;

257 
	}
}

265 
	$Put_Ch¨_Imp
(
c
) {

266 
agaö
:

267 
s_c⁄s
.
°©e
) {

268 
S_NORMAL
:

269 i‡(
c
 =
ESC
)

270 
	`Sèπ_Esˇ≥
();

272 
	`Ouçut_LôîÆ_Ch¨a˘î
(
c
);

275 
S_ESC
:

276 i‡(
c
 == '[')

277 
s_c⁄s
.
°©e
 = 
S_ESC2
;

279 
	`Re£t
();

282 
S_ESC2
:

283 i‡(
	`ISDIGIT
(
c
)) {

284 
	`Sèπ_Arg
(0);

285 
agaö
;

286 } i‡(
c
 == ';') {

288 
	`Sèπ_Arg
(0);

289 
	`Add_Digô
('1');

290 
	`Sèπ_Arg
(1);

292 
s_c⁄s
.
°©e
 = 
S_CMD
;

293 
agaö
;

297 
S_ARG
:

298 i‡(
	`ISDIGIT
(
c
))

299 
	`Add_Digô
(
c
);

300 i‡(
c
 == ';')

301 
	`Sèπ_Arg
(
s_c⁄s
.
numArgs
);

303 
s_c⁄s
.
°©e
 = 
S_CMD
;

304 
agaö
;

308 
S_CMD
:

309 
c
) {

311 
	`CÀ¨_To_EOL
();

314 
	`Save_Curs‹
();

317 
	`Re°‹e_Curs‹
();

320 
	`Move_Curs‹
(
s_c⁄s
.
row
 - 
	`Gë_Arg
(0), s_c⁄s.
cﬁ
);

323 
	`Move_Curs‹
(
s_c⁄s
.
row
 + 
	`Gë_Arg
(0), s_c⁄s.
cﬁ
);

326 
	`Move_Curs‹
(
s_c⁄s
.
row
, s_c⁄s.
cﬁ
 + 
	`Gë_Arg
(0));

329 
	`Move_Curs‹
(
s_c⁄s
.
row
, s_c⁄s.
cﬁ
 - 
	`Gë_Arg
(0));

332 
	`Upd©e_Aâribuãs
();

336 i‡(
s_c⁄s
.
numArgs
 == 2)

337 
	`Move_Curs‹
(
	`Gë_Arg
(0) - 1, Get_Arg(1) - 1);

340 i‡(
s_c⁄s
.
numArgs
 =1 && 
	`Gë_Arg
(0) == 2) {

341 
	`CÀ¨_S¸ìn
();

342 
	`Put_Curs‹
(0, 0);

348 
	`Re£t
();

352 
	`KASSERT
(
Ál£
);

354 
	}
}

359 
	$Upd©e_Curs‹
() {

364 
uöt_t
 
ch¨a˘îPos
 = (
s_c⁄s
.
row
 * 
NUMCOLS
Ë+ s_c⁄s.
cﬁ
;

365 
uch¨_t
 
‹igAddr
;

372 
‹igAddr
 = 
	`In_Byã
(
CRT_ADDR_REG
);

373 
	`IO_Dñay
();

376 
	`Out_Byã
(
CRT_ADDR_REG
, 
CRT_CURSOR_LOC_HIGH_REG
);

377 
	`IO_Dñay
();

378 
	`Out_Byã
(
CRT_DATA_REG
, (
ch¨a˘îPos
 >> 8) & 0xff);

379 
	`IO_Dñay
();

382 
	`Out_Byã
(
CRT_ADDR_REG
, 
CRT_CURSOR_LOC_LOW_REG
);

383 
	`IO_Dñay
();

384 
	`Out_Byã
(
CRT_DATA_REG
, 
ch¨a˘îPos
 & 0xff);

385 
	`IO_Dñay
();

388 
	`Out_Byã
(
CRT_ADDR_REG
, 
‹igAddr
);

389 
	}
}

398 
	$Inô_S¸ìn
() {

399 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

401 
s_c⁄s
.
row
 = s_c⁄s.
cﬁ
 = 0;

402 
s_c⁄s
.
cuºítAâr
 = 
DEFAULT_ATTRIBUTE
;

403 
	`CÀ¨_S¸ìn
();

405 
	`End_I¡_Atomic
(
iÊag
);

406 
	}
}

411 
	$CÀ¨_S¸ìn
() {

412 
uöt_t
 *
v
 = (uöt_à*Ë
VIDMEM
;

413 
i
;

414 
uöt_t
 
fûl
 = 
FILL_DWORD
;

416 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

418 
i
 = 0; i < 
NUM_SCREEN_DWORDS
; ++i)

419 *
v
++ = 
fûl
;

421 
	`End_I¡_Atomic
(
iÊag
);

422 
	}
}

427 
	$Gë_Curs‹
(*
row
, *
cﬁ
) {

428 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

429 *
row
 = 
s_c⁄s
.row;

430 *
cﬁ
 = 
s_c⁄s
.col;

431 
	`End_I¡_Atomic
(
iÊag
);

432 
	}
}

439 
boﬁ
 
	$Put_Curs‹
(
row
, 
cﬁ
) {

440 
boﬁ
 
iÊag
;

442 i‡(
row
 < 0 ||Ñow >
NUMROWS
 || 
cﬁ
 < 0 || cﬁ >
NUMCOLS
)

443  
Ál£
;

445 
iÊag
 = 
	`Begö_I¡_Atomic
();

446 
s_c⁄s
.
row
 =Ñow;

447 
s_c⁄s
.
cﬁ
 = col;

448 
	`Upd©e_Curs‹
();

449 
	`End_I¡_Atomic
(
iÊag
);

451  
åue
;

452 
	}
}

457 
uch¨_t
 
	$Gë_Cuºít_Aâr
() {

458  
s_c⁄s
.
cuºítAâr
;

459 
	}
}

464 
	$Së_Cuºít_Aâr
(
uch¨_t
 
©åib
) {

465 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

466 
s_c⁄s
.
cuºítAâr
 = 
©åib
;

467 
	`End_I¡_Atomic
(
iÊag
);

468 
	}
}

474 
	$Put_Ch¨
(
c
) {

475 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

476 
	`Put_Ch¨_Imp
(
c
);

477 
	`Upd©e_Curs‹
();

478 
	`End_I¡_Atomic
(
iÊag
);

479 
	}
}

485 
	$Put_Såög
(c⁄° *
s
) {

486 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

487 *
s
 != '\0')

488 
	`Put_Ch¨_Imp
(*
s
++);

489 
	`Upd©e_Curs‹
();

490 
	`End_I¡_Atomic
(
iÊag
);

491 
	}
}

497 
	$Put_Buf
(c⁄° *
buf
, 
ul⁄g_t
 
Àngth
) {

498 
boﬁ
 
iÊag
 = 
	`Begö_I¡_Atomic
();

499 
Àngth
 > 0) {

500 
	`Put_Ch¨_Imp
(*
buf
++);

501 --
Àngth
;

503 
	`Upd©e_Curs‹
();

504 
	`End_I¡_Atomic
(
iÊag
);

505 
	}
}

508 
Pröt_Emô
(
Ouçut_Sök
 *
o
 
__©åibuã__
 ((
unu£d
)), 
ch
) {

509 
Put_Ch¨_Imp
(
ch
);

511 
Pröt_Föish
(
Ouçut_Sök
 *
o
 
__©åibuã__
 ((
unu£d
))) {

512 
Upd©e_Curs‹
();

514 
Ouçut_Sök
 
	gs_ouçutSök
 = { &
Pröt_Emô
, &
Pröt_Föish
 };

516 
Spö_Lock_t
 
	g¥ötLock
;

522 
	$Pröt
(c⁄° *
fmt
, ...) {

523 
va_li°
 
¨gs
;

527 
	`va_°¨t
(
¨gs
, 
fmt
);

528 
	`F‹m©_Ouçut
(&
s_ouçutSök
, 
fmt
, 
¨gs
);

529 
	`va_íd
(
¨gs
);

532 
	}
}

	@segment.c

20 
	~<gìkos/kas£π.h
>

21 
	~<gìkos/°rög.h
>

22 
	~<gìkos/tss.h
>

23 
	~<gìkos/£gmít.h
>

25 
__ölöe__
 
	$Së_Size_And_Ba£_Pages
(
Segmít_Des¸ùt‹


26 *
desc
, 
ul⁄g_t
 
ba£Addr
,

27 
ul⁄g_t
 
numPages
) {

35 
	`KASSERT
(
numPages
 > 0);

36 
numPages
 -= 1;

38 
desc
->
sizeLow
 = 
numPages
 & 0xFFFF;

39 
desc
->
sizeHigh
 = (
numPages
 >> 16) & 0x0F;

40 
desc
->
ba£Low
 = 
ba£Addr
 & 0xFFFFFF;

41 
desc
->
ba£High
 = (
ba£Addr
 >> 24) & 0xFF;

42 
desc
->
gønuœrôy
 = 1;

43 
	}
}

45 
__ölöe__
 
	$Së_Size_And_Ba£_Byãs
(
Segmít_Des¸ùt‹


46 *
desc
, 
ul⁄g_t
 
ba£Addr
,

47 
ul⁄g_t
 
numByãs
) {

48 
desc
->
sizeLow
 = 
numByãs
 & 0xFFFF;

49 
desc
->
sizeHigh
 = (
numByãs
 >> 16) & 0x0F;

50 
desc
->
ba£Low
 = 
ba£Addr
 & 0xFFFFFF;

51 
desc
->
ba£High
 = (
ba£Addr
 >> 24) & 0xFF;

52 
desc
->
gønuœrôy
 = 0;

53 
	}
}

58 
	$Inô_NuŒ_Segmít_Des¸ùt‹
(
Segmít_Des¸ùt‹
 *
desc
) {

59 
	`mem£t
(
desc
, '\0', (*desc));

60 
	}
}

65 
	$Inô_Code_Segmít_Des¸ùt‹
(
Segmít_Des¸ùt‹
 *
desc
,

66 
ul⁄g_t
 
ba£Addr
,

67 
ul⁄g_t
 
numPages
, 
¥ivûegeLevñ
) {

68 
	`KASSERT
(
¥ivûegeLevñ
 >= 0 &&ÖrivilegeLevel <= 3);

70 
	`Së_Size_And_Ba£_Pages
(
desc
, 
ba£Addr
, 
numPages
);

71 
desc
->
ty≥
 = 0x0A;

72 
desc
->
sy°em
 = 1;

73 
desc
->
d∂
 = 
¥ivûegeLevñ
;

74 
desc
->
¥e£¡
 = 1;

75 
desc
->
ª£rved
 = 0;

76 
desc
->
dbBô
 = 1;

77 
	}
}

82 
	$Inô_D©a_Segmít_Des¸ùt‹
(
Segmít_Des¸ùt‹
 *
desc
,

83 
ul⁄g_t
 
ba£Addr
,

84 
ul⁄g_t
 
numPages
, 
¥ivûegeLevñ
) {

85 
	`KASSERT
(
¥ivûegeLevñ
 >= 0 &&ÖrivilegeLevel <= 3);

87 
	`Së_Size_And_Ba£_Pages
(
desc
, 
ba£Addr
, 
numPages
);

88 
desc
->
ty≥
 = 0x02;

89 
desc
->
sy°em
 = 1;

90 
desc
->
d∂
 = 
¥ivûegeLevñ
;

91 
desc
->
¥e£¡
 = 1;

92 
desc
->
ª£rved
 = 0;

93 
desc
->
dbBô
 = 1;

94 
	}
}

99 
	$Inô_TSS_Des¸ùt‹
(
Segmít_Des¸ùt‹
 *
desc
, 
TSS
 *
theTSS
) {

100 
	`Së_Size_And_Ba£_Byãs
(
desc
, (
ul⁄g_t
Ë
theTSS
, (
TSS
));

101 
desc
->
ty≥
 = 0x09;

102 
desc
->
sy°em
 = 0;

103 
desc
->
d∂
 = 0;

104 
desc
->
¥e£¡
 = 1;

105 
desc
->
ª£rved
 = 0;

106 
desc
->
dbBô
 = 0;

107 
	}
}

112 
	$Inô_LDT_Des¸ùt‹
(
Segmít_Des¸ùt‹
 *
desc
,

113 
Segmít_Des¸ùt‹
 
theLDT
[], 
numE¡rõs
) {

114 
	`Së_Size_And_Ba£_Byãs
(
desc
, (
ul⁄g_t
Ë
theLDT
,

115 (
Segmít_Des¸ùt‹
Ë* 
numE¡rõs
);

117 
desc
->
ty≥
 = 0x02;

118 
desc
->
sy°em
 = 0;

119 
desc
->
d∂
 = 0;

120 
desc
->
¥e£¡
 = 1;

121 
desc
->
ª£rved
 = 0;

122 
desc
->
dbBô
 = 0;

123 
	}
}

	@sem.c

13 
	~<gìkos/sysˇŒ.h
>

14 
	~<gìkos/î∫o.h
>

15 
	~<gìkos/kthªad.h
>

16 
	~<gìkos/öt.h
>

17 
	~<gìkos/ñf.h
>

18 
	~<gìkos/mÆloc.h
>

19 
	~<gìkos/s¸ìn.h
>

20 
	~<gìkos/keybﬂrd.h
>

21 
	~<gìkos/°rög.h
>

22 
	~<gìkos/u£r.h
>

23 
	~<gìkos/timî.h
>

24 
	~<gìkos/vfs.h
>

25 
	~<gìkos/sig«l.h
>

26 
	~<gìkos/£m.h
>

27 
	~<gìkos/¥oje˘s.h
>

38 
	$Sys_O≥n_Sem≠h‹e
(
I¡îru±_Sèã
 *
°©e
) {

39 
	`KASSERT
(
°©e
);

40 
	`TODO_P
(
PROJECT_SEMAPHORES
, "Open_Semaphore system call");

41  
EUNSUPPORTED
;

42 
	}
}

53 
	$Sys_P
(
I¡îru±_Sèã
 *
°©e
) {

54 
	`KASSERT
(
°©e
);

55 
	`TODO_P
(
PROJECT_SEMAPHORES
, "P (semaphoreácquire) system call");

56  
EUNSUPPORTED
;

57 
	}
}

66 
	$Sys_V
(
I¡îru±_Sèã
 *
°©e
) {

67 
	`KASSERT
(
°©e
);

68 
	`TODO_P
(
PROJECT_SEMAPHORES
, "V (semaphoreÑelease) system call");

69  
EUNSUPPORTED
;

70 
	}
}

79 
	$Sys_Clo£_Sem≠h‹e
(
I¡îru±_Sèã
 *
°©e
) {

80 
	`KASSERT
(
°©e
);

81 
	`TODO_P
(
PROJECT_SEMAPHORES
, "Close_Semaphore system call");

82  
EUNSUPPORTED
;

83 
	}
}

	@signal.c

24 
	~<gìkos/kas£π.h
>

25 
	~<gìkos/defs.h
>

26 
	~<gìkos/s¸ìn.h
>

27 
	~<gìkos/öt.h
>

28 
	~<gìkos/mem.h
>

29 
	~<gìkos/symbﬁ.h
>

30 
	~<gìkos/°rög.h
>

31 
	~<gìkos/kthªad.h
>

32 
	~<gìkos/mÆloc.h
>

33 
	~<gìkos/u£r.h
>

34 
	~<gìkos/sig«l.h
>

35 
	~<gìkos/¥oje˘s.h
>

36 
	~<gìkos/Æ¨m.h
>

40 
	$Com∂ëe_H™dÀr
(
Kî√l_Thªad
 *
kthªad
,

41 
I¡îru±_Sèã
 *
°©e
) {

42 
	`KASSERT
(
kthªad
);

43 
	`KASSERT
(
°©e
);

44 
	`TODO_P
(
PROJECT_SIGNALS
,

46 
	}
}

48 
	$Check_Pídög_Sig«l
(
Kî√l_Thªad
 *
kthªad
,

49 
I¡îru±_Sèã
 *
°©e
) {

50 
	`KASSERT
(
kthªad
);

51 
	`KASSERT
(
°©e
);

54 
	`TODO_P
(
PROJECT_SIGNALS
,

56 
	}
}

59 
	$Pröt_IS
(
I¡îru±_Sèã
 *
e•
) {

60 **
p
;

61 
	`Pröt
("e•=%x:\n", ()
e•
);

62 
	`Pröt
(" gs=%x\n", ()
e•
->
gs
);

63 
	`Pröt
(" fs=%x\n", ()
e•
->
fs
);

64 
	`Pröt
("És=%x\n", ()
e•
->
es
);

65 
	`Pröt
(" ds=%x\n", ()
e•
->
ds
);

66 
	`Pröt
("Ébp=%x\n", ()
e•
->
ebp
);

67 
	`Pröt
("Édi=%x\n", ()
e•
->
edi
);

68 
	`Pröt
("Ési=%x\n", ()
e•
->
esi
);

69 
	`Pröt
("Édx=%x\n", ()
e•
->
edx
);

70 
	`Pröt
("Écx=%x\n", ()
e•
->
ecx
);

71 
	`Pröt
("Ébx=%x\n", ()
e•
->
ebx
);

72 
	`Pröt
("Éax=%x\n", ()
e•
->
óx
);

73 
	`Pröt
(" i¡Num=%x\n", ()
e•
->
ötNum
);

74 
	`Pröt
("Éº‹Code=%x\n", ()
e•
->
îr‹Code
);

75 
	`Pröt
("Éù=%x\n", ()
e•
->
eù
);

76 
	`Pröt
(" cs=%x\n", ()
e•
->
cs
);

77 
	`Pröt
("ÉÊags=%x\n", ()
e•
->
eÊags
);

78 
p
 = (**)(((
I¡îru±_Sèã
 *)
e•
) + 1);

79 
	`Pröt
("e•+n=%x\n", ()
p
);

80 
	`Pröt
("e•+n[0]=%x\n", ()
p
[0]);

81 
	`Pröt
("e•+n[1]=%x\n", ()
p
[1]);

82 
	}
}

84 
	$dump_°ack
(*
e•
, 
ofs
) {

85 
i
;

86 
	`Pröt
("Setup_Frame: Stack dump\n");

87 
i
 = 0; i < 25; i++) {

88 
	`Pröt
("[%x]: %x\n", ()&
e•
[
i
] - 
ofs
,Ésp[i]);

90 
	}
}

93 
	$Sëup_Føme
(
Kî√l_Thªad
 *
kthªad
, 
I¡îru±_Sèã
 *
°©e
) {

94 
i
;

95 
	`KASSERT
(
kthªad
);

96 
	`KASSERT
(
°©e
);

98 
	`TODO_P
(
PROJECT_SIGNALS
, "Setup_Frame");

99 
	}
}

	@smp.c

13 
	~<gìkos/°rög.h
>

14 
	~<gìkos/s¸ìn.h
>

15 
	~<gìkos/kas£π.h
>

16 
	~<gìkos/≠ic.h
>

17 
	~<gìkos/smp.h
>

18 
	~<gìkos/li°.h
>

19 
	~<gìkos/öt.h
>

20 
	~<gìkos/idt.h
>

21 
	~<gìkos/mÆloc.h
>

22 
	~<gìkos/kthªad.h
>

23 
	~<gìkos/io.h
>

24 
	~<gìkos/timî.h
>

25 
	~<gìkos/tss.h
>

26 
	~<gìkos/å≠.h
>

27 
	~<gìkos/mem.h
>

28 
	~<gìkos/gdt.h
>

39 
	e˝uid_ªque°s
 {

40 
	mCPUID_GETVENDORSTRING
,

41 
	mCPUID_GETFEATURES
,

42 
	mCPUID_GETTLB
,

43 
	mCPUID_GETSERIAL
,

45 
	mCPUID_INTELEXTENDED
 = 0x80000000,

46 
	mCPUID_INTELFEATURES
,

47 
	mCPUID_INTELBRANDSTRING
,

48 
	mCPUID_INTELBRANDSTRINGMORE
,

49 
	mCPUID_INTELBRANDSTRINGEND
,

57 
ölöe
 
	$˝uid
(
code
, *
a
, *
d
) {

58 
asm
 vﬁ©ûê("˝uid":"˜" (*
a
), "=d"(*
d
):"a"(
code
):"ecx", "ebx");

59 
	}
}

62 *
	gAPIC_Addr
 = (*)0xFEE00000;

65 vﬁ©ûê*
	gIO_APIC_Addr
 =

73 
	sMP_C⁄fig_TabÀ
 {

74 
	msig«tuª
[4];

75 
	mÀngth
;

76 
	mªv
;

77 
	mchecksum
;

78 
	mOEM_Low
;

79 
	mOEM_High
;

80 
	m¥odu˘_ID
[12];

81 *
	mOEM_TabÀ_På
;

82 
	mOEM_TabÀ_Size
;

83 
	míåy_Cou¡
;

84 *
	mloˇl_APIC_Addr
;

85 
	mexãnded_TabÀ_Lígth
;

86 
	mexãnded_TabÀ_Checksum
;

87 } 
	tMP_C⁄fig_TabÀ
;

89 
	sMP_Flﬂtög_TabÀ
 {

90 
	msig«tuª
[4];

91 
MP_C⁄fig_TabÀ
 *
	mMP_C⁄fig_PTR
;

92 
	mÀngth
;

93 
	mvîsi⁄
;

94 
	mchecksum
;

95 
	mMP_Fótuªs1
;

96 
	mMP_Fótuªs2
;

97 
	mMP_Re£rved1
;

98 
	mMP_Re£rved2
;

99 
	mMP_Re£rved3
;

100 } 
	tMP_Flﬂtög_TabÀ
;

102 
	emp_èbÀ_ty≥s
 {

103 
	mMP_CONFIG_ENTRY_PROCESSOR
 = 0,

104 
	mMP_CONFIG_ENTRY_BUS
,

105 
	mMP_CONFIG_ENTRY_IO_APIC
,

106 
	mMP_CONFIG_ENTRY_IO_INTERRUPT_ASSIGNMENT
,

107 
	mMP_CONFIG_ENTRY_LOCAL_INTERRUPT_ASSIGNMENT


110 
	sMP_Pro˚ss‹
 {

111 
	mty≥
;

112 
	mAPIC_Id
;

113 
	mAPIC_Vîsi⁄
;

114 
	mCPU_E«bÀd
:1;

115 
	mIs_BoŸ°øp_CPU
:1;

116 
	mCPU_Sig«tuª
;

117 
	mCPU_Fœgs
;

118 
	mª£rved1
;

119 
	mª£rved2
;

120 } 
	tMP_Pro˚ss‹
;

122 
	sMP_IO_APIC
 {

123 
	mty≥
;

124 
	mAPIC_Id
;

125 
	mAPIC_Vîsi⁄
;

126 
	míabÀd
:1;

127 *
	maddªss
;

128 } 
	tMP_IO_APIC
;

130 
	sMP_IO_I¡îru±
 {

131 
	míåy_Ty≥
;

132 
	möãºu±_Ty≥
;

133 
	mÊag_PO
:1;

134 
	mÊag_EL
:1;

135 
	mª£rved
:14;

136 
	mbus_ID
;

137 
	m§c_Bus_IRQ
;

138 
	mde°IO_APIC
;

139 
	mde°IO_APIC_IRQ
;

140 } 
	tMP_IO_I¡îru±
;

142 
	gCPU_Cou¡
;

143 
MP_Pro˚ss‹
 *
	gPro˚ss‹
;

146 
	$MP_Checksum
(*
°¨t
, 
Àngth
) {

147 
i
;

148 
tŸÆ
;

150 
tŸÆ
 = 0;

151 
i
 = 0; i < 
Àngth
; i++)

152 
tŸÆ
 +
°¨t
[
i
];

154  
tŸÆ
 & 0xff;

155 
	}
}

157 
MP_Flﬂtög_TabÀ
 *
	$Sˇn_F‹_Flﬂtög_TabÀ
(*
°¨t
, *
íd
) {

158 *
cuº
;

159 
MP_Flﬂtög_TabÀ
 *
åy
;

160 
cuº
 = 
°¨t
; cuº < 
íd
; curr++) {

161 
åy
 = (
MP_Flﬂtög_TabÀ
 *Ë
cuº
;

162 i‡(!
	`°∫cmp
(
åy
->
sig«tuª
, "_MP_", 4) &&

163 !
	`MP_Checksum
((*)
cuº
, (
MP_Flﬂtög_TabÀ
))) {

164  
åy
;

168 
	}
}

170 
	$Gë_MP_TabÀs
() {

172 
MP_C⁄fig_TabÀ
 *
˘
;

173 
MP_Flﬂtög_TabÀ
 *
·
;

176 
·
 = 
	`Sˇn_F‹_Flﬂtög_TabÀ
((*)0xEBDA, (*)0xEBDA + 1024);

177 i‡(!
·
) {

179 
·
 = 
	`Sˇn_F‹_Flﬂtög_TabÀ
((*)(639 * 1024),

182 i‡(!
·
) {

184 
·
 = 
	`Sˇn_F‹_Flﬂtög_TabÀ
((*)0xF0000, (*)0x100000);

187 i‡(!
·
 || !·->
MP_C⁄fig_PTR
) {

192 
˘
 = 
·
->
MP_C⁄fig_PTR
;

193 i‡(
	`°∫cmp
(
˘
->
sig«tuª
, "PCMP", 4) ||

194 
	`MP_Checksum
((*)
˘
 + ct->
Àngth
,

195 
˘
->
exãnded_TabÀ_Lígth
)) {

197 
	`Pröt
("MP Configuration TableÇot valid\n");

201 *
cuº
 = ((*)
˘
Ë+ (
MP_C⁄fig_TabÀ
);

202 
MP_Pro˚ss‹
 *
¥oc
;

203 
MP_IO_APIC
 *
ioAPIC
;

204 
MP_IO_I¡îru±
 *
ötAss
;

205 
i
;

206 
i
 = 0; i < 
˘
->
íåy_Cou¡
; i++) {

207 *
cuº
) {

208 
MP_CONFIG_ENTRY_PROCESSOR
:

209 
¥oc
 = (
MP_Pro˚ss‹
 *Ë
cuº
;

210 
	`Pröt
("found CPU#%d wôh APIC id #%d\n", 
CPU_Cou¡
,

211 
¥oc
->
APIC_Id
);

213 i‡(!
CPU_Cou¡
)

214 
Pro˚ss‹
 = 
¥oc
;

215 
CPU_Cou¡
++;

216 
cuº
 +(
MP_Pro˚ss‹
);

219 
MP_CONFIG_ENTRY_IO_APIC
:

220 
ioAPIC
 = (
MP_IO_APIC
 *Ë
cuº
;

221 
	`Pröt
("found IO APIC ID=%dáà%x\n", 
ioAPIC
->
APIC_Id
,

222 ()
ioAPIC
->
addªss
);

223 
IO_APIC_Addr
 = 
ioAPIC
->
addªss
;

224 
cuº
 +(
MP_IO_APIC
);

227 
MP_CONFIG_ENTRY_LOCAL_INTERRUPT_ASSIGNMENT
:

228 
MP_CONFIG_ENTRY_IO_INTERRUPT_ASSIGNMENT
:

229 
ötAss
 = (
MP_IO_I¡îru±
 *Ë
cuº
;

230 
cuº
 += 8;

233 
MP_CONFIG_ENTRY_BUS
:

235 
cuº
 += 8;

239 
	`Pröt
("Uknow¿íåyÅy≥ %d\n", *
cuº
);

243 
	}
}

245 
ölöe
 
	$APIC_Ród
(
ªg
) {

246 
ªt
;

248 
	`__asm
("pushfl");

249 
	`__asm
("cli");

250 
ªt
 = *((vﬁ©ûê*)(
APIC_Addr
 + 
ªg
));

251 
	`__asm
("popfl");

253  
ªt
;

254 
	}
}

256 
ölöe
 
	$APIC_Wrôe
(
ªg
, 
vÆue
) {

257 
	`__asm
("pushfl");

258 
	`__asm
("cli");

259 *((vﬁ©ûê*)(
APIC_Addr
 + 
ªg
)Ë
vÆue
;

260 
	`__asm
("popfl");

262 
	}
}

264 
ölöe
 
	$IOAPIC_Wrôe
(c⁄° 
off£t
, c⁄° 
vÆ
) {

265 
	`__asm
("pushfl");

266 
	`__asm
("cli");

268 *
IO_APIC_Addr
 = 
off£t
;

270 *(*)(
IO_APIC_Addr
 + 0x10 / 4Ë
vÆ
;

271 
	`__asm
("popfl");

272 
	}
}

274 
ölöe
 
	$IOAPIC_Ród
(c⁄° 
off£t
) {

275 
ªt
;

277 
	`__asm
("pushfl");

278 
	`__asm
("cli");

279 *(*)
IO_APIC_Addr
 = 
off£t
;

280 
ªt
 = *(*)(
IO_APIC_Addr
 + 0x10 / 4);

281 
	`__asm
("popfl");

283  (
ªt
);

284 
	}
}

290 
	$£nd_IPI
(
APIC_Id
, 
mask
) {

291 
åy
;

292 
°©us
 = 1;

294 
	`APIC_Wrôe
(
APIC_ICR
 + 0x10, (
APIC_Id
 << 24));

295 
	`APIC_Wrôe
(
APIC_ICR
, 
mask
);

297 
åy
 = 0;Åry < 100;Åry++) {

298 
	`Mi¸o_Dñay
(100);

299 
°©us
 = 
	`APIC_Ród
(
APIC_ICR
Ë& 
APIC_ICR_STATUS_PEND
;

300 i‡(!
°©us
)

304 
	`Pröt
("Send IPIÅimeout\n");

306 
	}
}

308 
	$£nd_INIT
(
APIC_Id
) {

310 
	`£nd_IPI
(
APIC_Id
,

311 
APIC_ICR_TM_LEVEL
 | 
APIC_ICR_LEVELASSERT
 | 
APIC_ICR_DM_INIT
);

313 
	`Mi¸o_Dñay
(10000);

316 
	`£nd_IPI
(
APIC_Id
, 
APIC_ICR_TM_LEVEL
 | 
APIC_ICR_DM_INIT
);

318 
	`Mi¸o_Dñay
(10000);

319 
	}
}

321 
	$Spurious_I¡îru±_H™dÀr
(
I¡îru±_Sèã
 *
°©e
) {

322 
CPUid
 = 
	`Gë_CPU_ID
();

323 
CPUs
[
CPUid
].
•uriousCou¡
++;

324 
	}
}

330 
	$Inô_Loˇl_APIC
(
˝u
) {

331 
≠icid
;

332 
˝ubus‰eq
;

333 
tmp
;

334 
qu™tum
 = 10;

335 
≠icInôülCou¡
 = 0;

337 
	`Timî_I¡îru±_H™dÀr
();

338 
	`In°Æl_I¡îru±_H™dÀr
(39, 
Spurious_I¡îru±_H™dÀr
);

340 
	`In°Æl_I¡îru±_H™dÀr
(32, 
Timî_I¡îru±_H™dÀr
);

343 
	`APIC_Wrôe
(
APIC_DFR
, 0xFFFFFFFF);

344 
	`APIC_Wrôe
(
APIC_LDR
, (
	`APIC_Ród
(APIC_LDR) & 0x00FFFFFF) | 1);

345 
	`APIC_Wrôe
(
APIC_LVTT
, 
APIC_DISABLE
);

346 
	`APIC_Wrôe
(
APIC_LVTPC
, 
APIC_ICR_DM_NMI
);

347 
	`APIC_Wrôe
(
APIC_LVT0
, 
APIC_DISABLE
);

348 
	`APIC_Wrôe
(
APIC_LVT1
, 
APIC_DISABLE
);

349 
	`APIC_Wrôe
(
APIC_TPR
, 0);

352 
	`asm
("movl $0x1b, %ecx");

353 
	`asm
("rdmsr");

354 
	`asm
("orl $0x800, %eax");

355 
	`asm
("wrmsr");

358 
≠icid
 = 
	`APIC_Ród
(
APIC_SPIV
);

359 
	`APIC_Wrôe
(
APIC_SPIV
, 
≠icid
 | 
APIC_SPIV_ENABLE_APIC
);

360 
≠icid
 = 
	`GET_APIC_ID
(
	`APIC_Ród
(
APIC_ID
));

363 
	`APIC_Wrôe
(
APIC_SPIV
, 39 | 
APIC_SW_ENABLE
);

365 i‡(!
˝u
) {

367 
	`APIC_Wrôe
(
APIC_LVTT
, 32);

369 
	`APIC_Wrôe
(
APIC_TDCR
, 0x03);

371 
	`Out_Byã
(0x61, (
	`In_Byã
(0x61) & 0xFD) | 1);

372 
	`Out_Byã
(0x43, 0xB2);

374 
	`Out_Byã
(0x42, 0x9B);

375 
	`In_Byã
(0x60);

376 
	`Out_Byã
(0x42, 0x2E);

379 
tmp
 = 
	`In_Byã
(0x61) & 0xFE;

380 
	`Out_Byã
(0x61, ()
tmp
);

381 
	`Out_Byã
(0x61, ()
tmp
 | 1);

384 
	`APIC_Wrôe
(
APIC_TICR
, 0xFFFFFFFF - 1);

387 !(
	`In_Byã
(0x61) & 0x20));

390 
	`APIC_Wrôe
(
APIC_LVTT
, 
APIC_DISABLE
);

393 
	`Pröt
("≠i¯cou¡ed dow¿tÿ%x\n", 
	`APIC_Ród
(
APIC_TCCR
));

394 
˝ubus‰eq
 = (0xFFFFFFFF - (
	`APIC_Ród
(
APIC_TCCR
) + 1)) * 16 * 100;

395 
	`Pröt
("˝u fªq = %d\n", 
˝ubus‰eq
);

396 
≠icInôülCou¡
 = 
˝ubus‰eq
 / 
qu™tum
 / 16;

401 
	`APIC_Wrôe
(
APIC_TICR
, 
≠icInôülCou¡
 < 16 ? 16 :ápicInitialCount);

404 
	`APIC_Wrôe
(
APIC_LVTT
, 32 | 
TMR_PERIODIC
);

408 
	`APIC_Wrôe
(
APIC_TDCR
, 0x03);

410  
≠icid
;

411 
	}
}

414 
	$Gë_CPU_ID
() {

415 
≠icid
;

417 
≠icid
 = 
	`GET_APIC_ID
(
	`APIC_Ród
(
APIC_ID
));

419  
≠icid
;

420 
	}
}

422 
CPU_Info
 
	gCPUs
[
MAX_CPUS
];

430 
	#START_SECONDARY_FUNC
 ((0x9020<<4Ë+ 4096)

	)

432 *
	gSec⁄d¨y_Sèck
;

434 
	$Inô_SMP
() {

435 
i
;

436 
úq
;

437 
cou¡
;

438 
≠icid
;

440 
	`Pröt
("Initializing SMP...\n");

442 
	`Gë_MP_TabÀs
();

443 
≠icid
 = 
	`Gë_CPU_ID
();

445 
	`KASSERT0
(
≠icid
 == 0,

448 
i
 = 0; i < 
CPU_Cou¡
; i++) {

449 i‡(!
Pro˚ss‹
[
i
].
Is_BoŸ°øp_CPU
) {

452 *
±r
;

453 
±r
 = 
	`AŒoc_Page
();

454 
CPUs
[
i
].
°ack
 = 
±r
;

455 
	`£nd_INIT
(
Pro˚ss‹
[
i
].
APIC_Id
);

458 
CPUs
[
i
].
öôD⁄e
 = 1;

461 
	`Mi¸o_Dñay
(10000);

463 
i
 = 0; i < 
CPU_Cou¡
; i++) {

464 i‡(!
Pro˚ss‹
[
i
].
Is_BoŸ°øp_CPU
) {

465 
Sec⁄d¨y_Sèck
 = 
CPUs
[
i
].
°ack
;

466 
	`£nd_IPI
(
i
,

467 
APIC_ICR_DM_SIPI
 |

468 (((()
START_SECONDARY_FUNC
) >> 12) & 0xFF));

469 
	`Mi¸o_Dñay
(10000);

470 !
CPUs
[
i
].
öôD⁄e
)

471 
	`Mi¸o_Dñay
(10000);

474 
	}
}

480 
	$Sec⁄d¨y_Sèπ
(
°ack
) {

481 
i
;

482 
CPUid
;

483 
APICid
;

485 
CPUid
 = 
	`Gë_CPU_ID
();

488 
CPUs
[
CPUid
].
öôD⁄e
 = 1;

491 !
CPUs
[
CPUid
].
ru¬ög
) {

492 
	`Mi¸o_Dñay
(1000);

495 
	`Inô_GDT
(
CPUid
);

497 
	`Inô_TSS
();

499 
	`lockKî√l
();

500 
	`Inô_I¡îru±s
(
CPUid
);

502 
	`Inô_Sec⁄d¨y_VM
();

503 
	`Inô_Sec⁄d¨y_VM
();

505 
	`Inô_ScheduÀr
(
CPUid
, 
CPUs
[CPUid].
°ack
);

507 
	`Inô_Tøps
();

509 
APICid
 = 
	`Inô_Loˇl_APIC
(
CPUid
);

511 
	`Inô_Timî_I¡îru±
();

513 
	`Pröt
("Init done\n");

516 
CPUs
[
CPUid
].
ru¬ög
 = 2;

518 
	`KASSERT0
(
APICid
 =
	`Gë_CPU_ID
(), "Apic id doesn't match cpuid");

520 
	`Síd_Timî_INT
();

523 
	`Exô
(0);

524 
	}
}

526 
	$Rñó£_SMP
() {

527 
i
;

528 
úq
;

530 
i
 = 0; i < 
CPU_Cou¡
; i++) {

531 
CPUs
[
i
].
ru¬ög
 = 1;

532 i‡(
i
)

533 
CPUs
[
i
].
ru¬ög
 != 2);

535 
	}
}

538 
Spö_Lock_t
 
	gli°Lock
;

540 
Spö_Lock_t
 
	gkthªadLock
;

542 
	$Is_Locked
(
Spö_Lock_t
 * 
lock
) {

543  
lock
->lock;

544 
	}
}

546 
	$Spö_Lock_Inô
(
Spö_Lock_t
 * 
lock
) {

547 
	`KASSERT
(
lock
);

549 
lock
->lock = 0;

550 
lock
->
œ°Lockî
 = 
NULL
;

551 
lock
->
lockî
 = 
NULL
;

552 
	}
}

554 
	$Spö_Lock
(
Spö_Lock_t
 * 
lock
) {

555 
	`Spö_Lock_INTERNAL
(
Spö_Lock_t
 * 
lock
);

556 
	`KASSERT
(
lock
);

557 
	`Spö_Lock_INTERNAL
(
lock
);

558 
lock
->
lockî
 = 
CURRENT_THREAD
;

559 
	}
}

561 
	$Spö_U∆ock
(
Spö_Lock_t
 * 
lock
) {

562 
	`Spö_U∆ock_INTERNAL
(
Spö_Lock_t
 * 
lock
);

563 
	`KASSERT
(
lock
);

564 
	`KASSERT
(
lock
->lock);

566 
lock
->
œ°Lockî
 =Üock->
lockî
;

567 
lock
->
lockî
 = 
NULL
;

568 
	`Spö_U∆ock_INTERNAL
(
lock
);

569 
	}
}

573 
	$M≠_IO_APIC_IRQ
(
úq
, *
h™dÀr
) {

575 
	`IOAPIC_Wrôe
(0x10 + 2 * 
úq
, 0x00000000 | irq);

576 
	`IOAPIC_Wrôe
(0x10 + 2 * 
úq
 + 1, 0x00000000);

578 
	`In°Æl_I¡îru±_H™dÀr
(
úq
, 
h™dÀr
);

579 
	}
}

585 
Spö_Lock_t
 
	gglobÆLock
;

587 
	$lockKî√l
() {

588 
	`Spö_Lock
(&
globÆLock
);

589 
	}
}

591 
	$u∆ockKî√l
() {

592 
	`Spö_U∆ock
(&
globÆLock
);

593 
	}
}

	@synch.c

18 
	~<gìkos/kthªad.h
>

19 
	~<gìkos/öt.h
>

20 
	~<gìkos/kas£π.h
>

21 
	~<gìkos/s¸ìn.h
>

22 
	~<gìkos/synch.h
>

43 
	$Muãx_Waô
(
Muãx
 *
muãx
) {

44 
	`KASSERT
(
muãx
->
°©e
 =
MUTEX_LOCKED
);

45 
	`KASSERT
(
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()]);

47 
	`DißbÀ_I¡îru±s
();

48 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
Ál£
;

49 
	`Waô
(&
muãx
->
waôQueue
);

50 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
åue
;

51 
	`E«bÀ_I¡îru±s
();

52 
	}
}

58 
__ölöe__
 
	$Muãx_Lock_Imp
(
Muãx
 *
muãx
) {

59 
	`KASSERT
(
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()]);

62 
	`KASSERT
(!
	`IS_HELD
(
muãx
));

65 
muãx
->
°©e
 =
MUTEX_LOCKED
) {

66 
	`Muãx_Waô
(
muãx
);

70 
muãx
->
°©e
 = 
MUTEX_LOCKED
;

71 
muãx
->
ow√r
 = 
CURRENT_THREAD
;

72 
	}
}

78 
__ölöe__
 
	$Muãx_U∆ock_Imp
(
Muãx
 *
muãx
) {

79 
	`KASSERT
(
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()]);

82 
	`KASSERT
(
	`IS_HELD
(
muãx
));

85 
muãx
->
°©e
 = 
MUTEX_UNLOCKED
;

86 
muãx
->
ow√r
 = 0;

95 i‡(!
	`Is_Thªad_Queue_Em±y
(&
muãx
->
waôQueue
)) {

96 
	`DißbÀ_I¡îru±s
();

97 
	`Wake_Up_O√
(&
muãx
->
waôQueue
);

98 
	`E«bÀ_I¡îru±s
();

100 
	}
}

109 
	$Muãx_Inô
(
Muãx
 *
muãx
) {

110 
muãx
->
°©e
 = 
MUTEX_UNLOCKED
;

111 
muãx
->
ow√r
 = 0;

112 
	`CÀ¨_Thªad_Queue
(&
muãx
->
waôQueue
);

113 
	}
}

118 
	$Muãx_Lock
(
Muãx
 *
muãx
) {

119 
	`KASSERT
(
	`I¡îru±s_E«bÀd
());

121 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
åue
;

122 
	`Muãx_Lock_Imp
(
muãx
);

123 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
Ál£
;

124 
	}
}

129 
	$Muãx_U∆ock
(
Muãx
 *
muãx
) {

130 
	`KASSERT
(
	`I¡îru±s_E«bÀd
());

132 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
åue
;

133 
	`Muãx_U∆ock_Imp
(
muãx
);

134 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
Ál£
;

135 
	}
}

140 
	$C⁄d_Inô
(
C⁄dôi⁄
 *
c⁄d
) {

141 
	`CÀ¨_Thªad_Queue
(&
c⁄d
->
waôQueue
);

142 
	}
}

147 
	$C⁄d_Waô
(
C⁄dôi⁄
 *
c⁄d
, 
Muãx
 *
muãx
) {

148 
	`KASSERT
(
	`I¡îru±s_E«bÀd
());

151 
	`KASSERT
(
	`IS_HELD
(
muãx
));

154 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
åue
;

162 
	`Muãx_U∆ock_Imp
(
muãx
);

171 
	`DißbÀ_I¡îru±s
();

172 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
Ál£
;

173 
	`Waô
(&
c⁄d
->
waôQueue
);

174 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
åue
;

175 
	`E«bÀ_I¡îru±s
();

178 
	`Muãx_Lock_Imp
(
muãx
);

181 
g_¥ìm±i⁄DißbÀd
[
	`Gë_CPU_ID
()] = 
Ál£
;

182 
	}
}

188 
	$C⁄d_Sig«l
(
C⁄dôi⁄
 *
c⁄d
) {

189 
	`KASSERT
(
	`I¡îru±s_E«bÀd
());

190 
	`DißbÀ_I¡îru±s
();

191 
	`Wake_Up_O√
(&
c⁄d
->
waôQueue
);

192 
	`E«bÀ_I¡îru±s
();

193 
	}
}

199 
	$C⁄d_Brﬂdˇ°
(
C⁄dôi⁄
 *
c⁄d
) {

200 
	`KASSERT
(
	`I¡îru±s_E«bÀd
());

201 
	`DißbÀ_I¡îru±s
();

202 
	`Wake_Up
(&
c⁄d
->
waôQueue
);

203 
	`E«bÀ_I¡îru±s
();

204 
	}
}

	@syscall.c

16 
	~<gìkos/sysˇŒ.h
>

17 
	~<gìkos/î∫o.h
>

18 
	~<gìkos/kthªad.h
>

19 
	~<gìkos/öt.h
>

20 
	~<gìkos/ñf.h
>

21 
	~<gìkos/mÆloc.h
>

22 
	~<gìkos/s¸ìn.h
>

23 
	~<gìkos/keybﬂrd.h
>

24 
	~<gìkos/°rög.h
>

25 
	~<gìkos/u£r.h
>

26 
	~<gìkos/timî.h
>

27 
	~<gìkos/vfs.h
>

28 
	~<gìkos/sig«l.h
>

29 
	~<gìkos/£m.h
>

30 
	~<gìkos/¥oje˘s.h
>

31 
	~<gìkos/kas£π.h
>

32 
	~<gìkos/io.h
>

33 
	~<gìkos/úq.h
>

35 
	~<gìkos/sys_√t.h
>

36 
	~<gìkos/pùe.h
>

37 
	~<gìkos/mem.h
>

39 
Spö_Lock_t
 
kthªadLock
;

43 
ölöe
 
	$CÆc_Ticks_Pî_MS
(
mûli£c⁄ds
) {

44 
ticks
 = 
TICKS_PER_MS
 * 
mûli£c⁄ds
;

45 
åunc
 = ()
ticks
;

46  (((
ticks
 - 
åunc
) > 0) ?Årunc + 1 :Årunc);

47 
	}
}

56 
	$C›y_U£r_Såög
(
ul⁄g_t
 
uaddr
, ul⁄g_à
Àn
, ul⁄g_à
maxLí
,

57 **
pSå
) {

58 
rc
 = 0;

59 *
°r
;

62 i‡(
Àn
 > 
maxLí
)

63  
EINVALID
;

66 
°r
 = (*)
	`MÆloc
(
Àn
 + 1);

67 i‡(
°r
 == 0) {

68 
rc
 = 
ENOMEM
;

69 
d⁄e
;

73 i‡(!
	`C›y_From_U£r
(
°r
, 
uaddr
, 
Àn
)) {

74 
rc
 = 
EINVALID
;

75 
	`Fªe
(
°r
);

76 
d⁄e
;

78 
°r
[
Àn
] = '\0';

81 *
pSå
 = 
°r
;

83 
d⁄e
:

84  
rc
;

85 
	}
}

97 
Sys_NuŒ
(
I¡îru±_Sèã
 *
°©e
 
__©åibuã__
 ((
unu£d
))) {

109 
	$Sys_Exô
(
I¡îru±_Sèã
 *
°©e
) {

110 
	`Exô
(
°©e
->
ebx
);

112 
	}
}

119 
H¨dw¨e_Shutdown
();

120 
	$Sys_ShutDown
(
I¡îru±_Sèã
 *
°©e
) {

121 
	`Pröt
("------------------- THE END ------------------\n");

122 
	`H¨dw¨e_Shutdown
();

125 
	}
}

127 
Spö_Lock_t
 
	g•rötLock
;

137 
	$Sys_PrötSåög
(
I¡îru±_Sèã
 *
°©e
) {

138 
rc
 = 0;

139 
uöt_t
 
Àngth
 = 
°©e
->
ecx
;

140 *
buf
 = 0;

142 
	`Spö_Lock
(&
•rötLock
);

143 i‡(
Àngth
 > 0) {

145 i‡((
rc
 =

146 
	`C›y_U£r_Såög
(
°©e
->
ebx
, 
Àngth
, 1023, (**)&
buf
)) != 0)

147 
d⁄e
;

154 i‡(!
buf
[0]) {

155 
	`Dump_I¡îru±_Sèã
(
°©e
);

156 
	`KASSERT0
(
buf
[0],

161 
	`Put_Buf
(
buf
, 
Àngth
);

164 
d⁄e
:

165 i‡(
buf
 != 0)

166 
	`Fªe
(
buf
);

167 
	`Spö_U∆ock
(&
•rötLock
);

168  
rc
;

169 
	}
}

179 
	$Sys_GëKey
(
I¡îru±_Sèã
 *
°©e
) {

181  
	`Waô_F‹_Key
();

182 
	}
}

190 
	$Sys_SëAâr
(
I¡îru±_Sèã
 *
°©e
) {

191 
	`Së_Cuºít_Aâr
((
uch¨_t
Ë
°©e
->
ebx
);

193 
	}
}

202 
	$Sys_GëCurs‹
(
I¡îru±_Sèã
 *
°©e
) {

203 
row
, 
cﬁ
;

204 
	`Gë_Curs‹
(&
row
, &
cﬁ
);

205 i‡(!
	`C›y_To_U£r
(
°©e
->
ebx
, &
row
, ()) ||

206 !
	`C›y_To_U£r
(
°©e
->
ecx
, &
cﬁ
, ()))

209 
	}
}

218 
	$Sys_PutCurs‹
(
I¡îru±_Sèã
 *
°©e
) {

219  
	`Put_Curs‹
(
°©e
->
ebx
, sèã->
ecx
) ? 0 : -1;

220 
	}
}

232 
	$Sys_S∑wn
(
I¡îru±_Sèã
 *
°©e
) {

233 
rc
;

234 *
¥ogøm
 = 0;

235 *
comm™d
 = 0;

236 
Kî√l_Thªad
 *
¥o˚ss
;

239 i‡((
rc
 =

240 
	`C›y_U£r_Såög
(
°©e
->
ebx
, sèã->
ecx
, 
VFS_MAX_PATH_LEN
,

241 &
¥ogøm
)) != 0 ||

242 (
rc
 = 
	`C›y_U£r_Såög
(
°©e
->
edx
, sèã->
esi
, 1023, &
comm™d
)) != 0)

243 
d⁄e
;

245 
	`E«bÀ_I¡îru±s
();

252 
rc
 = 
	`S∑wn
(
¥ogøm
, 
comm™d
, &
¥o˚ss
, 
°©e
->
edi
);

254 i‡(
rc
 == 0) {

255 
	`KASSERT
(
¥o˚ss
 != 0);

256 
rc
 = 
¥o˚ss
->
pid
;

259 
	`DißbÀ_I¡îru±s
();

261 
d⁄e
:

262 i‡(
¥ogøm
 != 0)

263 
	`Fªe
(
¥ogøm
);

264 i‡(
comm™d
 != 0)

265 
	`Fªe
(
comm™d
);

267  
rc
;

268 
	}
}

277 
	$Sys_Waô
(
I¡îru±_Sèã
 *
°©e
) {

278 
exôCode
;

279 
Kî√l_Thªad
 *
kthªad
 = 
	`Lookup_Thªad
(
°©e
->
ebx
, 0);

280 i‡(
kthªad
 == 0) {

282  
EINVALID
;

285 i‡(
kthªad
->
dëached
) {

287  
EINVALID
;

289 
	`E«bÀ_I¡îru±s
();

290 
exôCode
 = 
	`Joö
(
kthªad
);

291 
	`DißbÀ_I¡îru±s
();

293  
exôCode
;

294 
	}
}

302 
	$Sys_GëPID
(
I¡îru±_Sèã
 *
°©e
) {

303  
CURRENT_THREAD
->
pid
;

304 
	}
}

307 
AŒ_Thªad_Li°
 
s_ÆlThªadLi°
;

308 
Thªad_Queue
 
s_runQueue
;

321 
	$Sys_PS
(
I¡îru±_Sèã
 *
°©e
) {

322 
	`TODO_P
(
PROJECT_BACKGROUND_JOBS
, "Sys_PS system call");

324 
	}
}

334 
	$Sys_Kûl
(
I¡îru±_Sèã
 *
°©e
) {

335 
	`TODO_P
(
PROJECT_SIGNALS
, "Sys_Kill system call");

337 
	}
}

346 
	$Sys_Sig«l
(
I¡îru±_Sèã
 *
°©e
) {

347 
	`TODO_P
(
PROJECT_SIGNALS
, "Sys_Signal system call");

349 
	}
}

362 
	$Sys_RegDñivî
(
I¡îru±_Sèã
 *
°©e
) {

364 
	`TODO_P
(
PROJECT_SIGNALS
, "Sys_RegDeliver system call");

365 
	}
}

374 
	$Sys_Rëu∫Sig«l
(
I¡îru±_Sèã
 *
°©e
) {

375 
	`TODO_P
(
PROJECT_SIGNALS
, "Sys_ReturnSignal system call");

376  
EUNSUPPORTED
;

377 
	}
}

385 
	$Sys_WaôNoPID
(
I¡îru±_Sèã
 *
°©e
) {

386 
	`TODO_P
(
PROJECT_SIGNALS
, "Sys_WaitNoPID system call");

387  
EUNSUPPORTED
;

388 
	}
}

397 
	$Sys_SëSchedulögPﬁicy
(
I¡îru±_Sèã
 *
°©e
) {

398 
	`TODO_P
(
PROJECT_SCHEDULING
, "SetSchedulingPolicy system call");

400 
	}
}

409 
Sys_GëTimeOfDay
(
I¡îru±_Sèã
 *
°©e


410 
__©åibuã__
 ((
unu£d
))) {

411  
	gg_numTicks
;

424 
	$Sys_Mou¡
(
I¡îru±_Sèã
 *
°©e
) {

425 
rc
 = 0;

426 
VFS_Mou¡_Reque°
 *
¨gs
 = 0;

429 i‡((
¨gs
 =

430 (
VFS_Mou¡_Reque°
 *)
	`MÆloc
((VFS_Mount_Request)))

432 
rc
 = 
ENOMEM
;

433 
d⁄e
;

437 i‡(!
	`C›y_From_U£r
(
¨gs
, 
°©e
->
ebx
, (
VFS_Mou¡_Reque°
))) {

438 
rc
 = 
EINVALID
;

439 
d⁄e
;

447 
	`TODO_P
(
PROJECT_FS
, "Mount system call");

449 
d⁄e
:

450 i‡(
¨gs
 != 0)

451 
	`Fªe
(
¨gs
);

452  
rc
;

453 
	}
}

455 
	$gë_∑th_‰om_ªgi°îs
(
uöt_t
 
addr
, uöt_à
Àngth
, **
pP©h
) {

456 i‡(
Àngth
 > 1024) {

457  
ENAMETOOLONG
;

459 *
pP©h
 = 
	`MÆloc
(
Àngth
 + 1);

460 i‡(!*
pP©h
) {

461  
ENOMEM
;

463 i‡(!
	`C›y_From_U£r
(*
pP©h
, 
addr
, 
Àngth
)) {

464 
	`Fªe
(*
pP©h
);

465  
EINVALID
;

467 (*
pP©h
)[
Àngth
] = '\0';

469 
	}
}

471 
	$√xt_des¸ùt‹
() {

472 
des¸ùt‹
;

473 
des¸ùt‹
 = 0;

474 
des¸ùt‹
 < 
USER_MAX_FILES
 &&

475 
CURRENT_THREAD
->
u£rC⁄ãxt
->
fûe_des¸ùt‹_èbÀ
[
des¸ùt‹
] != 0;

476 
des¸ùt‹
++);

477 i‡(
des¸ùt‹
 =
USER_MAX_FILES
) {

478  
EMFILE
;

480  
des¸ùt‹
;

481 
	}
}

483 
	$add_fûe_to_des¸ùt‹_èbÀ
(
Fûe
 *
fûe
) {

484 
des¸ùt‹
 = 
	`√xt_des¸ùt‹
();

485 i‡(
des¸ùt‹
 >= 0) {

486 
CURRENT_THREAD
->
u£rC⁄ãxt
->
fûe_des¸ùt‹_èbÀ
[
des¸ùt‹
] = 
fûe
;

488  
des¸ùt‹
;

489 
	}
}

501 
	$Sys_O≥n
(
I¡îru±_Sèã
 *
°©e
) {

502 *
∑th
;

503 
Fûe
 *
fûe
;

504 
rc
 = 0;

507 
CURRENT_THREAD
->
›í_cou¡
++;

509 
rc
 = 
	`gë_∑th_‰om_ªgi°îs
(
°©e
->
ebx
, sèã->
ecx
, &
∑th
);

510 i‡(
rc
 != 0) {

511  
rc
;

514 
rc
 = 
	`√xt_des¸ùt‹
();

515 i‡(
rc
 < 0) {

516  
rc
;

519 
	`E«bÀ_I¡îru±s
();

520 
rc
 = 
	`O≥n
(
∑th
, 
°©e
->
edx
, &
fûe
);

521 
	`DißbÀ_I¡îru±s
();

522 
	`Fªe
(
∑th
);

524 i‡(
rc
 >= 0) {

525  
	`add_fûe_to_des¸ùt‹_èbÀ
(
fûe
);

527  
rc
;

529 
	}
}

540 
	$Sys_O≥nDúe˘‹y
(
I¡îru±_Sèã
 *
°©e
) {

541 
	`TODO_P
(
PROJECT_FS
, "Open directory system call");

542  
EUNSUPPORTED
;

543 
	}
}

551 
	$Sys_Clo£
(
I¡îru±_Sèã
 *
°©e
) {

553 i‡(
°©e
->
ebx
 > 
USER_MAX_FILES
) {

554 
	`Pröt
("u«bÀÅÿ˛o£ fd index %d, ouào‡ønge.\n", 
°©e
->
ebx
);

555  
EINVALID
;

557 i‡(
CURRENT_THREAD
->
u£rC⁄ãxt
->
fûe_des¸ùt‹_èbÀ
[
°©e
->
ebx
]) {

558 
	`E«bÀ_I¡îru±s
();

559 
	`Clo£
(
CURRENT_THREAD
->
u£rC⁄ãxt
->
fûe_des¸ùt‹_èbÀ
[
°©e
->
ebx
]);

560 
	`DißbÀ_I¡îru±s
();

561 
CURRENT_THREAD
->
u£rC⁄ãxt
->
fûe_des¸ùt‹_èbÀ
[
°©e
->
ebx
] = 0;

564 
	`Pröt
("u«bÀÅÿ˛o£ fd index %d,ÇŸhögÅhîe.\n", 
°©e
->
ebx
);

565  
ENOTFOUND
;

567 
	}
}

578 
	$Sys_Dñëe
(
I¡îru±_Sèã
 *
°©e
) {

579 
	`TODO_P
(
PROJECT_FS
, "Delete system call");

580  
EUNSUPPORTED
;

581 
	}
}

593 
	$Sys_Ríame
(
I¡îru±_Sèã
 *
°©e
) {

594 
	`TODO_P
(
PROJECT_FS
, "Rename system call");

595  
EUNSUPPORTED
;

596 
	}
}

608 
	$Sys_Lök
(
I¡îru±_Sèã
 *
°©e
) {

609 
	`TODO_P
(
PROJECT_FS
, "Link system call");

610  
EUNSUPPORTED
;

611 
	}
}

623 
	$Sys_SymLök
(
I¡îru±_Sèã
 *
°©e
) {

624 
	`TODO_P
(
PROJECT_FS
, "Link system call");

625  
EUNSUPPORTED
;

626 
	}
}

638 
	$Sys_Ród
(
I¡îru±_Sèã
 *
°©e
) {

639 
byãs_ªad
 = 0;

642 i‡(
°©e
->
ebx
 > 
USER_MAX_FILES
) {

643  
EINVALID
;

645 i‡(
CURRENT_THREAD
->
u£rC⁄ãxt
->
fûe_des¸ùt‹_èbÀ
[
°©e
->
ebx
]) {

646 *
d©a_buf„r
 = 
	`MÆloc
(
°©e
->
edx
);

647 i‡(!
d©a_buf„r
) {

648  
ENOMEM
;

650 
	`E«bÀ_I¡îru±s
();

651 
byãs_ªad
 =

652 
	`Ród
(
CURRENT_THREAD
->
u£rC⁄ãxt
->

653 
fûe_des¸ùt‹_èbÀ
[
°©e
->
ebx
], 
d©a_buf„r
, sèã->
edx
);

654 
	`DißbÀ_I¡îru±s
();

655 i‡(!
	`C›y_To_U£r
(
°©e
->
ecx
, 
d©a_buf„r
, sèã->
edx
)) {

656 
	`Fªe
(
d©a_buf„r
);

657  
EINVALID
;

659 
	`Fªe
(
d©a_buf„r
);

660  
byãs_ªad
;

662  
ENOTFOUND
;

664 
	}
}

673 
	$Sys_RódE¡ry
(
I¡îru±_Sèã
 *
°©e
) {

674 
	`TODO_P
(
PROJECT_FS
, "ReadEntry system call");

675  
EUNSUPPORTED
;

676 
	}
}

688 
	$Sys_Wrôe
(
I¡îru±_Sèã
 *
°©e
) {

689 
byãs_wrôãn
 = 0;

691 i‡(
°©e
->
ebx
 > 
USER_MAX_FILES
) {

692  
EINVALID
;

694 i‡(
CURRENT_THREAD
->
u£rC⁄ãxt
->
fûe_des¸ùt‹_èbÀ
[
°©e
->
ebx
]) {

695 *
d©a_buf„r
 = 
	`MÆloc
(
°©e
->
edx
);

696 i‡(!
d©a_buf„r
) {

697  
ENOMEM
;

699 i‡(!
	`C›y_From_U£r
(
d©a_buf„r
, 
°©e
->
ecx
, sèã->
edx
)) {

700 
	`Fªe
(
d©a_buf„r
);

701  
EINVALID
;

703 
	`E«bÀ_I¡îru±s
();

704 
byãs_wrôãn
 =

705 
	`Wrôe
(
CURRENT_THREAD
->
u£rC⁄ãxt
->

706 
fûe_des¸ùt‹_èbÀ
[
°©e
->
ebx
], 
d©a_buf„r
, sèã->
edx
);

707 
	`Fªe
(
d©a_buf„r
);

708 
	`DißbÀ_I¡îru±s
();

709  
byãs_wrôãn
;

711  
ENOTFOUND
;

713 
	}
}

724 
	$Sys_Sèt
(
I¡îru±_Sèã
 *
°©e
) {

725 
	`TODO_P
(
PROJECT_FS
, "Stat system call");

726  
EUNSUPPORTED
;

727 
	}
}

737 
	$Sys_FSèt
(
I¡îru±_Sèã
 *
°©e
) {

738 
	`TODO_P
(
PROJECT_FS
, "FStat system call");

739  
EUNSUPPORTED
;

740 
	}
}

750 
	$Sys_Sìk
(
I¡îru±_Sèã
 *
°©e
) {

751 
	`TODO_P
(
PROJECT_FS
, "Seek system call");

752  
EUNSUPPORTED
;

753 
	}
}

763 
	$Sys_Cª©eDú
(
I¡îru±_Sèã
 *
°©e
) {

764 
	`TODO_P
(
PROJECT_FS
, "CreateDir system call");

765  
EUNSUPPORTED
;

766 
	}
}

773 
	$Sys_Sync
(
I¡îru±_Sèã
 *
°©e
) {

774 
	`TODO_P
(
PROJECT_FS
, "Sync system call");

775  
EUNSUPPORTED
;

776 
	}
}

788 
	$Sys_F‹m©
(
I¡îru±_Sèã
 *
°©e
) {

789 
rc
 = 0;

790 *
dev«me
 = 0, *
f°y≥
 = 0;

792 i‡((
rc
 =

793 
	`C›y_U£r_Såög
(
°©e
->
ebx
, sèã->
ecx
, 
BLOCKDEV_MAX_NAME_LEN
,

794 &
dev«me
)) != 0 ||

795 (
rc
 =

796 
	`C›y_U£r_Såög
(
°©e
->
edx
, sèã->
esi
, 
VFS_MAX_FS_NAME_LEN
,

797 &
f°y≥
)) != 0)

798 
d⁄e
;

800 
	`E«bÀ_I¡îru±s
();

801 
rc
 = 
	`F‹m©
(
dev«me
, 
f°y≥
);

802 
	`DißbÀ_I¡îru±s
();

804 
d⁄e
:

805 i‡(
dev«me
 != 0)

806 
	`Fªe
(
dev«me
);

807 i‡(
f°y≥
 != 0)

808 
	`Fªe
(
f°y≥
);

809  
rc
;

810 
	}
}

824 
	$Sys_IO_Unblock
(
∑øm
) {

828 
Thªad_Queue
 * 
ToWakeUp
 = 0;

829 
	`Enqueue_Thªad
(
ToWakeUp
, 
IOWaôQueue
->
hód
);

830 
	`Wake_Up
(
ToWakeUp
);

831 
	`Remove_Thªad
(
IOWaôQueue
, IOWaôQueue->
hód
);

833 
g_√edRescheduÀ
[
	`Gë_CPU_ID
()] = 
åue
;

834 
	}
}

836 
	$Sys_RódBlock
(
I¡îru±_Sèã
 *
°©e
) {

838 
blocknum
 = 
°©e
->
edi
;

839 
waôF‹
 = 
	`gë_time
(
blocknum
);

840 
id
 = 
	`Sèπ_Timî
(
	`CÆc_Ticks_Pî_MS
(
waôF‹
), &
Sys_IO_Unblock
);

841 
Kî√l_Thªad
 *
cuºít
 = 
CURRENT_THREAD
;

843 
	`Enqueue_Thªad
(
IOWaôQueue
, 
cuºít
);

844 
	`ScheduÀ
();

845  
EUNSUPPORTED
;

846 
	}
}

862 
	$Sys_WrôeBlock
(
I¡îru±_Sèã
 *
°©e
) {

863 
	`TODO_P
(
PROJECT_FS
, "WriteBlock system call");

864  
EUNSUPPORTED
;

865 
	}
}

868 
	$Sys_GëUid
(
I¡îru±_Sèã
 *
°©e
) {

869 
	`TODO_P
(
PROJECT_USER
, "Sys_GetUid system call");

870  
EUNSUPPORTED
;

871 
	}
}

873 
	$Sys_SëSëUid
(
I¡îru±_Sèã
 *
°©e
) {

874 
	`TODO_P
(
PROJECT_USER
, "Sys_SetSetUid system call");

875  
EUNSUPPORTED
;

876 
	}
}

878 
	$Sys_SëEf„˘iveUid
(
I¡îru±_Sèã
 *
°©e
) {

879 
	`TODO_P
(
PROJECT_USER
, "Sys_SetEffectiveUid system call");

880  
EUNSUPPORTED
;

881 
	}
}

883 
	$Sys_SëA˛
(
I¡îru±_Sèã
 *
°©e
) {

884 
	`TODO_P
(
PROJECT_USER
, "Sys_SetAcl system call");

885  
EUNSUPPORTED
;

886 
	}
}

888 
SB16_Pœy_Fûe
(c⁄° *
fûíame
);

889 
	$Sys_PœySoundFûe
(
I¡îru±_Sèã
 *
°©e
) {

890 
	`TODO_P
(
PROJECT_SOUND
, "PlaySoundFile system call");

892 
	}
}

900 
	$Sys_Pùe
(
I¡îru±_Sèã
 *
°©e
) {

901 
	`TODO_P
(
PROJECT_PIPE
, "Pipe system call");

902  
EUNSUPPORTED
;

903 
	}
}

907 
	$Sys_F‹k
(
I¡îru±_Sèã
 *
°©e
) {

908 
	`TODO_P
(
PROJECT_FORK
, "Fork system call");

909  
EUNSUPPORTED
;

910 
	}
}

921 
	$Sys_Exe˛
(
I¡îru±_Sèã
 *
°©e
) {

922 
	`TODO_P
(
PROJECT_FORK
, "Execl system call");

923  
EUNSUPPORTED
;

924 
	}
}

932 
	$Sys_Dügno°ic
(
I¡îru±_Sèã
 *
°©e
) {

933 ()
°©e
;

934 
	`E«bÀ_I¡îru±s
();

935 
	`Dump_Blockdev_Sèts
();

936 
	`DißbÀ_I¡îru±s
();

938 
	}
}

949 
	$Sys_Disk_Pr›îtõs
(
I¡îru±_Sèã
 *
°©e
) {

950 *
∑th
;

951 
block_size
, 
blocks_≥r_disk
;

952 
rc
;

953 
	`C›y_U£r_Såög
(
°©e
->
ebx
, sèã->
ecx
, 100, &
∑th
);

954 
	`E«bÀ_I¡îru±s
();

955 
rc
 = 
	`Disk_Pr›îtõs
(
∑th
, &
block_size
, &
blocks_≥r_disk
);

956 i‡(
rc
 == 0) {

957 
	`C›y_To_U£r
(
°©e
->
edx
, &
block_size
, ());

958 
	`C›y_To_U£r
(
°©e
->
esi
, &
blocks_≥r_disk
, ());

960 
	`DißbÀ_I¡îru±s
();

962 
	}
}

971 
	$Sys_Limô
(
I¡îru±_Sèã
 *
°©e
) {

972 
	`TODO_P
(
PROJECT_LIMIT
, "Limit system call");

973  
EUNSUPPORTED
;

974 
	}
}

976 
	$Sys_Së_Afföôy
(
I¡îru±_Sèã
 *
°©e
) {

977  
EUNSUPPORTED
;

978 
	}
}

980 
	$Sys_Gë_Afföôy
(
I¡îru±_Sèã
 *
°©e
) {

981  
EUNSUPPORTED
;

982 
	}
}

992 
	$Sys_Cl⁄e
(
I¡îru±_Sèã
 *
°©e
) {

993 
	`TODO_P
(
PROJECT_CLONE
, "Clone system call");

994  
EUNSUPPORTED
;

995 
	}
}

997 
	$Sys_Mm≠
(
I¡îru±_Sèã
 *
°©e
) {

998 
	`TODO_P
(
PROJECT_MMAP
, "Mmap system call");

999  
EUNSUPPORTED
;

1000 
	}
}

1002 
	$Sys_Munm≠
(
I¡îru±_Sèã
 *
°©e
) {

1003 
	`Munm≠_Im∂
(*);

1005 
	`TODO_P
(
PROJECT_MMAP
, "Munmap system call");

1006  
EUNSUPPORTED
;

1007 
	}
}

1009 
	$Sys_Aœrm
(
I¡îru±_Sèã
 *
°©e
) {

1010 
	`TODO_P
(
PROJECT_SIGNALS
, "Alarm");

1011  
EUNSUPPORTED
;

1012 
	}
}

1013 
	$Sys_O≥nCou¡
(
I¡îru±_Sèã
 *
°©e
) {

1014 
	`Pröt
("Pro˚s†madê%òO≥¿FûêSy†CÆls\n",
CURRENT_THREAD
->
›í_cou¡
);

1015  
EUNSUPPORTED
;

1016 
	}
}

1018 
	$Sys_TŸÆCou¡
(
I¡îru±_Sèã
 *
°©e
) {

1019 
	`Pröt
("Pro˚s†madê%òSy†CÆls\n",
CURRENT_THREAD
->
tŸÆ_cou¡
);

1020  
EUNSUPPORTED
;

1021 
	}
}

1023 
	$Sys_Gë_NewTOD
(
I¡îru±_Sèã
 *
°©e
) {

1024 
	`C›y_To_U£r
(
°©e
->
ebx
, (*)&
g_numTicks
, ());

1026 
	}
}

1033 c⁄° 
SysˇŒ
 
	gg_sysˇŒTabÀ
[] = {

1034 
Sys_NuŒ
,

1035 
Sys_Exô
,

1036 
Sys_PrötSåög
,

1037 
Sys_GëKey
,

1038 
Sys_SëAâr
,

1039 
Sys_GëCurs‹
,

1040 
Sys_PutCurs‹
,

1041 
Sys_S∑wn
,

1042 
Sys_Waô
,

1043 
Sys_GëPID
,

1044 
Sys_Kûl
,

1045 
Sys_PS
,

1046 
Sys_Sig«l
,

1047 
Sys_RegDñivî
,

1048 
Sys_Rëu∫Sig«l
,

1049 
Sys_WaôNoPID
,

1051 
Sys_SëSchedulögPﬁicy
,

1052 
Sys_GëTimeOfDay
,

1053 
Sys_O≥n_Sem≠h‹e
,

1054 
Sys_P
,

1055 
Sys_V
,

1056 
Sys_Clo£_Sem≠h‹e
,

1058 
Sys_Mou¡
,

1059 
Sys_O≥n
,

1060 
Sys_O≥nDúe˘‹y
,

1061 
Sys_Clo£
,

1062 
Sys_Dñëe
,

1063 
Sys_Ród
,

1064 
Sys_RódE¡ry
,

1065 
Sys_Wrôe
,

1066 
Sys_Sèt
,

1067 
Sys_FSèt
,

1068 
Sys_Sìk
,

1069 
Sys_Cª©eDú
,

1070 
Sys_Sync
,

1071 
Sys_F‹m©
,

1072 
Sys_ShutDown
,

1073 
Sys_RódBlock
,

1074 
Sys_WrôeBlock
,

1076 
Sys_EthPackëSíd
,

1077 
Sys_EthPackëRe˚ive
,

1078 
Sys_AΩ
,

1079 
Sys_RouãAdd
,

1080 
Sys_RouãDñ
,

1081 
Sys_RouãGë
,

1082 
Sys_IPC⁄figuª
,

1083 
Sys_IPGë
,

1084 
Sys_IPSíd
,

1086 
Sys_Sockë
,

1087 
Sys_Böd
,

1088 
Sys_Li°í
,

1089 
Sys_Ac˚±
,

1090 
Sys_C⁄√˘
,

1091 
Sys_Síd
,

1092 
Sys_Re˚ive
,

1093 
Sys_SídTo
,

1094 
Sys_Re˚iveFrom
,

1095 
Sys_Clo£Sockë
,

1097 
Sys_Limô
,

1098 
Sys_GëUid
,

1099 
Sys_SëSëUid
,

1100 
Sys_SëEf„˘iveUid
,

1101 
Sys_SëA˛
,

1103 
Sys_PœySoundFûe
,

1105 
Sys_Pùe
,

1106 
Sys_F‹k
,

1107 
Sys_Exe˛
,

1109 
Sys_Dügno°ic
,

1110 
Sys_Disk_Pr›îtõs
,

1112 
Sys_Së_Afföôy
,

1113 
Sys_Gë_Afföôy
,

1114 
Sys_Cl⁄e
,

1116 
Sys_Mm≠
,

1117 
Sys_Munm≠
,

1118 
Sys_Aœrm
,

1119 
Sys_Ríame
,

1120 
Sys_Lök
,

1121 
Sys_SymLök
,

1122 
Sys_O≥nCou¡
,

1123 
Sys_TŸÆCou¡
,

1124 
Sys_Gë_NewTOD


1130 c⁄° 
	gg_numSysˇŒs
 = (
g_sysˇŒTabÀ
Ë/ (
SysˇŒ
);

	@timer.c

15 
	~<gìkos/kas£π.h
>

16 
	~<gìkos/¥oje˘s.h
>

17 
	~<limôs.h
>

18 
	~<gìkos/io.h
>

19 
	~<gìkos/öt.h
>

20 
	~<gìkos/úq.h
>

21 
	~<gìkos/kthªad.h
>

22 
	~<gìkos/timî.h
>

23 
	~<gìkos/smp.h
>

25 
	#MAX_TIMER_EVENTS
 100

	)

27 
	gtimîDebug
 = 0;

28 
	gtimeEvítCou¡
;

29 
	g√xtEvítID
;

30 
timîEvít
 
	g≥ndögTimîEvíts
[
MAX_TIMER_EVENTS
];

35 vﬁ©ûê
ul⁄g_t
 
	gg_numTicks
;

40 
	gs_•öCou¡PîTick
;

45 
	#CALIBRATE_NUM_TICKS
 3

	)

51 
	#DEFAULT_MAX_TICKS
 4

	)

56 
	gg_Qu™tum
 = 
DEFAULT_MAX_TICKS
;

59 #ifde‡
DEBUG_TIMER


60 
	#Debug
(
¨gs
...Ë
	`Pröt
◊rgs)

	)

62 
	#Debug
(
¨gs
...)

	)

69 
	$Timî_I¡îru±_H™dÀr
(
I¡îru±_Sèã
 *
°©e
) {

70 
i
;

71 
id
;

72 
Kî√l_Thªad
 *
cuºít
 = 
CURRENT_THREAD
;

74 
	`Begö_IRQ
(
°©e
);

76 
id
 = 
	`Gë_CPU_ID
();

78 i‡(!
id
) {

80 ++
g_numTicks
;

85 ++
cuºít
->
numTicks
;

86 ++
cuºít
->
tŸÆTime
;

87 
CPUs
[
id
].
ticks
++;

94 i‡(!
id
) {

97 
i
 = 0; i < 
timeEvítCou¡
; i++) {

98 i‡(
≥ndögTimîEvíts
[
i
].
ticks
 == 0) {

99 i‡(
timîDebug
)

100 
	`Pröt
("timer:Évent %dÉxpired (%dÅicks)\n",

101 
≥ndögTimîEvíts
[
i
].
id
,

102 
≥ndögTimîEvíts
[
i
].
‹igTicks
);

103 (
≥ndögTimîEvíts
[
i
].
ˇŒBack
Ë’ídögTimîEvíts[i].
id
);

105 
≥ndögTimîEvíts
[
i
].
ticks
--;

109 i‡(
cuºít
->
numTicks
 >
g_Qu™tum
) {

110 
g_√edRescheduÀ
[
id
] = 
åue
;

118 
	`End_IRQ
(
°©e
);

119 
	}
}

125 
	$Timî_CÆibøã
(
I¡îru±_Sèã
 *
°©e
) {

126 
	`Begö_IRQ
(
°©e
);

127 i‡(
g_numTicks
 < 
CALIBRATE_NUM_TICKS
)

128 ++
g_numTicks
;

135 
s_•öCou¡PîTick
 = 
INT_MAX
 - 
°©e
->
óx
;

136 
°©e
->
óx
 = 0;

138 
	`End_IRQ
(
°©e
);

139 
	}
}

144 
	$Spö
(
cou¡
) {

152 
ªsu…
;

153 
__asm__
 
	`__vﬁ©ûe__
("1: decl %%eax\n\t"

157 "jg 1b":"˜"(
ªsu…
)

158 :"a"(
cou¡
)

160 
	}
}

167 
	$CÆibøã_Dñay
() {

168 
	`DißbÀ_I¡îru±s
();

171 
	`In°Æl_IRQ
(
TIMER_IRQ
, &
Timî_CÆibøã
);

172 
	`E«bÀ_IRQ
(
TIMER_IRQ
);

174 
	`E«bÀ_I¡îru±s
();

177 
g_numTicks
 < 
CALIBRATE_NUM_TICKS
);

184 
	`Spö
(
INT_MAX
);

186 
	`DißbÀ_I¡îru±s
();

192 
	`DißbÀ_IRQ
(
TIMER_IRQ
);

193 
	`E«bÀ_I¡îru±s
();

194 
	}
}

200 
	$Inô_Timî_I¡îru±
() {

202 
	`E«bÀ_IRQ
(32);

203 
	}
}

205 
	$Inô_Timî
() {

212 
	`Pröt
("InitializingÅimer...\n");

227 
	`In°Æl_IRQ
(32, &
Timî_I¡îru±_H™dÀr
);

229 
	`Inô_Timî_I¡îru±
();

230 
	}
}

232 
	$Sèπ_Timî
(
ticks
, 
timîCÆlback
 
cb
) {

233 
ªtu∫ed_timî_id
;

235 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

237 i‡(
timeEvítCou¡
 =
MAX_TIMER_EVENTS
) {

238 
Pröt


240 
MAX_TIMER_EVENTS
);

241 
i
;

242 
i
 = 0; i < 
MAX_TIMER_EVENTS
; i++) {

243 
	`Pröt
("%d: cb 0x%∞ö %d/%dÅicks", 
i
,

244 
≥ndögTimîEvíts
[
i
].
ˇŒBack
,

245 
≥ndögTimîEvíts
[
i
].
ticks
,

246 
≥ndögTimîEvíts
[
i
].
‹igTicks
);

250 
ªtu∫ed_timî_id
 = 
√xtEvítID
++;

251 
≥ndögTimîEvíts
[
timeEvítCou¡
].
id
 = 
ªtu∫ed_timî_id
;

252 
≥ndögTimîEvíts
[
timeEvítCou¡
].
ˇŒBack
 = 
cb
;

253 
≥ndögTimîEvíts
[
timeEvítCou¡
].
ticks
 =Åicks;

254 
≥ndögTimîEvíts
[
timeEvítCou¡
].
‹igTicks
 = 
ticks
;

255 
timeEvítCou¡
++;

257  
ªtu∫ed_timî_id
;

259 
	}
}

261 
	$Gë_Remaög_Timî_Ticks
(
id
) {

262 
i
;

264 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

265 
i
 = 0; i < 
timeEvítCou¡
; i++) {

266 i‡(
≥ndögTimîEvíts
[
i
].
id
 == id) {

267  
≥ndögTimîEvíts
[
i
].
ticks
;

272 
	}
}

274 
	$C™˚l_Timî
(
id
) {

275 
i
;

276 
	`KASSERT
(!
	`I¡îru±s_E«bÀd
());

277 
i
 = 0; i < 
timeEvítCou¡
; i++) {

278 i‡(
≥ndögTimîEvíts
[
i
].
id
 == id) {

279 
≥ndögTimîEvíts
[
i
] =ÖídögTimîEvíts[
timeEvítCou¡
 - 1];

280 
timeEvítCou¡
--;

285 
	`Pröt
("timî: u«bÀÅÿfödÅimî id %dÅÿˇn˚»ô\n", 
id
);

287 
	}
}

289 
	#US_PER_TICK
 (
TICKS_PER_SEC
 * 1000000)

	)

296 
	$Mi¸o_Dñay
(
us
) {

297 
num
 = 
us
 * 
s_•öCou¡PîTick
;

298 
díom
 = 
US_PER_TICK
;

300 
numSpös
 = 
num
 / 
díom
;

301 
ªm
 = 
num
 % 
díom
;

303 i‡(
ªm
 > 0)

304 ++
numSpös
;

306 
	`Debug
("Mi¸o_Dñay():Çum=%d, díom=%d, spö cou¡ = %d\n", 
num
, 
díom
,

307 
numSpös
);

309 
	`Spö
(
numSpös
);

310 
	}
}

	@trap.c

18 
	~<gìkos/idt.h
>

19 
	~<gìkos/kthªad.h
>

20 
	~<gìkos/defs.h
>

21 
	~<gìkos/sysˇŒ.h
>

22 
	~<gìkos/å≠.h
>

23 
	~<gìkos/u£r.h
>

24 
	~<gìkos/¥oje˘s.h
>

35 
	$GPF_H™dÀr
(
I¡îru±_Sèã
 *
°©e
) {

37 
	`Pröt
("Exception %dÑeceived, killingÅhread %p (pid %d)\n",

38 
°©e
->
ötNum
, 
CURRENT_THREAD
, CURRENT_THREAD->
pid
);

39 
	`Dump_I¡îru±_Sèã
(
°©e
);

41 
	`Exô
(-1);

44 
	`KASSERT
(
Ál£
);

45 
	}
}

50 
	$SysˇŒ_H™dÀr
(
I¡îru±_Sèã
 *
°©e
) {

52 
uöt_t
 
sysˇŒNum
 = 
°©e
->
óx
;

54 
U£r_C⁄ãxt
 *
u£r
;

58 i‡(
sysˇŒNum
 >
g_numSysˇŒs
) {

59 
	`Pröt
("Illegal system call %d byÖrocess %d\n",

60 
sysˇŒNum
, 
CURRENT_THREAD
->
pid
);

61 
	`Exô
(-1);

64 
	`KASSERT
(
Ál£
);

71 
°©e
->
óx
 = 
g_sysˇŒTabÀ
[
sysˇŒNum
] (state);

72 
CURRENT_THREAD
->
tŸÆ_cou¡
++;

73 
	}
}

78 
	$Inô_Tøps
() {

79 
	`In°Æl_I¡îru±_H™dÀr
(12, &
GPF_H™dÀr
);

80 
	`In°Æl_I¡îru±_H™dÀr
(13, &
GPF_H™dÀr
);

81 
	`In°Æl_I¡îru±_H™dÀr
(
SYSCALL_INT
, &
SysˇŒ_H™dÀr
);

82 
	}
}

	@tss.c

20 
	~<gìkos/kas£π.h
>

21 
	~<gìkos/defs.h
>

22 
	~<gìkos/gdt.h
>

23 
	~<gìkos/£gmít.h
>

24 
	~<gìkos/°rög.h
>

25 
	~<gìkos/tss.h
>

26 
	~<gìkos/smp.h
>

31 
TSS
 
	gs_theTSS
[
MAX_CPUS
];

32 
Segmít_Des¸ùt‹
 *
	gs_tssDesc
[
MAX_CPUS
];

33 
ush‹t_t
 
	gs_tssSñe˘‹
[
MAX_CPUS
];

35 
__ölöe__
 
	$Lﬂd_Task_Regi°î
() {

36 
˝u
 = 
	`Gë_CPU_ID
();

38 
	`KASSERT
(
s_tssDesc
[
˝u
]);

41 
s_tssDesc
[
˝u
]->
ty≥
 = 0x09;

44 
__asm__
 
	`__vﬁ©ûe__
("…∏%0"::"a"(
s_tssSñe˘‹
[
˝u
])

46 
	}
}

52 
	$Inô_TSS
() {

53 
˝u
 = 
	`Gë_CPU_ID
();

55 
s_tssDesc
[
˝u
] = 
	`AŒoˇã_Segmít_Des¸ùt‹
();

56 
	`KASSERT
(
s_tssDesc
[
˝u
] != 0);

58 
	`mem£t
(&
s_theTSS
[
˝u
], '\0', (
TSS
));

59 
	`Inô_TSS_Des¸ùt‹
(
s_tssDesc
[
˝u
], &
s_theTSS
[cpu]);

61 
s_tssSñe˘‹
[
˝u
] =

62 
	`Sñe˘‹
(0, 
åue
, 
	`Gë_Des¸ùt‹_Index
(
s_tssDesc
[
˝u
]));

64 
	`Lﬂd_Task_Regi°î
();

65 
	}
}

73 
	$Së_Kî√l_Sèck_Poöãr
(
ul⁄g_t
 
e•0
) {

74 
˝u
 = 
	`Gë_CPU_ID
();

76 
s_theTSS
[
˝u
].
ss0
 = 
KERNEL_DS
;

77 
s_theTSS
[
˝u
].
e•0
 =Ésp0;

85 
	`Lﬂd_Task_Regi°î
();

86 
	}
}

88 
	gsubmôTe°ög
;

95 
	$checkPagög
() {

96 
ªg
 = 0;

97 
__asm__
 
	`__vﬁ©ûe__
("mov»%%¸0, %0":"˜"(
ªg
));

98 
	`Pröt
("Pagög o¿? : %d\n", (
ªg
 & (1 << 31)) != 0);

99 
	}
}

	@user.c

18 
	~<gìkos/î∫o.h
>

19 
	~<gìkos/kty≥s.h
>

20 
	~<gìkos/kas£π.h
>

21 
	~<gìkos/öt.h
>

22 
	~<gìkos/mem.h
>

23 
	~<gìkos/mÆloc.h
>

24 
	~<gìkos/kthªad.h
>

25 
	~<gìkos/vfs.h
>

26 
	~<gìkos/tss.h
>

27 
	~<gìkos/u£r.h
>

28 
	~<gìkos/¥oje˘s.h
>

29 
	~<gìkos/smp.h
>

30 
	~<libc/°rög.h
>

37 
Spö_Lock_t
 
kthªadLock
;

43 
	$Aâach_U£r_C⁄ãxt
(
Kî√l_Thªad
 *
kthªad
,

44 
U£r_C⁄ãxt
 *
c⁄ãxt
) {

45 
	`KASSERT
(
c⁄ãxt
 != 0);

46 
kthªad
->
u£rC⁄ãxt
 = 
c⁄ãxt
;

48 
	`Spö_Lock
(&
kthªadLock
);

50 
	`KASSERT
(
c⁄ãxt
->
ªfCou¡
 >= 0);

52 ++
c⁄ãxt
->
ªfCou¡
;

54 
	`Spö_U∆ock
(&
kthªadLock
);

55 
	}
}

63 
	$Dëach_U£r_C⁄ãxt
(
Kî√l_Thªad
 *
kthªad
) {

64 
U£r_C⁄ãxt
 *
ﬁd
 = 
kthªad
->
u£rC⁄ãxt
;

66 
kthªad
->
u£rC⁄ãxt
 = 
NULL
;

68 i‡(
ﬁd
 != 0) {

69 
boﬁ
 
iÊag
;

70 
iÊag
 = 
	`Begö_I¡_Atomic
();

72 
ªfCou¡
;

74 --
ﬁd
->
ªfCou¡
;

75 i‡(
ﬁd
->
ªfCou¡
 == 0) {

76 
	`De°roy_U£r_C⁄ãxt
(
ﬁd
);

78 
	`End_I¡_Atomic
(
iÊag
);

80 
	}
}

97 
	$S∑wn
(c⁄° *
¥ogøm
, c⁄° *
comm™d
,

98 
Kî√l_Thªad
 **
pThªad
, 
boﬁ
 
background
) {

99 
rc
;

100 *
exeFûeD©a
 = 0;

101 
ul⁄g_t
 
exeFûeLígth
;

102 
U£r_C⁄ãxt
 *
u£rC⁄ãxt
 = 0;

103 
Kî√l_Thªad
 *
¥o˚ss
 = 0;

104 
Exe_F‹m©
 
exeF‹m©
;

110 i‡((
rc
 = 
	`Ród_FuŒy
(
¥ogøm
, (**)&
exeFûeD©a
, &
exeFûeLígth
)) != 0

111 || (
rc
 =

112 
	`P¨£_ELF_ExecuèbÀ
(
exeFûeD©a
, 
exeFûeLígth
, &
exeF‹m©
)) != 0

113 || (
rc
 =

114 
	`Lﬂd_U£r_Progøm
(
exeFûeD©a
, 
exeFûeLígth
, &
exeF‹m©
, 
comm™d
,

115 &
u£rC⁄ãxt
)) != 0)

116 
Áû
;

122 
	`Fªe
(
exeFûeD©a
);

123 
exeFûeD©a
 = 0;

125 
	`°∫˝y
(
u£rC⁄ãxt
->
«me
, 
¥ogøm
, 
MAX_PROC_NAME_SZB
);

126 
u£rC⁄ãxt
->
«me
[
MAX_PROC_NAME_SZB
 - 1] = '\0';

130 
¥o˚ss
 = 
	`Sèπ_U£r_Thªad
(
u£rC⁄ãxt
, 
background
);

131 i‡(
¥o˚ss
 != 0) {

133 *
pThªad
 = 
¥o˚ss
;

135 
rc
 = 
ENOMEM
;

137  
rc
;

139 
Áû
:

140 i‡(
exeFûeD©a
 != 0)

141 
	`Fªe
(
exeFûeD©a
);

142 i‡(
u£rC⁄ãxt
 != 0)

143 
	`De°roy_U£r_C⁄ãxt
(
u£rC⁄ãxt
);

145  
rc
;

146 
	}
}

151 
	$S∑wn_F‹eground
(c⁄° *
¥ogøm
, c⁄° *
comm™d
,

152 
Kî√l_Thªad
 **
pThªad
) {

153  
	`S∑wn
(
¥ogøm
, 
comm™d
, 
pThªad
, 
Ál£
);

154 
	}
}

166 
Swôch_To_U£r_C⁄ãxt
(
Kî√l_Thªad
 *
kthªad
,

167 
I¡îru±_Sèã
 *
°©e


168 
__©åibuã__
 ((
unu£d
))) {

169 
	g˝uID
;

170 
u£rDebug
;

171 
U£r_C⁄ãxt
 *
	gu£rC⁄ãxt
 = 
kthªad
->
u£rC⁄ãxt
;

178 
	g˝uID
 = 
Gë_CPU_ID
();

180 
KASSERT
(!
I¡îru±s_E«bÀd
());

182 i‡(
	gCPUs
[
˝uID
].
	gs_cuºítU£rC⁄ãxt
 && 
	gu£rC⁄ãxt
 == 0) {

186 
Së_PDBR
((*)
Kî√l_Page_Dú
());

187 
	gCPUs
[
˝uID
].
	gs_cuºítU£rC⁄ãxt
 = 
NULL
;

191 i‡(
	gu£rC⁄ãxt
 !
CPUs
[
˝uID
].
s_cuºítU£rC⁄ãxt
) {

193 i‡(
u£rDebug
)

194 
Pröt
("A[%p]\n", 
kthªad
);

197 
Swôch_To_Addªss_S∑˚
(
u£rC⁄ãxt
);

200 
	gCPUs
[
˝uID
].
	gs_cuºítU£rC⁄ãxt
 = 
u£rC⁄ãxt
;

210 
ul⁄g_t
 
	ge•0
;

212 
	ge•0
 = ((
ul⁄g_t
Ë
kthªad
->
°ackPage
Ë+ 
PAGE_SIZE
;

213 i‡(
	gu£rDebug
)

214 
Pröt
("S[%lx]\n", 
e•0
);

217 
Së_Kî√l_Sèck_Poöãr
(
e•0
);

	@userseg.c

15 
	~<gìkos/kty≥s.h
>

16 
	~<gìkos/kas£π.h
>

17 
	~<gìkos/defs.h
>

18 
	~<gìkos/mem.h
>

19 
	~<gìkos/°rög.h
>

20 
	~<gìkos/mÆloc.h
>

21 
	~<gìkos/öt.h
>

22 
	~<gìkos/gdt.h
>

23 
	~<gìkos/£gmít.h
>

24 
	~<gìkos/tss.h
>

25 
	~<gìkos/kthªad.h
>

26 
	~<gìkos/¨gblock.h
>

27 
	~<gìkos/u£r.h
>

33 
	#DEFAULT_USER_STACK_SIZE
 8192

	)

36 
	gu£rDebug
 = 0;

42 *
	$U£r_To_Kî√l
(
U£r_C⁄ãxt
 *
u£rC⁄ãxt
, 
ul⁄g_t
 
u£rPå
) {

43 
uch¨_t
 *
u£rBa£
 = (uch¨_à*Ë
u£rC⁄ãxt
->
mem‹y
;

45  (*)(
u£rBa£
 + 
u£rPå
);

46 
	}
}

51 
U£r_C⁄ãxt
 *
	$Cª©e_U£r_C⁄ãxt
(
ul⁄g_t
 
size
) {

52 
U£r_C⁄ãxt
 *
c⁄ãxt
;

53 
ödex
;

56 
size
 = 
	`Round_Up_To_Page
(size);

57 i‡(
u£rDebug
)

58 
	`Pröt
("Sizêo‡u£∏mem‹y =%lu (%lxË(%luÖages)\n", 
size
, size,

59 
size
 / 
PAGE_SIZE
);

62 
	`DißbÀ_I¡îru±s
();

63 
c⁄ãxt
 = (
U£r_C⁄ãxt
 *)
	`MÆloc
((*context));

64 i‡(
c⁄ãxt
 != 0) {

65 
	`mem£t
(
c⁄ãxt
, 0, (
U£r_C⁄ãxt
));

66 
c⁄ãxt
->
mem‹y
 = 
	`MÆloc
(
size
);

68 
	`E«bÀ_I¡îru±s
();

70 i‡(
c⁄ãxt
 =0 || c⁄ãxt->
mem‹y
 == 0)

71 
Áû
;

77 
	`mem£t
(
c⁄ãxt
->
mem‹y
, '\0', 
size
);

79 
c⁄ãxt
->
size
 = size;

82 
c⁄ãxt
->
ldtDes¸ùt‹
 = 
	`AŒoˇã_Segmít_Des¸ùt‹
();

83 i‡(
c⁄ãxt
->
ldtDes¸ùt‹
 == 0)

84 
Áû
;

85 i‡(
u£rDebug
)

86 
	`Pröt
("Allocated descriptor %d for LDT\n",

87 
	`Gë_Des¸ùt‹_Index
(
c⁄ãxt
->
ldtDes¸ùt‹
));

88 
	`Inô_LDT_Des¸ùt‹
(
c⁄ãxt
->
ldtDes¸ùt‹
, c⁄ãxt->
ldt
,

89 
NUM_USER_LDT_ENTRIES
);

90 
ödex
 = 
	`Gë_Des¸ùt‹_Index
(
c⁄ãxt
->
ldtDes¸ùt‹
);

91 
c⁄ãxt
->
ldtSñe˘‹
 = 
	`Sñe˘‹
(
KERNEL_PRIVILEGE
, 
åue
, 
ödex
);

94 
	`Inô_Code_Segmít_Des¸ùt‹
(&
c⁄ãxt
->
ldt
[0],

95 (
ul⁄g_t
Ë
c⁄ãxt
->
mem‹y
,

96 
size
 / 
PAGE_SIZE
, 
USER_PRIVILEGE
);

97 
	`Inô_D©a_Segmít_Des¸ùt‹
(&
c⁄ãxt
->
ldt
[1],

98 (
ul⁄g_t
Ë
c⁄ãxt
->
mem‹y
,

99 
size
 / 
PAGE_SIZE
, 
USER_PRIVILEGE
);

100 
c⁄ãxt
->
csSñe˘‹
 = 
	`Sñe˘‹
(
USER_PRIVILEGE
, 
Ál£
, 0);

101 
c⁄ãxt
->
dsSñe˘‹
 = 
	`Sñe˘‹
(
USER_PRIVILEGE
, 
Ál£
, 1);

104 
c⁄ãxt
->
ªfCou¡
 = 0;

108  
c⁄ãxt
;

110 
Áû
:

112 
	`DißbÀ_I¡îru±s
();

113 i‡(
c⁄ãxt
 != 0) {

114 i‡(
c⁄ãxt
->
mem‹y
 != 0)

115 
	`Fªe
(
c⁄ãxt
->
mem‹y
);

116 
	`Fªe
(
c⁄ãxt
);

118 
	`E«bÀ_I¡îru±s
();

121 
	}
}

123 
boﬁ
 
	$VÆid©e_U£r_Mem‹y
(
U£r_C⁄ãxt
 * 
u£rC⁄ãxt
,

124 
ul⁄g_t
 
u£rAddr
, ul⁄g_à
bufSize
) {

125 
ul⁄g_t
 
avaû
;

127 i‡(
u£rAddr
 >
u£rC⁄ãxt
->
size
)

128  
Ál£
;

130 
avaû
 = 
u£rC⁄ãxt
->
size
 - 
u£rAddr
;

131 i‡(
bufSize
 > 
avaû
)

132  
Ál£
;

134  
åue
;

135 
	}
}

145 
	$De°roy_U£r_C⁄ãxt
(
U£r_C⁄ãxt
 *
u£rC⁄ãxt
) {

146 
	`KASSERT
(
u£rC⁄ãxt
->
ªfCou¡
 == 0);

149 
	`Fªe_Segmít_Des¸ùt‹
(
u£rC⁄ãxt
->
ldtDes¸ùt‹
);

152 
boﬁ
 
iÊag
;

153 
iÊag
 = 
	`Begö_I¡_Atomic
();

154 
	`Fªe
(
u£rC⁄ãxt
->
mem‹y
);

155 
	`Fªe
(
u£rC⁄ãxt
);

156 
	`End_I¡_Atomic
(
iÊag
);

157 
	}
}

177 
Lﬂd_U£r_Progøm
(*
exeFûeD©a
, 
ul⁄g_t
 
exeFûeLígth


178 
__©åibuã__
 ((
unu£d
)), 
Exe_F‹m©
 *
exeF‹m©
,

179 c⁄° *
comm™d
,

180 
U£r_C⁄ãxt
 **
pU£rC⁄ãxt
) {

181 
	gi
;

182 
ul⁄g_t
 
	gmaxva
 = 0;

183 
	gnumArgs
;

184 
ul⁄g_t
 
	g¨gBlockSize
;

185 
ul⁄g_t
 
	gsize
, 
	g¨gBlockAddr
;

186 
U£r_C⁄ãxt
 *
	gu£rC⁄ãxt
 = 0;

189 
	gi
 = 0; i < 
	gexeF‹m©
->
	gnumSegmíts
; ++i) {

190 
Exe_Segmít
 *
	g£gmít
 = &
exeF‹m©
->
£gmítLi°
[
i
];

191 
ul⁄g_t
 
	gt›va
 = 
£gmít
->
°¨tAddªss
 + segmít->
sizeInMem‹y
;

193 i‡(
	gt›va
 > 
	gmaxva
)

194 
	gmaxva
 = 
t›va
;

198 
Gë_Argumít_Block_Size
(
comm™d
, &
numArgs
, &
¨gBlockSize
);

204 
	gsize
 = 
Round_Up_To_Page
(
maxva
Ë+ 
DEFAULT_USER_STACK_SIZE
;

205 
	g¨gBlockAddr
 = 
size
;

206 
	gsize
 +
¨gBlockSize
;

209 
	gu£rC⁄ãxt
 = 
Cª©e_U£r_C⁄ãxt
(
size
);

210 i‡(
	gu£rC⁄ãxt
 == 0)

214 
	gi
 = 0; i < 
	gexeF‹m©
->
	gnumSegmíts
; ++i) {

215 
Exe_Segmít
 *
	g£gmít
 = &
exeF‹m©
->
£gmítLi°
[
i
];

217 
mem˝y
(
u£rC⁄ãxt
->
mem‹y
 + 
£gmít
->
°¨tAddªss
,

218 
exeFûeD©a
 + 
£gmít
->
off£tInFûe
, segmít->
ÀngthInFûe
);

222 
F‹m©_Argumít_Block
(
u£rC⁄ãxt
->
mem‹y
 + 
¨gBlockAddr
, 
numArgs
,

223 
¨gBlockAddr
, 
comm™d
);

226 
	gu£rC⁄ãxt
->
	gíåyAddr
 = 
exeF‹m©
->
íåyAddr
;

232 
	gu£rC⁄ãxt
->
	g¨gBlockAddr
 = 
¨gBlockAddr
;

233 
	gu£rC⁄ãxt
->
	g°ackPoöãrAddr
 = 
¨gBlockAddr
;

236 *
	gpU£rC⁄ãxt
 = 
u£rC⁄ãxt
;

252 
boﬁ
 
	$C›y_From_U£r
(*
de°InKî√l
, 
ul⁄g_t
 
§cInU£r
, ul⁄g_à
bufSize
) {

253 
U£r_C⁄ãxt
 *
cuºít
 = 
CURRENT_THREAD
->
u£rC⁄ãxt
;

255 i‡(!
	`VÆid©e_U£r_Mem‹y
(
cuºít
, 
§cInU£r
, 
bufSize
))

256  
Ál£
;

257 
	`mem˝y
(
de°InKî√l
, 
	`U£r_To_Kî√l
(
cuºít
, 
§cInU£r
), 
bufSize
);

259  
åue
;

260 
	}
}

274 
boﬁ
 
	$C›y_To_U£r
(
ul⁄g_t
 
de°InU£r
, *
§cInKî√l
, ul⁄g_à
bufSize
) {

275 
U£r_C⁄ãxt
 *
cuºít
 = 
CURRENT_THREAD
->
u£rC⁄ãxt
;

277 i‡(!
	`VÆid©e_U£r_Mem‹y
(
cuºít
, 
de°InU£r
, 
bufSize
))

278  
Ál£
;

279 
	`mem˝y
(
	`U£r_To_Kî√l
(
cuºít
, 
de°InU£r
), 
§cInKî√l
, 
bufSize
);

281  
åue
;

282 
	}
}

290 
	$Swôch_To_Addªss_S∑˚
(
U£r_C⁄ãxt
 *
u£rC⁄ãxt
) {

291 
ush‹t_t
 
ldtSñe˘‹
;

296 
	`KASSERT
(
u£rC⁄ãxt
->
mem‹y
 || u£rC⁄ãxt->
∑geDú
);

299 
ldtSñe˘‹
 = 
u£rC⁄ãxt
->ldtSelector;

300 
__asm__
 
	`__vﬁ©ûe__
("Œdà%0"::"a"(
ldtSñe˘‹
)

302 
	}
}

	@uservm.c

17 
	~<gìkos/öt.h
>

18 
	~<gìkos/mem.h
>

19 
	~<gìkos/∑gög.h
>

20 
	~<gìkos/mÆloc.h
>

21 
	~<gìkos/°rög.h
>

22 
	~<gìkos/¨gblock.h
>

23 
	~<gìkos/kthªad.h
>

24 
	~<gìkos/ønge.h
>

25 
	~<gìkos/vfs.h
>

26 
	~<gìkos/u£r.h
>

27 
	~<gìkos/¥oje˘s.h
>

28 
	~<gìkos/gdt.h
>

30 
	#DEFAULT_USER_STACK_SIZE
 8192

	)

32 
Spö_Lock_t
 
kthªadLock
;

34 
	gu£rDebug
 = 0;

35 
	#Debug
(
¨gs
...Ëi‡(
u£rDebug
Ë
	`Pröt
("u£rvm: "árgs)

	)

44 
U£r_C⁄ãxt
 *
	$Cª©e_U£r_C⁄ãxt
(
ul⁄g_t
 
size
) {

45 
U£r_C⁄ãxt
 *
c⁄ãxt
;

46 
ödex
;

47 
uöt_t
 
i
,
j
;

49 
ul⁄g_t
 
kî√l_∑ges
;

50 
ul⁄g_t
 
kî√l_PDE¡rõs
;

51 
ul⁄g_t
 
c⁄ãxt_size
;

52 
ul⁄g_t
 
c⁄ãxt_∑ges
;

54 
size
 = 
	`Round_Up_To_Page
(size);

55 
kî√l_∑ges
 = 
KERNEL_SPACE_END
>>12;

56 
kî√l_PDE¡rõs
 = 
kî√l_∑ges
/
NUM_PAGE_TABLE_ENTRIES
;

57 i‡(
u£rDebug
)

58 
	`Pröt
("Sizêo‡u£∏mem‹y =%lu (%lxË(%luÖages)\n", 
size
, size,

59 
size
 / 
PAGE_SIZE
);

61 
pde_t
 * 
U£rPageDú
;

63 
U£rPageDú
 = (
pde_t
*Ë
	`AŒoc_Page
();

66 
i
=0; i<
kî√l_PDE¡rõs
; i++) {

67 
pde_t
 
íåy
 = {0};

68 
U£rPageDú
[
i
] = 
PageDú
[i];

71 
i
=
kî√l_PDE¡rõs
;i<
NUM_PAGE_DIR_ENTRIES
;i++){

73 
pde_t
 
íåy
 = {0};

74 
íåy
.
Êags
 = 
VM_USER
 | 
VM_WRITE
;

75 
U£rPageDú
[
i
] = 
íåy
;

79 
U£rPageDú
[1019] = 
PageDú
[1019];

82 
	`DißbÀ_I¡îru±s
();

119 
c⁄ãxt
 = (
U£r_C⁄ãxt
 *)
	`MÆloc
((*context));

120 i‡(
c⁄ãxt
 != 0) {

121 
	`mem£t
(
c⁄ãxt
, 0, (
U£r_C⁄ãxt
));

122 
c⁄ãxt
->
mem‹y
=(*)(
USER_VM_START
);

125 
	`E«bÀ_I¡îru±s
();

127 i‡(
c⁄ãxt
 =0 || c⁄ãxt->
mem‹y
 == 0)

128 
Áû
;

135 
c⁄ãxt
->
∑geDú
=
U£rPageDú
;

136 
c⁄ãxt
->
size
 = size;

139 
c⁄ãxt
->
ldtDes¸ùt‹
 = 
	`AŒoˇã_Segmít_Des¸ùt‹
();

140 i‡(
c⁄ãxt
->
ldtDes¸ùt‹
 == 0)

141 
Áû
;

142 i‡(
u£rDebug
)

143 
	`Pröt
("Allocated descriptor %d for LDT\n",

144 
	`Gë_Des¸ùt‹_Index
(
c⁄ãxt
->
ldtDes¸ùt‹
));

145 
	`Inô_LDT_Des¸ùt‹
(
c⁄ãxt
->
ldtDes¸ùt‹
, c⁄ãxt->
ldt
,

146 
NUM_USER_LDT_ENTRIES
);

147 
ödex
 = 
	`Gë_Des¸ùt‹_Index
(
c⁄ãxt
->
ldtDes¸ùt‹
);

148 
c⁄ãxt
->
ldtSñe˘‹
 = 
	`Sñe˘‹
(
KERNEL_PRIVILEGE
, 
åue
, 
ödex
);

151 
	`Inô_Code_Segmít_Des¸ùt‹
(&
c⁄ãxt
->
ldt
[0],

152 (
ul⁄g_t
Ë
c⁄ãxt
->
mem‹y
,

153 
size
 / 
PAGE_SIZE
, 
USER_PRIVILEGE
);

154 
	`Inô_D©a_Segmít_Des¸ùt‹
(&
c⁄ãxt
->
ldt
[1],

155 (
ul⁄g_t
Ë
c⁄ãxt
->
mem‹y
,

156 
size
 / 
PAGE_SIZE
, 
USER_PRIVILEGE
);

157 
c⁄ãxt
->
csSñe˘‹
 = 
	`Sñe˘‹
(
USER_PRIVILEGE
, 
Ál£
, 0);

158 
c⁄ãxt
->
dsSñe˘‹
 = 
	`Sñe˘‹
(
USER_PRIVILEGE
, 
Ál£
, 1);

161 
c⁄ãxt
->
ªfCou¡
 = 0;

167  
c⁄ãxt
;

169 
Áû
:

171 
	`DißbÀ_I¡îru±s
();

172 i‡(
c⁄ãxt
 != 0) {

173 i‡(
c⁄ãxt
->
mem‹y
 != 0)

174 
	`Fªe
(
c⁄ãxt
->
mem‹y
);

175 
	`Fªe
(
c⁄ãxt
);

177 
	`E«bÀ_I¡îru±s
();

180 
	}
}

188 
boﬁ
 
	$Fªe_Pages_U£r_Pro˚ss
(
pde_t
 * 
∑ge_dú
)

190 
pde_t
 * 
pdú
;

192 
boﬁ
 
Êag
;

193 
Êag
=
	`Begö_I¡_Atomic
();

195 if(
∑ge_dú
==
NULL
)

197  
åue
;

200 
pdú
=
∑ge_dú
+
NUM_PAGE_DIR_ENTRIES
/2;Ödir <Öage_dir+NUM_PAGE_DIR_ENTRIES;Ödir++)

202 
±e_t
 * 
±abÀ
;

203 
±e_t
 * 
±abÀ_fú°
;

205 if(!
pdú
->
¥e£¡
)

209 
±abÀ_fú°
=(
±e_t
*Ë(
pdú
->
∑geTabÀBa£Addr
 << 12);

210 
±abÀ
=
±abÀ_fú°
;ÖèbÀ<±abÀ_fú°+
NUM_PAGE_TABLE_ENTRIES
;Ötable++)

212 if(
±abÀ
->
∑geBa£Addr
 >= ()0xfec00) {

213 
skù
;

216 if(
±abÀ
->
¥e£¡
)

218 
	`Fªe_Page
–(*Ë(
±abÀ
->
∑geBa£Addr
 << 12));

220 if(
±abÀ
->
kî√lInfo
==
KINFO_PAGE_ON_DISK
)

222 
	`Fªe_S∑˚_On_Pagög_Fûe
(
±abÀ
->
∑geBa£Addr
);

226 
	`Fªe_Page
(
±abÀ_fú°
);

229 
skù
:

230 
	`Fªe_Page
(
∑ge_dú
);

232 
	`End_I¡_Atomic
(
Êag
);

234  
åue
;

235 
	}
}

242 
	$De°roy_U£r_C⁄ãxt
(
U£r_C⁄ãxt
 *
c⁄ãxt
) {

253 if(
c⁄ãxt
 =
NULL
)

255 
	`Pröt
("Null ContextÉrror!\n");

259 
	`Fªe_Segmít_Des¸ùt‹
(
c⁄ãxt
->
ldtDes¸ùt‹
);

261 if(
c⁄ãxt
->
∑geDú
!=
NULL
)

263 
	`Fªe_Pages_U£r_Pro˚ss
(
c⁄ãxt
->
∑geDú
);

266 
boﬁ
 
iÊag
;

267 
iÊag
 = 
	`Begö_I¡_Atomic
();

268 
	`Fªe
(
c⁄ãxt
);

269 
	`End_I¡_Atomic
(
iÊag
);

271 
i
;

277 
	}
}

281 
	$AŒoc_Pages_U£r
(
pde_t
 *
∑geDú
,
uöt_t
 
°¨tAddªss
,uöt_à
sizeInMem‹y
) {

282 
uöt_t
 
∑gedú_ödex
=
°¨tAddªss
>>22;

283 
uöt_t
 
∑ge_ödex
=(
°¨tAddªss
<<10)>>22;

285 
pde_t
 *
∑gedú_íåy
 = 
∑geDú
+
∑gedú_ödex
;

286 
±e_t
 *
∑ge_íåy
;

288 
ul⁄g_t
 
num_∑ges
, 
num_∑ges_ãmp
;

289 *
∑ge_addr
;

290 
num_∑ges
=
	`Round_Up_To_Page
(
°¨tAddªss
-
	`Round_Down_To_Page
(°¨tAddªss)+
sizeInMem‹y
)/
PAGE_SIZE
;

292 
num_∑ges
>0) {

293 if(
∑gedú_íåy
->
¥e£¡
)

295 
∑ge_íåy
=(
±e_t
 *)(
∑gedú_íåy
->
∑geTabÀBa£Addr
<<12);

299 
∑ge_íåy
=(
±e_t
*Ë
	`AŒoc_Page
();

300 if(
∑ge_íåy
==
NULL
)

302 
	`Pröt
("canÇotállocateÖage in Alloc_Pages_User/n");

305 
	`mem£t
(
∑ge_íåy
,0,
PAGE_SIZE
);

306 *((
uöt_t
*)
∑gedú_íåy
)=0;

307 
∑gedú_íåy
->
¥e£¡
=1;

308 
∑gedú_íåy
->
Êags
=
VM_WRITE
 | 
VM_READ
 | 
VM_USER
;

309 
∑gedú_íåy
->
globÆPage
=0;

310 
∑gedú_íåy
->
∑geTabÀBa£Addr
=(
ul⁄g_t
)
∑ge_íåy
 >> 12;

313 
∑ge_íåy
+=
∑ge_ödex
;

315 
uöt_t
 
i
;

316 
uöt_t
 
fú°_∑ge_addr
=0;

317 
i
=0;i<(
num_∑ges
<(
NUM_PAGE_TABLE_ENTRIES
 - 
∑ge_ödex
)?Çum_pages : (NUM_PAGE_TABLE_ENTRIES -Öage_index));i++)

319 if(!
∑ge_íåy
->
¥e£¡
)

321 
∑ge_addr
=
	`AŒoc_PagóbÀ_Page
(
∑ge_íåy
, 
	`Round_Down_To_Page
(
°¨tAddªss
));

323 if(
∑ge_addr
==
NULL
)

325 
	`Pröt
("canÇotállocateÖage in Alloc_Pages_User/n");

328 *((
uöt_t
*)
∑ge_íåy
)=0;

329 
∑ge_íåy
->
¥e£¡
=1;

330 
∑ge_íåy
->
Êags
=
VM_WRITE
 | 
VM_READ
 | 
VM_USER
;

331 
∑ge_íåy
->
globÆPage
 = 0;

332 
∑ge_íåy
->
∑geBa£Addr
 = (
ul⁄g_t
)
∑ge_addr
>>12;

335 
	`KASSERT
(
∑ge_addr
!= 0);

336 if(
i
==0)

338 
fú°_∑ge_addr
 = (
uöt_t
Ë
∑ge_addr
;

341 
∑ge_íåy
++;

342 
°¨tAddªss
+=
PAGE_SIZE
;

344 
num_∑ges
 -(“um_∑ges<(
NUM_PAGE_TABLE_ENTRIES
 - 
∑ge_ödex
)?Çum_pages : (NUM_PAGE_TABLE_ENTRIES -Öage_index)));

345 
∑gedú_íåy
++;

346 
∑ge_ödex
 = 0;

351 
	}
}

355 
uöt_t
 
	$lö_to_phyaddr
(
pde_t
 * 
∑ge_dú
,
uöt_t
 
lö_addªss
)

357 
uöt_t
 
∑gedú_ödex
=
lö_addªss
>>22;

358 
uöt_t
 
∑ge_ödex
=(
lö_addªss
<<10)>>22;

359 
uöt_t
 
off£t_addªss
=
lö_addªss
 & 0xfff;

362 
pde_t
 * 
∑gedú_íåy
=
∑ge_dú
+
∑gedú_ödex
;

363 
±e_t
 * 
∑ge_íåy
=0;

365 if(
∑gedú_íåy
->
¥e£¡
)

367 
∑ge_íåy
=(
±e_t
*Ë((
uöt_t
)
∑gedú_íåy
->
∑geTabÀBa£Addr
 << 12);

368 
∑ge_íåy
+=
∑ge_ödex
;

370 if(
∑ge_íåy
->
¥e£¡
==0)

372 
	`Pröt
("theÖage isÇotÖresent!\n");

373 
	`Pröt
("Löó∏addªs†i†%x\n", 
lö_addªss
);

374 
	`KASSERT
(0);

377  (
∑ge_íåy
->
∑geBa£Addr
 << 12)+
off£t_addªss
;

381 
	`Pröt
("TryögÅÿªsﬁvên⁄-exi°íàaddªss%u/n", 
lö_addªss
);

384 
	}
}

387 
boﬁ
 
	$C›y_Pages_U£r
(
pde_t
 * 
∑ge_dú
, 
uöt_t
 
de°_u£r
, * 
§c
, uöt_à
byã_num
)

389 
uöt_t
 
phyMemSèπ
;

390 
uöt_t
 
ãmp_Àngth
;

391 
∑ge_nums
;

392 
Page
 * 
∑ge
;

394 if(
byã_num
==0) {

395  
åue
;

398 if(
	`Round_Down_To_Page
(
de°_u£r
+
byã_num
) == Round_Down_To_Page(dest_user))

400 
ãmp_Àngth
=
byã_num
;

401 
∑ge_nums
=1;

405 
ãmp_Àngth
=
	`Round_Up_To_Page
(
de°_u£r
)-dest_user;

406 
byã_num
-=
ãmp_Àngth
;

407 
∑ge_nums
=0;

409 
phyMemSèπ
=
	`lö_to_phyaddr
(
∑ge_dú
, 
de°_u£r
);

410 if(
phyMemSèπ
==0)

412 
	`Pröt
("Error! LinearÅoÖhysical memoryÅransformationÇotÖossible.\n");

413  
Ál£
;

415 
∑ge
 = 
	`Gë_Page
(
phyMemSèπ
);

417 
	`DißbÀ_I¡îru±s
();

418 
∑ge
->
Êags
 &~ 
PAGE_PAGEABLE
;

419 
	`E«bÀ_I¡îru±s
();

421 
	`mem˝y
((*)
phyMemSèπ
, 
§c
, 
ãmp_Àngth
);

422 
∑ge
->
Êags
 |
PAGE_PAGEABLE
;

424 if(
∑ge_nums
 == 1)

426  
åue
;

431 
de°_u£r
+=
ãmp_Àngth
;

432 
§c
+=
ãmp_Àngth
;

435 
de°_u£r
!=
	`Round_Down_To_Page
(de°_u£∏+ 
byã_num
))

438 
phyMemSèπ
=
	`lö_to_phyaddr
(
∑ge_dú
,
de°_u£r
);

439 if(
phyMemSèπ
 == 0)

441 
	`Pröt
("Error! LinearÅoÖhysical memoryÅransformationÇotÖossible.\n");

442  
Ál£
;

444 
∑ge
 = 
	`Gë_Page
(
phyMemSèπ
);

446 
	`DißbÀ_I¡îru±s
();

447 
∑ge
->
Êags
 &~ 
PAGE_PAGEABLE
;

448 
	`E«bÀ_I¡îru±s
();

450 
	`mem˝y
((*)
phyMemSèπ
, 
§c
, 
PAGE_SIZE
);

451 
∑ge
->
Êags
 |
PAGE_PAGEABLE
;

453 
de°_u£r
+=
PAGE_SIZE
;

454 
byã_num
-=
PAGE_SIZE
;

455 
§c
+=
PAGE_SIZE
;

459 
phyMemSèπ
 = 
	`lö_to_phyaddr
(
∑ge_dú
, 
de°_u£r
);

460 if(
phyMemSèπ
==0)

462 
	`Pröt
("Error! LinearÅoÖhysical memoryÅransformationÇotÖossible.\n");

463  
Ál£
;

466 
	`DißbÀ_I¡îru±s
();

467 
∑ge
->
Êags
 &~ 
PAGE_PAGEABLE
;

468 
	`E«bÀ_I¡îru±s
();

470 
	`mem˝y
((*)
phyMemSèπ
, 
§c
, 
byã_num
);

471 
∑ge
->
Êags
 |
PAGE_PAGEABLE
;

472  
åue
;

473 
	}
}

494 
	$Lﬂd_U£r_Progøm
(*
exeFûeD©a
, 
ul⁄g_t
 
exeFûeLígth
,

495 
Exe_F‹m©
 *
exeF‹m©
, c⁄° *
comm™d
,

496 
U£r_C⁄ãxt
 **
pU£rC⁄ãxt
) {

507 
i
,
ªs
;

508 
ul⁄g_t
 
maxva
 = 0;

509 
numArgs
;

511 
ul⁄g_t
 
size
, 
¨gBlockAddr
, 
¨gBlockSize
;

512 
U£r_C⁄ãxt
 *
u£rC⁄ãxt
 = 0;

513 
pde_t
* 
∑geDúe˘‹y
;

514 
uöt_t
 
°ack_addr
, 
¨g_addr
;

516 
i
 = 0; i < 
exeF‹m©
->
numSegmíts
; ++i) {

517 
Exe_Segmít
 *
£gmít
 = &
exeF‹m©
->
£gmítLi°
[
i
];

518 
ul⁄g_t
 
t›va
 = 
£gmít
->
°¨tAddªss
 + segmít->
sizeInMem‹y
;

520 i‡(
t›va
 > 
maxva
)

521 
maxva
 = 
t›va
;

525 
	`Gë_Argumít_Block_Size
(
comm™d
, &
numArgs
, &
¨gBlockSize
);

532 
size
 = 
	`Round_Up_To_Page
(
maxva
Ë+ 
DEFAULT_USER_STACK_SIZE
;

533 
¨gBlockAddr
 = 
size
;

534 
size
 +
¨gBlockSize
;

537 if(
size
>
USER_VM_SIZE
) {

538 
	`Pröt
("Falling short ofÖhysical memory :(");

543 
u£rC⁄ãxt
 = 
	`Cª©e_U£r_C⁄ãxt
(
size
);

544 i‡(
u£rC⁄ãxt
 == 0)

546 
∑geDúe˘‹y
=
u£rC⁄ãxt
->
∑geDú
;

548 
i
=0; i<
exeF‹m©
->
numSegmíts
; i++)

551 
ªs
=
	`AŒoc_Pages_U£r
(
∑geDúe˘‹y
,
exeF‹m©
->
£gmítLi°
[
i
].
°¨tAddªss
+
USER_VM_START
,exeF‹m©->£gmítLi°[i].
sizeInMem‹y
);

552 if(
ªs
!=0)

554 
	`Pröt
("Page cant beállocated for copyingÅhe segment\n");

561 
i
=0; i<
exeF‹m©
->
numSegmíts
; i++)

565 
ªs
=
	`C›y_Pages_U£r
(
∑geDúe˘‹y
,
exeF‹m©
->
£gmítLi°
[
i
].
°¨tAddªss
+
USER_VM_START
,
exeFûeD©a
+exeF‹m©->£gmítLi°[i].
off£tInFûe
,exeF‹m©->£gmítLi°[i].
ÀngthInFûe
);

566 if(
ªs
!=
åue
)

568 
	`Pröt
("Segment Copy Failed\n");

574 if(
¨gBlockSize
 > 
PAGE_SIZE
)

576 
	`Pröt
("Argument Block isÅoo big/n");

580 
ul⁄g_t
 
USER_VM_LEN
 = 
	`Round_Up_To_Page
(
size
);

581 
¨g_addr
=
	`Round_Down_To_Page
(
USER_VM_LEN
-
¨gBlockSize
);

582 
	`DißbÀ_I¡îru±s
();

583 * 
block_buf
=
	`MÆloc
(
¨gBlockSize
);

584 
	`E«bÀ_I¡îru±s
();

585 
	`KASSERT
(
block_buf
!=
NULL
);

586 
	`F‹m©_Argumít_Block
(
block_buf
,
numArgs
,
¨g_addr
,
comm™d
);

588 
ªs
=
	`AŒoc_Pages_U£r
(
∑geDúe˘‹y
, 
¨g_addr
+
USER_VM_START
, 
¨gBlockSize
);

589 if(
ªs
!=0)

593 
ªs
=
	`C›y_Pages_U£r
(
∑geDúe˘‹y
, 
¨g_addr
+
USER_VM_START
, 
block_buf
,
¨gBlockSize
);

594 if(
ªs
!=
åue
)

598 
	`DißbÀ_I¡îru±s
();

599 
	`Fªe
(
block_buf
);

600 
	`E«bÀ_I¡îru±s
();

602 
°ack_addr
=
USER_VM_LEN
-
	`Round_Up_To_Page
(
¨gBlockSize
)-
DEFAULT_USER_STACK_SIZE
;

603 
ªs
=
	`AŒoc_Pages_U£r
(
∑geDúe˘‹y
,
°ack_addr
+
USER_VM_START
,
DEFAULT_USER_STACK_SIZE
);

604 if(
ªs
!=0)

609 
u£rC⁄ãxt
->
¨gBlockAddr
 = 
¨g_addr
;

610 
u£rC⁄ãxt
->
°ackPoöãrAddr
 = 
¨g_addr
;

611 
u£rC⁄ãxt
->
íåyAddr
 = 
exeF‹m©
->entryAddr;

612 
u£rC⁄ãxt
->
size
 = 
USER_VM_LEN
;

614 *
pU£rC⁄ãxt
 = 
u£rC⁄ãxt
;

618 
	}
}

624 
boﬁ
 
	$C›y_From_U£r
(*
de°InKî√l
, 
ul⁄g_t
 
§cInU£r
, ul⁄g_à
numByãs
) {

643 * 
u£r_addªss
=(*)(
USER_VM_START
)+
§cInU£r
;

644 
U£r_C⁄ãxt
* 
u£rC⁄ãxt
=
CURRENT_THREAD
->userContext;

647 if((
§cInU£r
+
numByãs
Ë< 
u£rC⁄ãxt
->
size
)

649 
	`mem˝y
(
de°InKî√l
, 
u£r_addªss
, 
numByãs
);

650  
åue
;

652  
Ál£
;

655 
	}
}

661 
boﬁ
 
	$C›y_To_U£r
(
ul⁄g_t
 
de°InU£r
, *
§cInKî√l
, ul⁄g_à
numByãs
) {

669 * 
u£r_addªss
 = (*)(
USER_VM_START
Ë+ 
de°InU£r
;

670 
U£r_C⁄ãxt
* 
u£rC⁄ãxt
=
CURRENT_THREAD
->userContext;

671 if((
de°InU£r
+
numByãs
Ë< 
u£rC⁄ãxt
->
size
)

673 
	`mem˝y
(
u£r_addªss
, 
§cInKî√l
 ,
numByãs
);

674  
åue
;

676  
Ál£
;

678 
	}
}

684 
boﬁ
 
	$C›y_U£r_To_U£r
(*
de°InU£r
, 
ul⁄g_t
 
§cInU£r
, ul⁄g_à
numByãs
) {

703 
	`TODO_P
(
PROJECT_VIRTUAL_MEMORY_A
, "Copy user dataÅo kernel buffer");

704  
åue
;

705 
	}
}

712 
	$Swôch_To_Addªss_S∑˚
(
U£r_C⁄ãxt
 *
u£rC⁄ãxt
) {

718 if(
u£rC⁄ãxt
 == 0)

720 
	`Pröt
("Null User Context/n");

723 
	`Së_PDBR
((*)
u£rC⁄ãxt
->
∑geDú
);

724 
ush‹t_t
 
ldtSñe˘‹
;

725 
ldtSñe˘‹
 = 
u£rC⁄ãxt
->ldtSelector;

726 
__asm__
 
	`__vﬁ©ûe__
("Œdà%0"::"a"(
ldtSñe˘‹
)

729 
	}
}

	@vfs.c

18 
	~<gìkos/î∫o.h
>

19 
	~<gìkos/li°.h
>

20 
	~<gìkos/°rög.h
>

21 
	~<gìkos/s¸ìn.h
>

22 
	~<gìkos/mÆloc.h
>

23 
	~<gìkos/synch.h
>

24 
	~<gìkos/vfs.h
>

25 
	~<gìkos/¥oje˘s.h
>

42 
Muãx
 
	gs_vfsLock
;

44 
	gdebugVFS
 = 0;

45 
	#Debug
(
¨gs
...Ëi‡(
debugVFS
Ë
	`Pröt
("VFS: "árgs)

	)

47 
	gFûesy°em
;

49 
DEFINE_LIST
(
Mou¡_Poöt_Li°
, 
Mou¡_Poöt
);

50 
IMPLEMENT_LIST
(
Mou¡_Poöt_Li°
, 
Mou¡_Poöt
);

53 
Mou¡_Poöt_Li°
 
	gs_mou¡PoötLi°
;

56 
	sFûesy°em
 {

57 
Fûesy°em_Ops
 *
	m›s
;

58 
	mfsName
[
VFS_MAX_FS_NAME_LEN
 + 1];

59 
DEFINE_LINK
(
Fûesy°em_Li°
, 
Fûesy°em
);

62 
DEFINE_LIST
(
Fûesy°em_Li°
, 
Fûesy°em
);

63 
IMPLEMENT_LIST
(
Fûesy°em_Li°
, 
Fûesy°em
);

66 
Fûesy°em_Li°
 
	gs_fûesy°emLi°
;

69 
Pagög_Devi˚
 *
	gs_∑gögDevi˚
;

71 
	#MAX_PREFIX_LEN
 16

	)

84 
boﬁ
 
	$U≈ack_P©h
(c⁄° *
∑th
, *
¥efix
, c⁄° **
pSuffix
) {

85 *
¶ash
;

86 
size_t
 
pfxLí
;

88 
	`Debug
("∑th=%s\n", 
∑th
);

91 i‡(*
∑th
 != '/')

92  
Ál£
;

93 ++
∑th
;

96 
¶ash
 = 
	`°rchr
(
∑th
, '/');

97 i‡(
¶ash
 == 0) {

103 
pfxLí
 = 
	`°æí
(
∑th
);

104 i‡(
pfxLí
 =0 ||ÖfxLí > 
MAX_PREFIX_LEN
)

105  
Ál£
;

106 
	`°r˝y
(
¥efix
, 
∑th
);

107 *
pSuffix
 = "/";

113 
pfxLí
 = 
¶ash
 - 
∑th
;

114 i‡(
pfxLí
 =0 ||ÖfxLí > 
MAX_PREFIX_LEN
)

115  
Ál£
;

118 
	`mem˝y
(
¥efix
, 
∑th
, 
pfxLí
);

119 
¥efix
[
pfxLí
] = '\0';

125 *
pSuffix
 = 
¶ash
;

128 
	`Debug
("¥efix=%s, suffix=%s\n", 
¥efix
, *
pSuffix
);

129 
	`KASSERT
(**
pSuffix
 == '/');

131  
åue
;

132 
	}
}

141 
Fûesy°em
 *
	$Lookup_Fûesy°em
(c⁄° *
f°y≥
) {

142 
Fûesy°em
 *
fs
;

144 
	`Muãx_Lock
(&
s_vfsLock
);

145 
fs
 = 
	`Gë_Fr⁄t_Of_Fûesy°em_Li°
(&
s_fûesy°emLi°
);

146 
fs
 != 0) {

147 i‡(
	`°rcmp
(
fs
->
fsName
, 
f°y≥
) == 0)

149 
fs
 = 
	`Gë_Next_In_Fûesy°em_Li°
(fs);

151 
	`Muãx_U∆ock
(&
s_vfsLock
);

153  
fs
;

154 
	}
}

162 
Mou¡_Poöt
 *
	$Lookup_Mou¡_Poöt
(c⁄° *
¥efix
) {

163 
Mou¡_Poöt
 *
mou¡Poöt
;

165 
	`Muãx_Lock
(&
s_vfsLock
);

168 
mou¡Poöt
 = 
	`Gë_Fr⁄t_Of_Mou¡_Poöt_Li°
(&
s_mou¡PoötLi°
);

169 
mou¡Poöt
 != 0) {

170 
	`Debug
("Looku∞mou¡Öoöt: %s,%s\n", 
¥efix
, 
mou¡Poöt
->
∑thPªfix
);

171 i‡(
	`°rcmp
(
¥efix
, 
mou¡Poöt
->
∑thPªfix
) == 0)

173 
mou¡Poöt
 = 
	`Gë_Next_In_Mou¡_Poöt_Li°
(mountPoint);

176 
	`Muãx_U∆ock
(&
s_vfsLock
);

178  
mou¡Poöt
;

179 
	}
}

184 
Do_O≥n
(c⁄° *
∑th
, 
mode
, 
Fûe
 **
pFûe
,

185 (*
›íFunc
Ë(
Mou¡_Poöt
 * 
mou¡Poöt
,

186 c⁄° *
∑th
, 
mode
,

187 
Fûe
 ** 
pFûe
)) {

188 
¥efix
[
MAX_PREFIX_LEN
 + 1];

189 c⁄° *
suffix
;

190 
Mou¡_Poöt
 *
mou¡Poöt
;

191 
rc
;

193 i‡(!
	`U≈ack_P©h
(
∑th
, 
¥efix
, &
suffix
))

194  
ENOTFOUND
;

197 
mou¡Poöt
 = 
	`Lookup_Mou¡_Poöt
(
¥efix
);

198 i‡(
mou¡Poöt
 == 0)

199  
ENOTFOUND
;

202 
rc
 = 
	`›íFunc
(
mou¡Poöt
, 
suffix
, 
mode
, 
pFûe
);

203 i‡(
rc
 == 0) {

205 (*
pFûe
)->
mode
 = mode;

206 (*
pFûe
)->
mou¡Poöt
 = mountPoint;

208  
rc
;

209 
	}
}

214 
	$Do_O≥n_Fûe
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

215 
mode
, 
Fûe
 **
pFûe
) {

216 
	`KASSERT
(
mou¡Poöt
->
›s
->
O≥n
 != 0);

217  
mou¡Poöt
->
›s
->
	`O≥n
(mou¡Poöt, 
∑th
, 
mode
, 
pFûe
);

218 
	}
}

223 
Do_O≥n_Dúe˘‹y
(
Mou¡_Poöt
 *
mou¡Poöt
, c⁄° *
∑th
,

224 
mode


225 
__©åibuã__
 ((
unu£d
)), 
Fûe
 **
pDú
) {

226 
KASSERT
(
mou¡Poöt
->
›s
->
O≥n_Dúe˘‹y
 != 0);

227  
	gmou¡Poöt
->
	g›s
->
O≥n_Dúe˘‹y
(
mou¡Poöt
, 
∑th
, 
pDú
);

243 
boﬁ
 
	$Regi°î_Fûesy°em
(c⁄° *
fsName
, 
Fûesy°em_Ops
 * 
fsOps
) {

244 
Fûesy°em
 *
fs
;

246 
	`KASSERT
(
fsName
 != 0);

247 
	`KASSERT
(
fsOps
 != 0);

248 
	`KASSERT
(
fsOps
->
Mou¡
 != 0);

250 
	`Debug
("Regi°îög %†fûesy°emÅy≥\n", 
fsName
);

253 
fs
 = (
Fûesy°em
 *)
	`MÆloc
((*fs));

254 i‡(
fs
 == 0)

255  
Ál£
;

258 
fs
->
›s
 = 
fsOps
;

259 
	`°∫˝y
(
fs
->
fsName
, fsName, 
VFS_MAX_FS_NAME_LEN
);

260 
fs
->
fsName
[
VFS_MAX_FS_NAME_LEN
] = '\0';

263 
	`Muãx_Lock
(&
s_vfsLock
);

264 
	`Add_To_Back_Of_Fûesy°em_Li°
(&
s_fûesy°emLi°
, 
fs
);

265 
	`Muãx_U∆ock
(&
s_vfsLock
);

267  
åue
;

268 
	}
}

277 
	$F‹m©
(c⁄° *
dev«me
, c⁄° *
f°y≥
) {

278 
Fûesy°em
 *
fs
;

279 
Block_Devi˚
 *
dev
 = 0;

280 
rc
;

283 
fs
 = 
	`Lookup_Fûesy°em
(
f°y≥
);

284 i‡(
fs
 == 0)

285  
ENOFILESYS
;

286 
	`Debug
("Found %†fûesy°emÅy≥\n", 
f°y≥
);

289 i‡(
fs
->
›s
->
F‹m©
 == 0)

290  
EUNSUPPORTED
;

293 i‡((
rc
 = 
	`O≥n_Block_Devi˚
(
dev«me
, &
dev
)) < 0)

294  
rc
;

295 
	`Debug
("O≥√d devi˚ %s\n", 
dev
->
«me
);

298 
rc
 = 
fs
->
›s
->
	`F‹m©
(
dev
);

300 
	`Clo£_Block_Devi˚
(
dev
);

302  
rc
;

303 
	}
}

313 
	$Mou¡
(c⁄° *
dev«me
, c⁄° *
∑thPªfix
, c⁄° *
f°y≥
) {

314 
Fûesy°em
 *
fs
;

315 
Block_Devi˚
 *
dev
 = 0;

316 
Mou¡_Poöt
 *
mou¡Poöt
 = 0;

317 
rc
;

320 *
∑thPªfix
 == '/')

321 ++
∑thPªfix
;

323 i‡(
	`°æí
(
∑thPªfix
Ë> 
MAX_PREFIX_LEN
)

324  
ENAMETOOLONG
;

327 
fs
 = 
	`Lookup_Fûesy°em
(
f°y≥
);

328 i‡(
fs
 == 0)

329  
ENOFILESYS
;

330 
	`KASSERT
(
fs
->
›s
->
Mou¡
 != 0);

333 i‡((
rc
 = 
	`O≥n_Block_Devi˚
(
dev«me
, &
dev
)) < 0) {

334 
	`Pröt
("O≥n_Block_Devi˚: U«bÀÅÿ›í %s\n", 
dev«me
);

335  
rc
;

339 
mou¡Poöt
 = (
Mou¡_Poöt
 *)
	`MÆloc
((*mountPoint));

340 i‡(
mou¡Poöt
 == 0)

341 
memÁû
;

342 
	`mem£t
(
mou¡Poöt
, '\0', (*mountPoint));

343 
mou¡Poöt
->
dev
 = dev;

344 
mou¡Poöt
->
∑thPªfix
 = 
	`°rdup
(pathPrefix);

345 i‡(
mou¡Poöt
->
∑thPªfix
 == 0)

346 
memÁû
;

348 
	`Debug
("Mou¡ög %†⁄ %†usög %†fs\n", 
dev«me
, 
∑thPªfix
, 
f°y≥
);

351 i‡((
rc
 = 
fs
->
›s
->
	`Mou¡
(
mou¡Poöt
)) < 0)

352 
Áû
;

354 
	`Debug
("Mount succeeded!\n");

362 
	`Muãx_Lock
(&
s_vfsLock
);

363 
	`Add_To_Back_Of_Mou¡_Poöt_Li°
(&
s_mou¡PoötLi°
, 
mou¡Poöt
);

364 
	`Muãx_U∆ock
(&
s_vfsLock
);

368 
memÁû
:

369 
rc
 = 
ENOMEM
;

370 
Áû
:

371 i‡(
mou¡Poöt
 != 0) {

372 i‡(
mou¡Poöt
->
∑thPªfix
 != 0)

373 
	`Fªe
(
mou¡Poöt
->
∑thPªfix
);

374 
	`Fªe
(
mou¡Poöt
);

376 i‡(
dev
 != 0)

377 
	`Clo£_Block_Devi˚
(
dev
);

378  
rc
;

379 
	}
}

389 
	$O≥n
(c⁄° *
∑th
, 
mode
, 
Fûe
 **
pFûe
) {

390 
rc
 = 
	`Do_O≥n
(
∑th
, 
mode
, 
pFûe
, &
Do_O≥n_Fûe
);

392  
rc
;

393 
	}
}

403 
	$Clo£
(
Fûe
 *
fûe
) {

404 
rc
;

406 
	`KASSERT
(
fûe
->
›s
->
Clo£
 != 0);

408 
	`TODO_P
(
PROJECT_FORK
, "ManageÑeference count");

410 
rc
 = 
fûe
->
›s
->
	`Clo£
(file);

411 i‡(
rc
 == 0)

412 
	`Fªe
(
fûe
);

413  
rc
;

414 
	}
}

423 
	$Sèt
(c⁄° *
∑th
, 
VFS_Fûe_Sèt
 *
°©
) {

424 
¥efix
[
MAX_PREFIX_LEN
 + 1];

425 c⁄° *
suffix
;

426 
Mou¡_Poöt
 *
mou¡Poöt
;

428 i‡(!
	`U≈ack_P©h
(
∑th
, 
¥efix
, &
suffix
))

429  
ENOTFOUND
;

432 
	`Debug
("Sèt:Üooku∞mou¡Öoöàf‹ %s\n", 
¥efix
);

433 
mou¡Poöt
 = 
	`Lookup_Mou¡_Poöt
(
¥efix
);

434 i‡(
mou¡Poöt
 == 0)

435  
ENOTFOUND
;

437 
	`Debug
("Stat: found mountÖoint, dispatchingÅo filesystem\n");

438 i‡(
mou¡Poöt
->
›s
->
Sèt
 == 0)

439  
EUNSUPPORTED
;

441  
mou¡Poöt
->
›s
->
	`Sèt
(mou¡Poöt, 
suffix
, 
°©
);

442 
	}
}

448 
	$Sync
() {

449 
rc
 = 0;

450 
Mou¡_Poöt
 *
mou¡Poöt
;

452 
	`Muãx_Lock
(&
s_vfsLock
);

453 
mou¡Poöt
 = 
	`Gë_Fr⁄t_Of_Mou¡_Poöt_Li°
(&
s_mou¡PoötLi°
);

454 
mou¡Poöt
 != 0;

455 
mou¡Poöt
 = 
	`Gë_Next_In_Mou¡_Poöt_Li°
(mountPoint)) {

456 
	`KASSERT
(
mou¡Poöt
->
›s
->
Sync
 != 0);

457 
rc
 = 
mou¡Poöt
->
›s
->
	`Sync
(mountPoint);

458 i‡(
rc
 != 0)

461 
	`Muãx_U∆ock
(&
s_vfsLock
);

463  
rc
;

464 
	}
}

478 
Fûe
 *
	$AŒoˇã_Fûe
(
Fûe_Ops
 *
›s
, 
fûePos
, 
ídPos
,

479 *
fsD©a
, 
mode
,

480 
Mou¡_Poöt
 *
mou¡Poöt
) {

481 
Fûe
 *
fûe
;

483 
fûe
 = (
Fûe
 *)
	`MÆloc
((File));

484 i‡(
fûe
 != 0) {

485 
fûe
->
›s
 = ops;

486 
fûe
->
fûePos
 = filePos;

487 
fûe
->
ídPos
 =ÉndPos;

488 
fûe
->
fsD©a
 = fsData;

489 
fûe
->
mode
 = mode;

490 
fûe
->
mou¡Poöt
 = mountPoint;

492  
fûe
;

493 
	}
}

502 
	$FSèt
(
Fûe
 *
fûe
, 
VFS_Fûe_Sèt
 *
°©
) {

503 i‡(
fûe
->
›s
->
FSèt
 == 0)

504  
EUNSUPPORTED
;

506  
fûe
->
›s
->
	`FSèt
(fûe, 
°©
);

507 
	}
}

518 
	$Ród
(
Fûe
 *
fûe
, *
buf
, 
ul⁄g_t
 
Àn
) {

519 i‡(
fûe
->
›s
->
Ród
 == 0)

520  
EUNSUPPORTED
;

522  
fûe
->
›s
->
	`Ród
(fûe, 
buf
, 
Àn
);

523 
	}
}

533 
	$Wrôe
(
Fûe
 *
fûe
, *
buf
, 
ul⁄g_t
 
Àn
) {

534 i‡(
fûe
->
›s
->
Wrôe
 == 0)

535  
EUNSUPPORTED
;

537  
fûe
->
›s
->
	`Wrôe
(fûe, 
buf
, 
Àn
);

538 
	}
}

548 
	$Sìk
(
Fûe
 *
fûe
, 
ul⁄g_t
 
Àn
) {

549 i‡(
fûe
->
›s
->
Sìk
 == 0)

550  
EUNSUPPORTED
;

552  
fûe
->
›s
->
	`Sìk
(fûe, 
Àn
);

553 
	}
}

565 
	$Ród_FuŒy
(c⁄° *
∑th
, **
pBuf„r
, 
ul⁄g_t
 * 
pLí
) {

566 
Fûe
 *
fûe
 = 0;

567 
VFS_Fûe_Sèt
 
°©
;

568 
rc
;

569 *
buf
 = 0;

570 
numByãsRód
;

572 i‡((
rc
 = 
	`Sèt
(
∑th
, &
°©
)Ë< 0 || (r¯
	`O≥n
’©h, 
O_READ
, &
fûe
)) < 0)

573 
Áû
;

574 i‡(
°©
.
size
 < 0) {

575 
rc
 = 
ENOTFOUND
;

576 
Áû
;

579 
buf
 = (*)
	`MÆloc
(
°©
.
size
);

580 i‡(
buf
 == 0)

581 
memÁû
;

584 
numByãsRód
 = 0;

585 
numByãsRód
 < 
°©
.
size
) {

586 
rc
 = 
	`Ród
(
fûe
, 
buf
 + 
numByãsRód
, 
°©
.
size
 -ÇumBytesRead);

587 i‡(
rc
 < 0)

588 
Áû
;

589 
numByãsRód
 +
rc
;

593 
	`Clo£
(
fûe
);

594 *
pBuf„r
 = (*)
buf
;

595 *
pLí
 = 
°©
.
size
;

598 
memÁû
:

599 
rc
 = 
ENOMEM
;

600 
Áû
:

601 i‡(
fûe
 != 0)

602 
	`Clo£
(
fûe
);

603 i‡(
buf
 != 0)

604 
	`Fªe
(
buf
);

605  
rc
;

606 
	}
}

614 
	$Cª©e_Dúe˘‹y
(c⁄° *
∑th
) {

615 
¥efix
[
MAX_PREFIX_LEN
 + 1];

616 c⁄° *
suffix
;

617 
Mou¡_Poöt
 *
mou¡Poöt
;

620 i‡(!
	`U≈ack_P©h
(
∑th
, 
¥efix
, &
suffix
))

621  
ENOTFOUND
;

624 
mou¡Poöt
 = 
	`Lookup_Mou¡_Poöt
(
¥efix
);

625 i‡(
mou¡Poöt
 == 0)

626  
ENOTFOUND
;

628 i‡(
mou¡Poöt
->
›s
->
Cª©e_Dúe˘‹y
 == 0)

629  
EUNSUPPORTED
;

631  
mou¡Poöt
->
›s
->
	`Cª©e_Dúe˘‹y
(mou¡Poöt, 
suffix
);

632 
	}
}

641 
	$Dñëe
(c⁄° *
∑th
, 
boﬁ
 
ªcursive
) {

642 
¥efix
[
MAX_PREFIX_LEN
 + 1];

643 c⁄° *
suffix
;

644 
Mou¡_Poöt
 *
mou¡Poöt
;

647 i‡(!
	`U≈ack_P©h
(
∑th
, 
¥efix
, &
suffix
))

648  
ENOTFOUND
;

651 
mou¡Poöt
 = 
	`Lookup_Mou¡_Poöt
(
¥efix
);

652 i‡(
mou¡Poöt
 == 0)

653  
ENOTFOUND
;

655 i‡(
mou¡Poöt
->
›s
->
Dñëe
 == 0)

656  
EUNSUPPORTED
;

658  
mou¡Poöt
->
›s
->
	`Dñëe
(mou¡Poöt, 
suffix
, 
ªcursive
);

659 
	}
}

669 
	$Ríame
(c⁄° *
ﬁd∑th
, c⁄° *
√w∑th
) {

670 
¥efix1
[
MAX_PREFIX_LEN
 + 1];

671 
¥efix2
[
MAX_PREFIX_LEN
 + 1];

672 c⁄° *
suffix1
;

673 c⁄° *
suffix2
;

674 
Mou¡_Poöt
 *
mou¡Poöt1
;

675 
Mou¡_Poöt
 *
mou¡Poöt2
;

679 i‡(!
	`U≈ack_P©h
(
ﬁd∑th
, 
¥efix1
, &
suffix1
))

680  
ENOTFOUND
;

683 
mou¡Poöt1
 = 
	`Lookup_Mou¡_Poöt
(
¥efix1
);

684 i‡(
mou¡Poöt1
 == 0)

685  
ENOTFOUND
;

687 i‡(
mou¡Poöt1
->
›s
->
Ríame
 == 0)

688  
EUNSUPPORTED
;

691 i‡(!
	`U≈ack_P©h
(
√w∑th
, 
¥efix2
, &
suffix2
))

692  
ENOTFOUND
;

694 
mou¡Poöt2
 = 
	`Lookup_Mou¡_Poöt
(
¥efix2
);

696 i‡(
mou¡Poöt1
 !
mou¡Poöt2
)

697  
EINVALID
;

699  
mou¡Poöt1
->
›s
->
	`Ríame
(mou¡Poöt1, 
suffix1
, 
suffix2
);

700 
	}
}

709 
	$Lök
(c⁄° *
ﬁd∑th
, c⁄° *
√w∑th
) {

710 
¥efix1
[
MAX_PREFIX_LEN
 + 1];

711 
¥efix2
[
MAX_PREFIX_LEN
 + 1];

712 c⁄° *
suffix1
;

713 c⁄° *
suffix2
;

714 
Mou¡_Poöt
 *
mou¡Poöt1
;

715 
Mou¡_Poöt
 *
mou¡Poöt2
;

719 i‡(!
	`U≈ack_P©h
(
ﬁd∑th
, 
¥efix1
, &
suffix1
))

720  
ENOTFOUND
;

723 
mou¡Poöt1
 = 
	`Lookup_Mou¡_Poöt
(
¥efix1
);

724 i‡(
mou¡Poöt1
 == 0)

725  
ENOTFOUND
;

727 i‡(
mou¡Poöt1
->
›s
->
Lök
 == 0)

728  
EUNSUPPORTED
;

731 i‡(!
	`U≈ack_P©h
(
√w∑th
, 
¥efix2
, &
suffix2
))

732  
ENOTFOUND
;

734 
mou¡Poöt2
 = 
	`Lookup_Mou¡_Poöt
(
¥efix2
);

736 i‡(
mou¡Poöt1
 !
mou¡Poöt2
)

737  
EINVALID
;

739  
mou¡Poöt1
->
›s
->
	`Lök
(mou¡Poöt1, 
suffix1
, 
suffix2
);

740 
	}
}

749 
	$SymLök
(c⁄° *
ﬁd∑th
, c⁄° *
√w∑th
) {

750 
¥efix2
[
MAX_PREFIX_LEN
 + 1];

751 c⁄° *
suffix2
;

752 
Mou¡_Poöt
 *
mou¡Poöt2
;

755 i‡(!
	`U≈ack_P©h
(
√w∑th
, 
¥efix2
, &
suffix2
))

756  
ENOTFOUND
;

758 
mou¡Poöt2
 = 
	`Lookup_Mou¡_Poöt
(
¥efix2
);

760 i‡(
mou¡Poöt2
->
›s
->
SymLök
 == 0)

761  
EUNSUPPORTED
;

763  
mou¡Poöt2
->
›s
->
	`SymLök
(mou¡Poöt2, 
ﬁd∑th
, 
suffix2
);

764 
	}
}

772 
	$SëSëUid
(c⁄° *
∑th
, 
£tUid
) {

773 
	`TODO_P
(
PROJECT_USER
, "virtual file system system SetSetUid");

774  
EUNSUPPORTED
;

775 
	}
}

784 
	$SëA˛
(c⁄° *
∑th
, 
u£r
, 
≥rmissi⁄s
) {

785 
	`TODO_P
(
PROJECT_USER
, "virtual file system system SetAcl");

786  
EUNSUPPORTED
;

787 
	}
}

796 
	$O≥n_Dúe˘‹y
(c⁄° *
∑th
, 
Fûe
 **
pDú
) {

797  
	`Do_O≥n
(
∑th
, 0, 
pDú
, &
Do_O≥n_Dúe˘‹y
);

798 
	}
}

807 
	$Ród_E¡ry
(
Fûe
 *
fûe
, 
VFS_Dú_E¡ry
 *
íåy
) {

808 i‡(
fûe
->
›s
->
Ród_E¡ry
 == 0)

809  
EUNSUPPORTED
;

811  
fûe
->
›s
->
	`Ród_E¡ry
(fûe, 
íåy
);

812 
	}
}

823 
	$Disk_Pr›îtõs
(c⁄° *
∑th
,

824 *
block_size
,

825 *
blocks_ö_fûesy°em
) {

826 
¥efix
[
MAX_PREFIX_LEN
 + 1];

827 c⁄° *
suffix
;

828 
Mou¡_Poöt
 *
mou¡Poöt
;

831 i‡(!
	`U≈ack_P©h
(
∑th
, 
¥efix
, &
suffix
))

832  
ENOTFOUND
;

835 
mou¡Poöt
 = 
	`Lookup_Mou¡_Poöt
(
¥efix
);

836 i‡(
mou¡Poöt
 == 0)

837  
ENOTFOUND
;

839 i‡(
mou¡Poöt
->
›s
->
Disk_Pr›îtõs
 == 0)

840  
EUNSUPPORTED
;

842  
mou¡Poöt
->
›s
->
	`Disk_Pr›îtõs
(mou¡Poöt, 
block_size
,

843 
blocks_ö_fûesy°em
);

844 
	}
}

849 
	$Regi°î_Pagög_Devi˚
(
Pagög_Devi˚
 *
∑gögDevi˚
) {

850 
	`KASSERT
(
s_∑gögDevi˚
 == 0);

851 
	`KASSERT
(
∑gögDevi˚
 != 0);

852 
	`Pröt
("Regi°îögÖagög devi˚: %†⁄ %s\n", 
∑gögDevi˚
->
fûeName
,

853 
∑gögDevi˚
->
dev
->
«me
);

854 
s_∑gögDevi˚
 = 
∑gögDevi˚
;

855 
	}
}

861 
Pagög_Devi˚
 *
	$Gë_Pagög_Devi˚
() {

862  
s_∑gögDevi˚
;

863 
	}
}

865 
	$gë_time
(
x
) {

866 
x
 = x / 
NUM_BYTES_PER_TRACK
;

867 
y
 = 
x
;

868 if(
x
 > 
cuºít_åack
) {

869 
cuºít_åack
 = 
x
;

870  
x
 - 
y
;

872 
cuºít_åack
 = 
x
;

873  
y
 - 
x
;

875 
	}
}

	@/usr/include/ctype.h

23 #i‚def 
_CTYPE_H


24 
	#_CTYPE_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 
	g__BEGIN_DECLS


31 #i‚de‡
_ISbô


40 
	~<ídün.h
>

41 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


42 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

44 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

49 
	m_ISuµî
 = 
_ISbô
 (0),

50 
	m_ISlowî
 = 
_ISbô
 (1),

51 
	m_ISÆpha
 = 
_ISbô
 (2),

52 
	m_ISdigô
 = 
_ISbô
 (3),

53 
	m_ISxdigô
 = 
_ISbô
 (4),

54 
	m_IS•a˚
 = 
_ISbô
 (5),

55 
	m_IS¥öt
 = 
_ISbô
 (6),

56 
	m_ISgøph
 = 
_ISbô
 (7),

57 
	m_ISbœnk
 = 
_ISbô
 (8),

58 
	m_IS˙ål
 = 
_ISbô
 (9),

59 
	m_ISpun˘
 = 
_ISbô
 (10),

60 
	m_ISÆnum
 = 
_ISbô
 (11)

80 c⁄° **
	$__˘y≥_b_loc
 ()

81 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

82 c⁄° 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

83 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

84 c⁄° 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

85 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

88 #i‚de‡
__˝lu•lus


89 
	#__is˘y≥
(
c
, 
ty≥
) \

90 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

91 #ñi‡
deföed
 
__USE_EXTERN_INLINES


92 
	#__is˘y≥_f
(
ty≥
) \

93 
__exã∫_ölöe
 \

94 
is
##
	`ty≥
 (
__c
Ë
__THROW
 \

96  (*
	`__˘y≥_b_loc
 ())[(Ë(
__c
)] & (Ë
_IS
##
ty≥
; \

97 
	}

	)
}

100 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

101 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

103 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

105 
__BEGIN_NAMESPACE_STD


111 
__ex˘y≥
 (
iß um
);

112 
__ex˘y≥
 (
ißÕha
);

113 
__ex˘y≥
 (
is˙ål
);

114 
__ex˘y≥
 (
isdigô
);

115 
__ex˘y≥
 (
i¶owî
);

116 
__ex˘y≥
 (
isgøph
);

117 
__ex˘y≥
 (
i•röt
);

118 
__ex˘y≥
 (
i•un˘
);

119 
__ex˘y≥
 (
is•a˚
);

120 
__ex˘y≥
 (
isuµî
);

121 
__ex˘y≥
 (
isxdigô
);

125 
	$tﬁowî
 (
__c
Ë
__THROW
;

128 
	$touµî
 (
__c
Ë
__THROW
;

130 
__END_NAMESPACE_STD


134 #ifdef 
__USE_ISOC99


135 
__BEGIN_NAMESPACE_C99


137 
	`__ex˘y≥
 (
isbœnk
);

139 
__END_NAMESPACE_C99


142 #ifde‡
__USE_GNU


144 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

147 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


151 
	$ißscii
 (
__c
Ë
__THROW
;

155 
	$tﬂscii
 (
__c
Ë
__THROW
;

159 
	`__ex˘y≥
 (
_touµî
);

160 
	`__ex˘y≥
 (
_tﬁowî
);

164 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

165 (
__exãnsi⁄__
 \

166 ({ 
__ªs
; \

167 i‡( (
c
) > 1) \

169 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

171 
__c
 = (
c
); \

172 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

175 
__ªs
 = 
f
 
¨gs
; \

178 
__ªs
 = (
a
)[(Ë(
c
)]; \

179 
__ªs
; 
	}
}))

	)

181 #i‡!
deföed
 
__NO_CTYPE


182 #ifde‡
__is˘y≥_f


183 
	$__is˘y≥_f
 (
Ænum
)

184 
	$__is˘y≥_f
 (
Æpha
)

185 
	$__is˘y≥_f
 (
˙ål
)

186 
	$__is˘y≥_f
 (
digô
)

187 
	$__is˘y≥_f
 (
lowî
)

188 
	$__is˘y≥_f
 (
gøph
)

189 
	$__is˘y≥_f
 (
¥öt
)

190 
	$__is˘y≥_f
 (
pun˘
)

191 
	$__is˘y≥_f
 (
•a˚
)

192 
	$__is˘y≥_f
 (
uµî
)

193 
	$__is˘y≥_f
 (
xdigô
)

194 #ifde‡
__USE_ISOC99


195 
	$__is˘y≥_f
 (
bœnk
)

197 #ñi‡
deföed
 
__is˘y≥


198 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

199 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

200 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

201 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

202 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

203 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

204 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

205 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

206 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

207 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

208 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

209 #ifde‡
__USE_ISOC99


210 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

214 #ifde‡
__USE_EXTERN_INLINES


215 
__exã∫_ölöe
 

216 
	`__NTH
 (
	$tﬁowî
 (
__c
))

218  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

219 
	}
}

221 
__exã∫_ölöe
 

222 
__NTH
 (
	$touµî
 (
__c
))

224  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

225 
	}
}

228 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


229 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

230 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

233 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


234 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

235 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

237 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

238 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

244 #ifde‡
__USE_XOPEN2K8


258 
	~<xloˇÀ.h
>

262 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

263 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

265 
	#__ex˘y≥_l
(
«me
) \

266 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

272 
__ex˘y≥_l
 (
iß um_l
);

273 
__ex˘y≥_l
 (
ißÕha_l
);

274 
__ex˘y≥_l
 (
is˙ål_l
);

275 
__ex˘y≥_l
 (
isdigô_l
);

276 
__ex˘y≥_l
 (
i¶owî_l
);

277 
__ex˘y≥_l
 (
isgøph_l
);

278 
__ex˘y≥_l
 (
i•röt_l
);

279 
__ex˘y≥_l
 (
i•un˘_l
);

280 
__ex˘y≥_l
 (
is•a˚_l
);

281 
__ex˘y≥_l
 (
isuµî_l
);

282 
__ex˘y≥_l
 (
isxdigô_l
);

284 
__ex˘y≥_l
 (
isbœnk_l
);

288 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

289 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

292 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

293 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

295 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


296 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

297 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

298 
	#__touµî_l
(
c
, 
loˇÀ
) \

299 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

300 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

301 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

305 #i‚de‡
__NO_CTYPE


306 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

307 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

308 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

309 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

310 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

311 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

312 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

313 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

314 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

315 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

316 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

318 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

320 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


321 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

322 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

325 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

326 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

327 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

328 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

329 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

330 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

331 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

332 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

333 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

334 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

335 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

337 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

339 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


340 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

341 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

348 
__END_DECLS


	@/usr/include/limits.h

23 #i‚de‡
_LIBC_LIMITS_H_


24 
	#_LIBC_LIMITS_H_
 1

	)

26 
	~<„©uªs.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

42 #i‚de‡
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<bôs/w‹dsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifde‡
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #i‡
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #i‡
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifde‡
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #i‡
deföed
 
__GNUC__
 && !deföed 
_GCC_LIMITS_H_


124 #ö˛ude_√xà<
limôs
.
h
>

130 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__


131 #i‚de‡
LLONG_MIN


132 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

134 #i‚de‡
LLONG_MAX


135 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

137 #i‚de‡
ULLONG_MAX


138 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

142 #ifdef 
__USE_POSIX


144 
	~<bôs/posix1_lim.h
>

147 #ifdef 
__USE_POSIX2


148 
	~<bôs/posix2_lim.h
>

151 #ifdef 
__USE_XOPEN


152 
	~<bôs/x›í_lim.h
>

	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

35 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


54 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

65 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

69 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

74 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

77 #ifde‡
__OPTIMIZE__


78 
__exã∫_Æways_ölöe
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


81  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

84 
__exã∫_Æways_ölöe
 const *

85 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


87  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifde‡
__USE_GNU


100 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

107 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

128 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

129 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

133 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

137 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

141 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

150 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

151 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
 
	`__n⁄nuŒ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifde‡
__USE_XOPEN2K8


159 
	~<xloˇÀ.h
>

162 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

163 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

165 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

166 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

169 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

170 || 
deföed
 
__USE_XOPEN2K8


172 *
	$°rdup
 (c⁄° *
__s
)

173 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

179 #i‡
deföed
 
__USE_XOPEN2K8


180 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

181 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

184 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


186 
	#°rdu∑
(
s
) \

187 (
__exãnsi⁄__
 \

189 c⁄° *
__ﬁd
 = (
s
); \

190 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

191 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

192 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

193 
	}
}))

	)

196 
	#°∫du∑
(
s
, 
n
) \

197 (
__exãnsi⁄__
 \

199 c⁄° *
__ﬁd
 = (
s
); \

200 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

201 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

202 
__√w
[
__Àn
] = '\0'; \

203 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

204 }))

	)

207 
	g__BEGIN_NAMESPACE_STD


209 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


212 *
°rchr
 (*
__s
, 
__c
)

213 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

214 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

215 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

217 #ifde‡
__OPTIMIZE__


218 
__exã∫_Æways_ölöe
 *

219 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


221  
__buûtö_°rchr
 (
__s
, 
__c
);

224 
__exã∫_Æways_ölöe
 const *

225 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


227  
__buûtö_°rchr
 (
__s
, 
__c
);

232 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

233 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

236 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


239 *
	`°ºchr
 (*
__s
, 
__c
)

240 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

241 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

242 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

244 #ifde‡
__OPTIMIZE__


245 
__exã∫_Æways_ölöe
 *

246 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


248  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

251 
__exã∫_Æways_ölöe
 const *

252 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


254  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

257 
	}
}

259 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

260 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

262 
__END_NAMESPACE_STD


264 #ifde‡
__USE_GNU


267 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


268 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

269 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

270 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

271 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

273 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

274 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

278 
__BEGIN_NAMESPACE_STD


281 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

282 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

285 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

288 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


291 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

292 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

293 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

294 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

296 #ifde‡
__OPTIMIZE__


297 
__exã∫_Æways_ölöe
 *

298 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


300  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

303 
__exã∫_Æways_ölöe
 const *

304 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


306  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

309 
	}
}

311 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

312 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

315 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


318 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

319 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

320 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

321 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

323 #ifde‡
__OPTIMIZE__


324 
__exã∫_Æways_ölöe
 *

325 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


327  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

330 
__exã∫_Æways_ölöe
 const *

331 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


333  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

336 
	}
}

338 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

339 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

344 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

345 
__THROW
 
	`__n⁄nuŒ
 ((2));

346 
__END_NAMESPACE_STD


350 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

351 c⁄° *
__ª°ri˘
 
__dñim
,

352 **
__ª°ri˘
 
__ßve_±r
)

353 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

354 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


355 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

360 #ifde‡
__USE_GNU


362 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


363 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

364 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

365 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

366 c⁄° *
__√edÀ
)

367 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

370 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

374 #ifde‡
__USE_GNU


378 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

379 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

380 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

384 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

385 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

386 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

387 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

388 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

389 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

393 
__BEGIN_NAMESPACE_STD


395 
size_t
 
	$°æí
 (c⁄° *
__s
)

396 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

397 
__END_NAMESPACE_STD


399 #ifdef 
__USE_XOPEN2K8


402 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

403 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

407 
__BEGIN_NAMESPACE_STD


409 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

410 
__END_NAMESPACE_STD


411 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


419 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


422 #ifde‡
__REDIRECT_NTH


423 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

424 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

425 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

427 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

428 
__THROW
 
	`__n⁄nuŒ
 ((2));

429 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

434 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

435 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

439 #ifde‡
__USE_XOPEN2K8


441 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

447 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

449 #ifde‡
__USE_BSD


451 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

452 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

455 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

458 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

459 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

462 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


465 *
	`ödex
 (*
__s
, 
__c
)

466 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

467 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

468 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

470 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


471 
__exã∫_Æways_ölöe
 *

472 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


474  
	`__buûtö_ödex
 (
__s
, 
__c
);

477 
__exã∫_Æways_ölöe
 const *

478 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


480  
	`__buûtö_ödex
 (
__s
, 
__c
);

483 
	}
}

485 *
	$ödex
 (c⁄° *
__s
, 
__c
)

486 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

490 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


493 *
	`rödex
 (*
__s
, 
__c
)

494 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

495 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

496 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

498 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


499 
__exã∫_Æways_ölöe
 *

500 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


502  
	`__buûtö_rödex
 (
__s
, 
__c
);

505 
__exã∫_Æways_ölöe
 const *

506 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


508  
	`__buûtö_rödex
 (
__s
, 
__c
);

511 
	}
}

513 *
	$rödex
 (c⁄° *
__s
, 
__c
)

514 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

519 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

523 #ifdef 
__USE_GNU


524 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

525 #ifde‡
__GNUC__


526 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

527 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

532 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

533 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

536 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

537 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

540 #ifdef 
__USE_GNU


543 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

544 
__loˇÀ_t
 
__loc
)

545 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

547 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

548 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

549 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

552 #ifdef 
__USE_BSD


555 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

556 c⁄° *
__ª°ri˘
 
__dñim
)

557 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

560 #ifdef 
__USE_XOPEN2K8


562 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

565 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

566 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

567 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

572 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

573 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

575 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

576 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

577 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

580 #ifdef 
__USE_GNU


582 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

583 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

586 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

589 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #i‚de‡
ba£«me


596 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


597 "C++" *
	$ba£«me
 (*
__fûíame
)

598 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

599 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

602 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

609 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

610 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


630 
	~<bôs/°rög.h
>

633 
	~<bôs/°rög2.h
>

636 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


638 
	~<bôs/°rög3.h
>

642 
__END_DECLS


	@/usr/include/bits/posix1_lim.h

24 #i‚def 
_BITS_POSIX1_LIM_H


25 
	#_BITS_POSIX1_LIM_H
 1

	)

31 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

34 
	#_POSIX_AIO_MAX
 1

	)

37 
	#_POSIX_ARG_MAX
 4096

	)

40 #ifde‡
__USE_XOPEN2K


41 
	#_POSIX_CHILD_MAX
 25

	)

43 
	#_POSIX_CHILD_MAX
 6

	)

47 
	#_POSIX_DELAYTIMER_MAX
 32

	)

51 
	#_POSIX_HOST_NAME_MAX
 255

	)

54 
	#_POSIX_LINK_MAX
 8

	)

57 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

60 
	#_POSIX_MAX_CANON
 255

	)

64 
	#_POSIX_MAX_INPUT
 255

	)

67 
	#_POSIX_MQ_OPEN_MAX
 8

	)

70 
	#_POSIX_MQ_PRIO_MAX
 32

	)

73 
	#_POSIX_NAME_MAX
 14

	)

76 #ifde‡
__USE_XOPEN2K


77 
	#_POSIX_NGROUPS_MAX
 8

	)

79 
	#_POSIX_NGROUPS_MAX
 0

	)

83 #ifde‡
__USE_XOPEN2K


84 
	#_POSIX_OPEN_MAX
 20

	)

86 
	#_POSIX_OPEN_MAX
 16

	)

89 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


92 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

96 
	#_POSIX_PATH_MAX
 256

	)

99 
	#_POSIX_PIPE_BUF
 512

	)

103 
	#_POSIX_RE_DUP_MAX
 255

	)

106 
	#_POSIX_RTSIG_MAX
 8

	)

109 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

112 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

115 
	#_POSIX_SIGQUEUE_MAX
 32

	)

118 
	#_POSIX_SSIZE_MAX
 32767

	)

121 
	#_POSIX_STREAM_MAX
 8

	)

124 
	#_POSIX_SYMLINK_MAX
 255

	)

128 
	#_POSIX_SYMLOOP_MAX
 8

	)

131 
	#_POSIX_TIMER_MAX
 32

	)

134 
	#_POSIX_TTY_NAME_MAX
 9

	)

137 #ifde‡
__USE_XOPEN2K


138 
	#_POSIX_TZNAME_MAX
 6

	)

140 
	#_POSIX_TZNAME_MAX
 3

	)

143 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


145 
	#_POSIX_QLIMIT
 1

	)

149 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

152 
	#_POSIX_UIO_MAXIOV
 16

	)

156 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

160 
	~<bôs/loˇl_lim.h
>

163 #i‚def 
SSIZE_MAX


164 
	#SSIZE_MAX
 
LONG_MAX


	)

171 #i‚def 
NGROUPS_MAX


172 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

22 #i‚def 
_BITS_POSIX2_LIM_H


23 
	#_BITS_POSIX2_LIM_H
 1

	)

27 
	#_POSIX2_BC_BASE_MAX
 99

	)

30 
	#_POSIX2_BC_DIM_MAX
 2048

	)

33 
	#_POSIX2_BC_SCALE_MAX
 99

	)

36 
	#_POSIX2_BC_STRING_MAX
 1000

	)

40 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

44 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

47 
	#_POSIX2_LINE_MAX
 2048

	)

51 
	#_POSIX2_RE_DUP_MAX
 255

	)

55 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

62 #i‚def 
BC_BASE_MAX


63 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

65 #i‚def 
BC_DIM_MAX


66 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

68 #i‚def 
BC_SCALE_MAX


69 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

71 #i‚def 
BC_STRING_MAX


72 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

74 #i‚def 
COLL_WEIGHTS_MAX


75 
	#COLL_WEIGHTS_MAX
 255

	)

77 #i‚def 
EXPR_NEST_MAX


78 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

80 #i‚def 
LINE_MAX


81 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

83 #i‚def 
CHARCLASS_NAME_MAX


84 
	#CHARCLASS_NAME_MAX
 2048

	)

88 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/string.h

19 #i‚de‡
_STRING_H


24 
	#_STRING_ARCH_u«lig√d
 1

	)

28 #i‡!
deföed
 
__x86_64__
 && (deföed 
__i486__
 || deföed 
__≥¡ium__
 \

29 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

30 || 
deföed
 
	g__noc⁄a__
 || deföed 
	g__©om__
 \

31 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__c‹ei7__
 \

32 || 
deföed
 
	g__k6__
 || deföed 
	g__geode__
 \

33 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

34 || 
deföed
 
	g__amdÁm10__
)

38 #i‡!
deföed
 
__NO_STRING_INLINES
 && deföed 
__USE_STRING_INLINES
 \

39 && 
deföed
 
	g__GNUC__
 && __GNUC__ >2 && !
__BOUNDED_POINTERS__


41 #i‚de‡
__STRING_INLINE


42 #i‚de‡
__exã∫_ölöe


43 
	#__STRING_INLINE
 
ölöe


	)

45 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

50 
	#__STRING_SMALL_GET16
(
§c
, 
idx
) \

51 ((((c⁄° *Ë(
§c
))[
idx
 + 1] << 8) \

52 | ((c⁄° *Ë(
§c
))[
idx
])

	)

53 
	#__STRING_SMALL_GET32
(
§c
, 
idx
) \

54 (((((c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

55 | ((c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

56 | ((c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

57 | ((c⁄° *Ë(
§c
))[
idx
])

	)

61 
	#_HAVE_STRING_ARCH_mem˝y
 1

	)

62 
	#mem˝y
(
de°
, 
§c
, 
n
) \

63 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

64 ? 
	`__mem˝y_c
 ((
de°
), (
§c
), (
n
)) \

65 : 
	`__mem˝y_g
 ((
de°
), (
§c
), (
n
))))

	)

66 
	#__mem˝y_c
(
de°
, 
§c
, 
n
) \

67 ((
n
) == 0 \

68 ? (
de°
) \

69 : (((
n
) % 4 == 0) \

70 ? 
	`__mem˝y_by4
 (
de°
, 
§c
, 
n
) \

71 : (((
n
) % 2 == 0) \

72 ? 
	`__mem˝y_by2
 (
de°
, 
§c
, 
n
) \

73 : 
	`__mem˝y_g
 (
de°
, 
§c
, 
n
))))

	)

75 
__STRING_INLINE
 *
__mem˝y_by4
 (*
__de°
, c⁄° *
__§c
,

76 
size_t
 
__n
);

78 
__STRING_INLINE
 *

79 
	$__mem˝y_by4
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

81 
__d0
, 
__d1
;

82 *
__tmp
 = 
__de°
;

83 
__asm__
 
__vﬁ©ûe__


91 : "=&r" (
__d0
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

92 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
 / 4)

94  
__de°
;

95 
	}
}

97 
__STRING_INLINE
 *
__mem˝y_by2
 (*
__de°
, c⁄° *
__§c
,

98 
size_t
 
__n
);

100 
__STRING_INLINE
 *

101 
	$__mem˝y_by2
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

103 
__d0
, 
__d1
;

104 *
__tmp
 = 
__de°
;

105 
__asm__
 
__vﬁ©ûe__


118 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

119 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
 / 2)

121  
__de°
;

122 
	}
}

124 
__STRING_INLINE
 *
__mem˝y_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
);

126 
__STRING_INLINE
 *

127 
	$__mem˝y_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

129 
__d0
, 
__d1
, 
__d2
;

130 *
__tmp
 = 
__de°
;

131 
__asm__
 
__vﬁ©ûe__


142 : "=&c" (
__d0
), "=&D" (
__d1
), "=&S" (
__d2
),

143 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

144 : "0" (
__n
), "1" (
__tmp
), "2" (
__§c
),

145 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
)

147  
__de°
;

148 
	}
}

150 
	#_HAVE_STRING_ARCH_memmove
 1

	)

151 #i‚de‡
_FORCE_INLINES


154 
	#memmove
(
de°
, 
§c
, 
n
Ë
	`__memmove_g
 (de°, src,Ç)

	)

156 
__STRING_INLINE
 *
	$__memmove_g
 (*, c⁄° *, 
size_t
)

157 
	`__asm__
 ("memmove");

159 
__STRING_INLINE
 *

160 
	$__memmove_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

162 
__d0
, 
__d1
, 
__d2
;

163 *
__tmp
 = 
__de°
;

164 i‡(
__de°
 < 
__§c
)

165 
__asm__
 
__vﬁ©ûe__


168 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

169 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

170 : "0" (
__n
), "1" (
__§c
), "2" (
__tmp
),

171 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
));

173 
__asm__
 
__vﬁ©ûe__


177 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

178 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

179 : "0" (
__n
), "1" (__¿- 1 + (c⁄° *Ë
__§c
),

180 "2" (
__n
 - 1 + (*Ë
__tmp
),

181 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
));

182  
__de°
;

183 
	}
}

187 
	#_HAVE_STRING_ARCH_memcmp
 1

	)

188 #i‚de‡
_FORCE_INLINES


189 #i‚de‡
__PIC__


191 
__STRING_INLINE
 

192 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

194 
__d0
, 
__d1
, 
__d2
;

195 
__ªs
;

196 
__asm__
 
__vﬁ©ûe__


204 : "=&a" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

205 : "0" (0), "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

206 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s1
),

207 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s2
)

209  
__ªs
;

210 
	}
}

215 
	#_HAVE_STRING_ARCH_mem£t
 1

	)

216 
	#_USE_STRING_ARCH_mem£t
 1

	)

217 
	#mem£t
(
s
, 
c
, 
n
) \

218 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

219 ? ((
n
) == 1 \

220 ? 
	`__mem£t_c1
 ((
s
), (
c
)) \

221 : 
	`__mem£t_gc
 ((
s
), (
c
), (
n
))) \

222 : (
	`__buûtö_c⁄°™t_p
 (
c
) \

223 ? (
	`__buûtö_c⁄°™t_p
 (
n
) \

224 ? 
	`__mem£t_c˙
 ((
s
), (
c
), (
n
)) \

225 : 
	`mem£t
 ((
s
), (
c
), (
n
))) \

226 : (
	`__buûtö_c⁄°™t_p
 (
n
) \

227 ? 
	`__mem£t_g˙
 ((
s
), (
c
), (
n
)) \

228 : 
	`mem£t
 ((
s
), (
c
), (
n
))))))

	)

230 
	#__mem£t_c1
(
s
, 
c
Ë({ *
__s
 = (s); \

231 *((*Ë
__s
Ë(Ë(
c
); \

232 
__s
; })

	)

234 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

235 ({ *
__s
 = (
s
); \

237 
__ui
; \

238 
__usi
; \

239 
__uc
; \

240 } *
__u
 = 
__s
; \

241 
__c
 = ((Ë((Ë(
c
))) * 0x01010101; \

247 i‡((
n
) == 3 || (n) >= 5) \

248 
__asm__
 
	`__vﬁ©ûe__
 ("" : "Ù" (
__c
) : "0" (__c)); \

251 
n
) \

254 
__u
->
__ui
 = 
__c
; \

255 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

257 
__u
->
__ui
 = 
__c
; \

258 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

260 
__u
->
__ui
 = 
__c
; \

261 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

263 
__u
->
__usi
 = (Ë
__c
; \

264 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

265 
__u
->
__uc
 = (Ë
__c
; \

269 
__u
->
__ui
 = 
__c
; \

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

272 
__u
->
__ui
 = 
__c
; \

273 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

275 
__u
->
__ui
 = 
__c
; \

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

278 
__u
->
__usi
 = (Ë
__c
; \

282 
__u
->
__ui
 = 
__c
; \

283 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

285 
__u
->
__ui
 = 
__c
; \

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

288 
__u
->
__ui
 = 
__c
; \

289 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

291 
__u
->
__uc
 = (Ë
__c
; \

295 
__u
->
__ui
 = 
__c
; \

296 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

298 
__u
->
__ui
 = 
__c
; \

299 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

301 
__u
->
__ui
 = 
__c
; \

302 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

304 
__u
->
__ui
 = 
__c
; \

309 
__s
; })

	)

311 
	#__mem£t_c˙
(
s
, 
c
, 
n
) \

312 (((
n
) % 4 == 0) \

313 ? 
	`__mem£t_c˙_by4
 (
s
, ((Ë((Ë(
c
))) * 0x01010101,\

314 
n
) \

315 : (((
n
) % 2 == 0) \

316 ? 
	`__mem£t_c˙_by2
 (
s
, \

317 ((Ë((Ë(
c
))) * 0x01010101,\

318 
n
) \

319 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

321 
__STRING_INLINE
 *
__mem£t_c˙_by4
 (*
__s
, 
__c
,

322 
size_t
 
__n
);

324 
__STRING_INLINE
 *

325 
	$__mem£t_c˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

327 *
__tmp
 = 
__s
;

328 
__d0
;

329 #ifde‡
__i686__


330 
__asm__
 
__vﬁ©ûe__


333 : "=&a" (
__c
), "=&D" (
__tmp
), "=&c" (
__d0
),

334 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

335 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

338 
__asm__
 
__vﬁ©ûe__


344 : "=&r" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

345 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

346 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

349  
__s
;

350 
	}
}

352 
__STRING_INLINE
 *
__mem£t_c˙_by2
 (*
__s
, 
__c
,

353 
size_t
 
__n
);

355 
__STRING_INLINE
 *

356 
	$__mem£t_c˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

358 
__d0
, 
__d1
;

359 *
__tmp
 = 
__s
;

360 #ifde‡
__i686__


361 
__asm__
 
__vﬁ©ûe__


365 : "=&a" (
__d0
), "=&D" (
__tmp
), "=&c" (
__d1
),

366 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

367 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

370 
__asm__
 
__vﬁ©ûe__


376 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

377 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

378 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

381  
__s
;

382 
	}
}

384 
	#__mem£t_g˙
(
s
, 
c
, 
n
) \

385 (((
n
) % 4 == 0) \

386 ? 
	`__mem£t_g˙_by4
 (
s
, 
c
, 
n
) \

387 : (((
n
) % 2 == 0) \

388 ? 
	`__mem£t_g˙_by2
 (
s
, 
c
, 
n
) \

389 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

391 
__STRING_INLINE
 *
__mem£t_g˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
);

393 
__STRING_INLINE
 *

394 
	$__mem£t_g˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

396 *
__tmp
 = 
__s
;

397 
__d0
;

398 
__asm__
 
__vﬁ©ûe__


408 : "=&q" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

409 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

410 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

412  
__s
;

413 
	}
}

415 
__STRING_INLINE
 *
__mem£t_g˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
);

417 
__STRING_INLINE
 *

418 
	$__mem£t_g˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

420 
__d0
, 
__d1
;

421 *
__tmp
 = 
__s
;

422 
__asm__
 
__vﬁ©ûe__


433 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

434 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

435 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

437  
__s
;

438 
	}
}

442 
	#_HAVE_STRING_ARCH_memchr
 1

	)

443 #i‚de‡
_FORCE_INLINES


444 
__STRING_INLINE
 *

445 
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

447 
__d0
;

448 #ifde‡
__i686__


449 
__d1
;

451 *
__ªs
;

452 i‡(
__n
 == 0)

453  
NULL
;

454 #ifde‡
__i686__


455 
__asm__
 
__vﬁ©ûe__


459 : "=D" (
__ªs
), "=&c" (
__d0
), "=&r" (
__d1
)

460 : "a" (
__c
), "0" (
__s
), "1" (
__n
), "2" (1),

461 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

464 
__asm__
 
__vﬁ©ûe__


470 : "=D" (
__ªs
), "=&c" (
__d0
)

471 : "a" (
__c
), "0" (
__s
), "1" (
__n
),

472 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

475  
__ªs
 - 1;

476 
	}
}

479 
	#_HAVE_STRING_ARCH_memrchr
 1

	)

480 #i‚de‡
_FORCE_INLINES


481 
__STRING_INLINE
 *
__memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
);

483 
__STRING_INLINE
 *

484 
	$__memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

486 
__d0
;

487 #ifde‡
__i686__


488 
__d1
;

490 *
__ªs
;

491 i‡(
__n
 == 0)

492  
NULL
;

493 #ifde‡
__i686__


494 
__asm__
 
__vﬁ©ûe__


500 : "=D" (
__ªs
), "=&c" (
__d0
), "=&r" (
__d1
)

501 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n), "2" (-1),

502 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

505 
__asm__
 
__vﬁ©ûe__


512 : "=D" (
__ªs
), "=&c" (
__d0
)

513 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n),

514 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

517  
__ªs
;

518 
	}
}

519 #ifde‡
__USE_GNU


520 
	#memrchr
(
s
, 
c
, 
n
Ë
	`__memrchr
 ((s), (c), (n))

	)

525 
	#_HAVE_STRING_ARCH_øwmemchr
 1

	)

526 
__STRING_INLINE
 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

528 #i‚de‡
_FORCE_INLINES


529 
__STRING_INLINE
 *

530 
	$__øwmemchr
 (c⁄° *
__s
, 
__c
)

532 
__d0
;

533 *
__ªs
;

534 
__asm__
 
__vﬁ©ûe__


537 : "=D" (
__ªs
), "=&c" (
__d0
)

538 : "a" (
__c
), "0" (
__s
), "1" (0xffffffff),

539 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

541  
__ªs
 - 1;

542 
	}
}

543 #ifde‡
__USE_GNU


544 
__STRING_INLINE
 *

545 
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

547  
	`__øwmemchr
 (
__s
, 
__c
);

548 
	}
}

554 
	#_HAVE_STRING_ARCH_°æí
 1

	)

555 
	#°æí
(
°r
) \

556 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
°r
) \

557 ? 
	`__buûtö_°æí
 (
°r
) \

558 : 
	`__°æí_g
 (
°r
)))

	)

559 
__STRING_INLINE
 
size_t
 
__°æí_g
 (c⁄° *
__°r
);

561 
__STRING_INLINE
 
size_t


562 
	$__°æí_g
 (c⁄° *
__°r
)

564 
__dummy
;

565 c⁄° *
__tmp
 = 
__°r
;

566 
__asm__
 
__vﬁ©ûe__


572 : "Ù" (
__tmp
), "=&q" (
__dummy
)

573 : "0" (
__°r
),

574 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__°r
)

576  
__tmp
 - 
__°r
 - 1;

577 
	}
}

581 
	#_HAVE_STRING_ARCH_°r˝y
 1

	)

582 
	#°r˝y
(
de°
, 
§c
) \

583 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

584 ? ( ((
§c
)[0]Ë=1 && 
	`°æí
 (src) + 1 <= 8 \

585 ? 
	`__°r˝y_a_smÆl
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

586 : (*Ë
	`mem˝y
 ((*Ë(
de°
), \

587 (c⁄° *Ë(
§c
), \

588 
	`°æí
 (
§c
) + 1)) \

589 : 
	`__°r˝y_g
 ((
de°
), (
§c
))))

	)

591 
	#__°r˝y_a_smÆl
(
de°
, 
§c
, 
§˛í
) \

592 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

594 
__ui
; \

595 
__usi
; \

596 
__uc
; \

597 
__c
; \

598 } *
__u
 = (*Ë
__de°
; \

599 
§˛í
) \

602 
__u
->
__uc
 = '\0'; \

605 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

608 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

609 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

610 
__u
->
__uc
 = '\0'; \

613 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

616 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

617 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

618 
__u
->
__uc
 = '\0'; \

621 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

622 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

623 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

626 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

627 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

628 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

629 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

630 
__u
->
__uc
 = '\0'; \

633 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

635 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 4); \

638 (*Ë
__de°
; }))

	)

640 
__STRING_INLINE
 *
__°r˝y_g
 (*
__de°
, c⁄° *
__§c
);

642 
__STRING_INLINE
 *

643 
	$__°r˝y_g
 (*
__de°
, c⁄° *
__§c
)

645 *
__tmp
 = 
__de°
;

646 
__dummy
;

647 
__asm__
 
__vﬁ©ûe__


656 : "=&r" (
__§c
), "=&r" (
__tmp
), "=&q" (
__dummy
),

657 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

658 : "0" (
__§c
), "1" (
__tmp
),

659 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

661  
__de°
;

662 
	}
}

665 #ifde‡
__USE_GNU


666 
	#_HAVE_STRING_ARCH_°p˝y
 1

	)

668 
	#__°p˝y
(
de°
, 
§c
) \

669 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

670 ? (
	`°æí
 (
§c
) + 1 <= 8 \

671 ? 
	`__°p˝y_a_smÆl
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

672 : 
	`__°p˝y_c
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1)) \

673 : 
	`__°p˝y_g
 ((
de°
), (
§c
))))

	)

674 
	#__°p˝y_c
(
de°
, 
§c
, 
§˛í
) \

675 ((
§˛í
) % 4 == 0 \

676 ? 
	`__memp˝y_by4
 (
de°
, 
§c
, 
§˛í
) - 1 \

677 : ((
§˛í
) % 2 == 0 \

678 ? 
	`__memp˝y_by2
 (
de°
, 
§c
, 
§˛í
) - 1 \

679 : 
	`__memp˝y_byn
 (
de°
, 
§c
, 
§˛í
Ë- 1))

	)

682 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 ((de°), (§c))

	)

684 
	#__°p˝y_a_smÆl
(
de°
, 
§c
, 
§˛í
) \

685 (
	`__exãnsi⁄__
 ({ union { \

686 
__ui
; \

687 
__usi
; \

688 
__uc
; \

689 
__c
; \

690 } *
__u
 = (*Ë(
de°
); \

691 
§˛í
) \

694 
__u
->
__uc
 = '\0'; \

697 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

698 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1); \

701 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

702 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

703 
__u
->
__uc
 = '\0'; \

706 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

707 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3); \

710 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

711 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

712 
__u
->
__uc
 = '\0'; \

715 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

716 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

717 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

718 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1); \

721 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

722 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

723 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

724 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

725 
__u
->
__uc
 = '\0'; \

728 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

729 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

730 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 4); \

731 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3); \

734 (*Ë
__u
; }))

	)

736 
__STRING_INLINE
 *
__memp˝y_by4
 (*
__de°
, c⁄° *
__§c
,

737 
size_t
 
__§˛í
);

739 
__STRING_INLINE
 *

740 
	$__memp˝y_by4
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

742 *
__tmp
 = 
__de°
;

743 
__d0
, 
__d1
;

744 
__asm__
 
__vﬁ©ûe__


752 : "=&r" (
__d0
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

753 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 4)

755  
__tmp
;

756 
	}
}

758 
__STRING_INLINE
 *
__memp˝y_by2
 (*
__de°
, c⁄° *
__§c
,

759 
size_t
 
__§˛í
);

761 
__STRING_INLINE
 *

762 
	$__memp˝y_by2
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

764 *
__tmp
 = 
__de°
;

765 
__d0
, 
__d1
;

766 
__asm__
 
__vﬁ©ûe__


779 : "=&q" (
__d0
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
),

780 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

781 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 2),

782 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

784  
__tmp
 + 2;

785 
	}
}

787 
__STRING_INLINE
 *
__memp˝y_byn
 (*
__de°
, c⁄° *
__§c
,

788 
size_t
 
__§˛í
);

790 
__STRING_INLINE
 *

791 
	$__memp˝y_byn
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

793 
__d0
, 
__d1
;

794 *
__tmp
 = 
__de°
;

795 
__asm__
 
__vﬁ©ûe__


806 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

807 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

808 : "0" (
__tmp
), "1" (
__§˛í
), "2" (
__§c
),

809 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

811  
__tmp
;

812 
	}
}

814 
__STRING_INLINE
 *
__°p˝y_g
 (*
__de°
, c⁄° *
__§c
);

816 
__STRING_INLINE
 *

817 
	$__°p˝y_g
 (*
__de°
, c⁄° *
__§c
)

819 *
__tmp
 = 
__de°
;

820 
__dummy
;

821 
__asm__
 
__vﬁ©ûe__


830 : "=&r" (
__§c
), "Ù" (
__tmp
), "=&q" (
__dummy
),

831 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

832 : "0" (
__§c
), "1" (
__tmp
),

833 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

835  
__tmp
 - 1;

836 
	}
}

841 
	#_HAVE_STRING_ARCH_°∫˝y
 1

	)

842 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

843 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

844 ? ((
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

845 ? (*Ë
	`mem˝y
 ((*Ë(
de°
), \

846 (c⁄° *Ë(
§c
), 
n
) \

847 : 
	`__°∫˝y_cg
 ((
de°
), (
§c
), 
	`°æí
 (§cË+ 1, 
n
))) \

848 : 
	`__°∫˝y_gg
 ((
de°
), (
§c
), 
n
)))

	)

849 
	#__°∫˝y_cg
(
de°
, 
§c
, 
§˛í
, 
n
) \

850 (((
§˛í
) % 4 == 0) \

851 ? 
	`__°∫˝y_by4
 (
de°
, 
§c
, 
§˛í
, 
n
) \

852 : (((
§˛í
) % 2 == 0) \

853 ? 
	`__°∫˝y_by2
 (
de°
, 
§c
, 
§˛í
, 
n
) \

854 : 
	`__°∫˝y_byn
 (
de°
, 
§c
, 
§˛í
, 
n
)))

	)

856 
__STRING_INLINE
 *
__°∫˝y_by4
 (*
__de°
, c⁄° 
__§c
[],

857 
size_t
 
__§˛í
, size_à
__n
);

859 
__STRING_INLINE
 *

860 
	$__°∫˝y_by4
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

862 *
__tmp
 = 
__de°
;

863 
__dummy1
, 
__dummy2
;

864 
__asm__
 
__vﬁ©ûe__


872 : "=&r" (
__dummy1
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__dummy2
),

873 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

874 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 4),

875 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

877 (Ë
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__§˛í
);

878  
__de°
;

879 
	}
}

881 
__STRING_INLINE
 *
__°∫˝y_by2
 (*
__de°
, c⁄° 
__§c
[],

882 
size_t
 
__§˛í
, size_à
__n
);

884 
__STRING_INLINE
 *

885 
	$__°∫˝y_by2
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

887 *
__tmp
 = 
__de°
;

888 
__dummy1
, 
__dummy2
;

889 
__asm__
 
__vﬁ©ûe__


902 : "=&q" (
__dummy1
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__dummy2
),

903 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

904 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 2),

905 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

907 (Ë
	`mem£t
 (
__tmp
 + 2, '\0', 
__n
 - 
__§˛í
);

908  
__de°
;

909 
	}
}

911 
__STRING_INLINE
 *
__°∫˝y_byn
 (*
__de°
, c⁄° 
__§c
[],

912 
size_t
 
__§˛í
, size_à
__n
);

914 
__STRING_INLINE
 *

915 
	$__°∫˝y_byn
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

917 
__d0
, 
__d1
;

918 *
__tmp
 = 
__de°
;

919 
__asm__
 
__vﬁ©ûe__


930 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

931 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

932 : "1" (
__§˛í
), "0" (
__tmp
),"2" (
__§c
),

933 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

935 (Ë
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__§˛í
);

936  
__de°
;

937 
	}
}

939 
__STRING_INLINE
 *
__°∫˝y_gg
 (*
__de°
, c⁄° *
__§c
,

940 
size_t
 
__n
);

942 
__STRING_INLINE
 *

943 
	$__°∫˝y_gg
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

945 *
__tmp
 = 
__de°
;

946 
__dummy
;

947 i‡(
__n
 > 0)

948 
__asm__
 
__vﬁ©ûe__


964 : "=&r" (
__§c
), "=&r" (
__tmp
), "=&q" (
__dummy
), "=&r" (
__n
)

965 : "0" (
__§c
), "1" (
__tmp
), "3" (
__n
)

968  
__de°
;

969 
	}
}

973 
	#_HAVE_STRING_ARCH_°rˇt
 1

	)

974 
	#°rˇt
(
de°
, 
§c
) \

975 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

976 ? 
	`__°rˇt_c
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

977 : 
	`__°rˇt_g
 ((
de°
), (
§c
))))

	)

979 
__STRING_INLINE
 *
__°rˇt_c
 (*
__de°
, c⁄° 
__§c
[],

980 
size_t
 
__§˛í
);

982 
__STRING_INLINE
 *

983 
	$__°rˇt_c
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
)

985 #ifde‡
__i686__


986 
__d0
;

987 *
__tmp
;

988 
__asm__
 
__vﬁ©ûe__


990 : "=D" (
__tmp
), "=&c" (
__d0
),

991 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

992 : "0" (
__de°
), "1" (0xffffffff), "a" (0),

993 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

995 --
__tmp
;

997 *
__tmp
 = 
__de°
 - 1;

998 
__asm__
 
__vﬁ©ûe__


1003 : "Ù" (
__tmp
),

1004 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

1005 : "0" (
__tmp
),

1006 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

1009 (Ë
	`mem˝y
 (
__tmp
, 
__§c
, 
__§˛í
);

1010  
__de°
;

1011 
	}
}

1013 
__STRING_INLINE
 *
__°rˇt_g
 (*
__de°
, c⁄° *
__§c
);

1015 
__STRING_INLINE
 *

1016 
	$__°rˇt_g
 (*
__de°
, c⁄° *
__§c
)

1018 *
__tmp
 = 
__de°
 - 1;

1019 
__dummy
;

1020 
__asm__
 
__vﬁ©ûe__


1032 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__§c
),

1033 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

1034 : "1" (
__tmp
), "2" (
__§c
),

1035 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

1037  
__de°
;

1038 
	}
}

1042 
	#_HAVE_STRING_ARCH_°∫ˇt
 1

	)

1043 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

1044 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

1045 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

1046 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

1047 ? 
	`°rˇt
 (
__de°
, (
§c
)) \

1048 : (*(*)
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

1049 (c⁄° *Ë(
§c
), \

1050 (
n
)Ë0, 
__de°
)) \

1051 : 
	`__°∫ˇt_g
 (
__de°
, (
§c
), (
n
)); }))

	)

1053 
__STRING_INLINE
 *
__°∫ˇt_g
 (*
__de°
, c⁄° 
__§c
[],

1054 
size_t
 
__n
);

1056 
__STRING_INLINE
 *

1057 
	$__°∫ˇt_g
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__n
)

1059 *
__tmp
 = 
__de°
;

1060 
__dummy
;

1061 #ifde‡
__i686__


1062 
__asm__
 
__vﬁ©ûe__


1076 : "=&a" (
__dummy
), "=&D" (
__tmp
), "=&S" (
__§c
), "=&c" (
__n
)

1077 : "g" (
__n
), "0" (0), "1" (
__tmp
), "2" (
__§c
), "3" (0xffffffff)

1080 --
__tmp
;

1081 
__asm__
 
__vﬁ©ûe__


1098 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__n
)

1099 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
)

1102  
__de°
;

1103 
	}
}

1107 
	#_HAVE_STRING_ARCH_°rcmp
 1

	)

1108 
	#°rcmp
(
s1
, 
s2
) \

1109 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

1110 && ( ((
s1
)[0]Ë!1 || 
	`°æí
 (s1) >= 4) \

1111 && ( ((
s2
)[0]Ë!1 || 
	`°æí
 (s2) >= 4) \

1112 ? 
	`memcmp
 ((c⁄° *Ë(
s1
), (c⁄° *Ë(
s2
), \

1113 (
	`°æí
 (
s1
Ë< såÀ¿(
s2
) \

1114 ? 
	`°æí
 (
s1
Ë: såÀ¿(
s2
)) + 1) \

1115 : (
	`__buûtö_c⁄°™t_p
 (
s1
) &&  ((s1)[0]) == 1 \

1116 &&  ((
s2
)[0]Ë=1 && 
	`°æí
 (
s1
) < 4 \

1117 ? (
	`__buûtö_c⁄°™t_p
 (
s2
) &&  ((s2)[0]) == 1 \

1118 ? 
	`__°rcmp_cc
 ((c⁄° *Ë(
s1
), \

1119 (c⁄° *Ë(
s2
), \

1120 
	`°æí
 (
s1
)) \

1121 : 
	`__°rcmp_cg
 ((c⁄° *Ë(
s1
), \

1122 (c⁄° *Ë(
s2
), \

1123 
	`°æí
 (
s1
))) \

1124 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&&  ((
s1
)[0]) == 1 \

1125 &&  ((
s2
)[0]Ë=1 && 
	`°æí
 (s2) < 4 \

1126 ? (
	`__buûtö_c⁄°™t_p
 (
s1
) \

1127 ? 
	`__°rcmp_cc
 ((c⁄° *Ë(
s1
), \

1128 (c⁄° *Ë(
s2
), \

1129 
	`°æí
 (
s2
)) \

1130 : 
	`__°rcmp_gc
 ((c⁄° *Ë(
s1
), \

1131 (c⁄° *Ë(
s2
), \

1132 
	`°æí
 (
s2
))) \

1133 : 
	`__°rcmp_gg
 ((
s1
), (
s2
))))))

	)

1135 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

1136 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = (
s1
)[0] - (
s2
)[0]; \

1137 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

1139 
__ªsu…
 = (
s1
)[1] - (
s2
)[1]; \

1140 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

1142 
__ªsu…
 = (
s1
)[2] - (
s2
)[2]; \

1143 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

1144 
__ªsu…
 = (
s1
)[3] - (
s2
)[3]; \

1147 
__ªsu…
; }))

	)

1149 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

1150 (
	`__exãnsi⁄__
 ({ c⁄° *
__s2
 = (
s2
); \

1151 
__ªsu…
 = (
s1
)[0] - 
__s2
[0]; \

1152 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

1154 
__ªsu…
 = (
s1
)[1] - 
__s2
[1]; \

1155 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

1157 
__ªsu…
 = (
s1
)[2] - 
__s2
[2]; \

1158 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

1159 
__ªsu…
 = (
s1
)[3] - 
__s2
[3]; \

1162 
__ªsu…
; }))

	)

1164 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

1165 (
	`__exãnsi⁄__
 ({ c⁄° *
__s1
 = (
s1
); \

1166 
__ªsu…
 = 
__s1
[0] - (
s2
)[0]; \

1167 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

1169 
__ªsu…
 = 
__s1
[1] - (
s2
)[1]; \

1170 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

1172 
__ªsu…
 = 
__s1
[2] - (
s2
)[2]; \

1173 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

1174 
__ªsu…
 = 
__s1
[3] - (
s2
)[3]; \

1177 
__ªsu…
; }))

	)

1179 
__STRING_INLINE
 
__°rcmp_gg
 (c⁄° *
__s1
, c⁄° *
__s2
);

1181 
__STRING_INLINE
 

1182 
	$__°rcmp_gg
 (c⁄° *
__s1
, c⁄° *
__s2
)

1184 
__ªs
;

1185 
__asm__
 
__vﬁ©ûe__


1201 : "=q" (
__ªs
), "=&r" (
__s1
), "=&r" (
__s2
)

1202 : "1" (
__s1
), "2" (
__s2
),

1203 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s1
),

1204 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s2
)

1206  
__ªs
;

1207 
	}
}

1211 
	#_HAVE_STRING_ARCH_°∫cmp
 1

	)

1212 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

1213 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`°æí
 (s1Ë< ((
size_t
Ë(
n
)) \

1214 ? 
	`°rcmp
 ((
s1
), (
s2
)) \

1215 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`°æí
 (s2Ë< ((
size_t
Ë(
n
))\

1216 ? 
	`°rcmp
 ((
s1
), (
s2
)) \

1217 : 
	`__°∫cmp_g
 ((
s1
), (
s2
), (
n
)))))

	)

1219 
__STRING_INLINE
 
__°∫cmp_g
 (c⁄° *
__s1
, c⁄° *
__s2
,

1220 
size_t
 
__n
);

1222 
__STRING_INLINE
 

1223 
	$__°∫cmp_g
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

1225 
__ªs
;

1226 
__asm__
 
__vﬁ©ûe__


1245 : "=q" (
__ªs
), "=&r" (
__s1
), "=&r" (
__s2
), "=&r" (
__n
)

1246 : "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

1247 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s1
),

1248 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s2
)

1250  
__ªs
;

1251 
	}
}

1255 
	#_HAVE_STRING_ARCH_°rchr
 1

	)

1256 
	#_USE_STRING_ARCH_°rchr
 1

	)

1257 
	#°rchr
(
s
, 
c
) \

1258 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1259 ? ((
c
) == '\0' \

1260 ? (*Ë
	`__øwmemchr
 ((
s
), (
c
)) \

1261 : 
	`__°rchr_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1262 : 
	`__°rchr_g
 ((
s
), (
c
))))

	)

1264 
__STRING_INLINE
 *
__°rchr_c
 (c⁄° *
__s
, 
__c
);

1266 
__STRING_INLINE
 *

1267 
	$__°rchr_c
 (c⁄° *
__s
, 
__c
)

1269 
__d0
;

1270 *
__ªs
;

1271 
__asm__
 
__vﬁ©ûe__


1281 : "Ù" (
__ªs
), "=&a" (
__d0
)

1282 : "0" (
__s
), "1" (
__c
),

1283 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1285  
__ªs
;

1286 
	}
}

1288 
__STRING_INLINE
 *
__°rchr_g
 (c⁄° *
__s
, 
__c
);

1290 
__STRING_INLINE
 *

1291 
	$__°rchr_g
 (c⁄° *
__s
, 
__c
)

1293 
__d0
;

1294 *
__ªs
;

1295 
__asm__
 
__vﬁ©ûe__


1306 : "Ù" (
__ªs
), "=&a" (
__d0
)

1307 : "0" (
__s
), "1" (
__c
),

1308 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1310  
__ªs
;

1311 
	}
}

1315 
	#_HAVE_STRING_ARCH_°rch∫ul
 1

	)

1316 
	#__°rch∫ul
(
s
, 
c
) \

1317 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1318 ? ((
c
) == '\0' \

1319 ? (*Ë
	`__øwmemchr
 ((
s
), 
c
) \

1320 : 
	`__°rch∫ul_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1321 : 
	`__°rch∫ul_g
 ((
s
), 
c
)))

	)

1323 
__STRING_INLINE
 *
__°rch∫ul_c
 (c⁄° *
__s
, 
__c
);

1325 
__STRING_INLINE
 *

1326 
	$__°rch∫ul_c
 (c⁄° *
__s
, 
__c
)

1328 
__d0
;

1329 *
__ªs
;

1330 
__asm__
 
__vﬁ©ûe__


1340 : "Ù" (
__ªs
), "=&a" (
__d0
)

1341 : "0" (
__s
), "1" (
__c
),

1342 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1344  
__ªs
;

1345 
	}
}

1347 
__STRING_INLINE
 *
__°rch∫ul_g
 (c⁄° *
__s
, 
__c
);

1349 
__STRING_INLINE
 *

1350 
	$__°rch∫ul_g
 (c⁄° *
__s
, 
__c
)

1352 
__d0
;

1353 *
__ªs
;

1354 
__asm__
 
__vﬁ©ûe__


1365 : "Ù" (
__ªs
), "=&a" (
__d0
)

1366 : "0" (
__s
), "1" (
__c
),

1367 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1369  
__ªs
;

1370 
	}
}

1371 #ifde‡
__USE_GNU


1372 
	#°rch∫ul
(
s
, 
c
Ë
	`__°rch∫ul
 ((s), (c))

	)

1376 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1378 
	#_HAVE_STRING_ARCH_ödex
 1

	)

1379 
	#ödex
(
s
, 
c
) \

1380 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1381 ? 
	`__°rchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1382 : 
	`__°rchr_g
 ((
s
), (
c
))))

	)

1387 
	#_HAVE_STRING_ARCH_°ºchr
 1

	)

1388 
	#°ºchr
(
s
, 
c
) \

1389 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1390 ? 
	`__°ºchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1391 : 
	`__°ºchr_g
 ((
s
), (
c
))))

	)

1393 #ifde‡
__i686__


1394 
__STRING_INLINE
 *
__°ºchr_c
 (c⁄° *
__s
, 
__c
);

1396 
__STRING_INLINE
 *

1397 
	$__°ºchr_c
 (c⁄° *
__s
, 
__c
)

1399 
__d0
, 
__d1
;

1400 *
__ªs
;

1401 
__asm__
 
__vﬁ©ûe__


1409 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1410 : "0" (1), "1" (
__s
), "2" (
__c
),

1411 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1413  
__ªs
 - 1;

1414 
	}
}

1416 
__STRING_INLINE
 *
__°ºchr_g
 (c⁄° *
__s
, 
__c
);

1418 
__STRING_INLINE
 *

1419 
	$__°ºchr_g
 (c⁄° *
__s
, 
__c
)

1421 
__d0
, 
__d1
;

1422 *
__ªs
;

1423 
__asm__
 
__vﬁ©ûe__


1432 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1433 : "0" (1), "1" (
__s
), "2" (
__c
),

1434 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1436  
__ªs
 - 1;

1437 
	}
}

1439 
__STRING_INLINE
 *
__°ºchr_c
 (c⁄° *
__s
, 
__c
);

1441 
__STRING_INLINE
 *

1442 
	$__°ºchr_c
 (c⁄° *
__s
, 
__c
)

1444 
__d0
, 
__d1
;

1445 *
__ªs
;

1446 
__asm__
 
__vﬁ©ûe__


1456 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1457 : "0" (0), "1" (
__s
), "2" (
__c
),

1458 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1460  
__ªs
;

1461 
	}
}

1463 
__STRING_INLINE
 *
__°ºchr_g
 (c⁄° *
__s
, 
__c
);

1465 
__STRING_INLINE
 *

1466 
	$__°ºchr_g
 (c⁄° *
__s
, 
__c
)

1468 
__d0
, 
__d1
;

1469 *
__ªs
;

1470 
__asm__
 
__vﬁ©ûe__


1481 : "Ù" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1482 : "0" (0), "1" (
__s
), "2" (
__c
),

1483 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1485  
__ªs
;

1486 
	}
}

1490 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1492 
	#_HAVE_STRING_ARCH_rödex
 1

	)

1493 
	#rödex
(
s
, 
c
) \

1494 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1495 ? 
	`__°ºchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1496 : 
	`__°ºchr_g
 ((
s
), (
c
))))

	)

1502 
	#_HAVE_STRING_ARCH_°rc•n
 1

	)

1503 
	#°rc•n
(
s
, 
ªje˘
) \

1504 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
) &&  ((reject)[0]) == 1 \

1505 ? ((
ªje˘
)[0] == '\0' \

1506 ? 
	`°æí
 (
s
) \

1507 : ((
ªje˘
)[1] == '\0' \

1508 ? 
	`__°rc•n_c1
 ((
s
), (((
ªje˘
)[0] << 8) & 0xff00)) \

1509 : 
	`__°rc•n_cg
 ((
s
), (
ªje˘
), 
	`°æí
 (reject)))) \

1510 : 
	`__°rc•n_g
 ((
s
), (
ªje˘
))))

	)

1512 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
);

1514 #i‚de‡
_FORCE_INLINES


1515 
__STRING_INLINE
 
size_t


1516 
	$__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
)

1518 
__d0
;

1519 *
__ªs
;

1520 
__asm__
 
__vﬁ©ûe__


1529 : "Ù" (
__ªs
), "=&a" (
__d0
)

1530 : "0" (
__s
), "1" (
__ªje˘
),

1531 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1533  (
__ªs
 - 1Ë- 
__s
;

1534 
	}
}

1537 
__STRING_INLINE
 
size_t
 
__°rc•n_cg
 (c⁄° *
__s
, c⁄° 
__ªje˘
[],

1538 
size_t
 
__ªje˘_Àn
);

1540 
__STRING_INLINE
 
size_t


1541 
	$__°rc•n_cg
 (c⁄° *
__s
, c⁄° 
__ªje˘
[], 
size_t
 
__ªje˘_Àn
)

1543 
__d0
, 
__d1
, 
__d2
;

1544 c⁄° *
__ªs
;

1545 
__asm__
 
__vﬁ©ûe__


1556 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1557 : "0" (
__s
), "d" (
__ªje˘
), "g" (
__ªje˘_Àn
)

1559  (
__ªs
 - 1Ë- 
__s
;

1560 
	}
}

1562 
__STRING_INLINE
 
size_t
 
__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
);

1563 #ifde‡
__PIC__


1565 
__STRING_INLINE
 
size_t


1566 
	$__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

1568 
__d0
, 
__d1
, 
__d2
;

1569 c⁄° *
__ªs
;

1570 
__asm__
 
__vﬁ©ûe__


1587 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1588 : "r" (
__ªje˘
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1590  (
__ªs
 - 1Ë- 
__s
;

1591 
	}
}

1593 
__STRING_INLINE
 
size_t


1594 
	$__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

1596 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1597 c⁄° *
__ªs
;

1598 
__asm__
 
__vﬁ©ûe__


1612 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1613 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__ªje˘
), "b" (__reject)

1616  (
__ªs
 - 1Ë- 
__s
;

1617 
	}
}

1623 
	#_HAVE_STRING_ARCH_°r•n
 1

	)

1624 
	#°r•n
(
s
, 
ac˚±
) \

1625 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
) &&  ((accept)[0]) == 1 \

1626 ? ((
ac˚±
)[0] == '\0' \

1627 ? ((Ë(
s
), 0) \

1628 : ((
ac˚±
)[1] == '\0' \

1629 ? 
	`__°r•n_c1
 ((
s
), (((
ac˚±
)[0] << 8 ) & 0xff00)) \

1630 : 
	`__°r•n_cg
 ((
s
), (
ac˚±
), 
	`°æí
 (accept)))) \

1631 : 
	`__°r•n_g
 ((
s
), (
ac˚±
))))

	)

1633 #i‚de‡
_FORCE_INLINES


1634 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
);

1636 
__STRING_INLINE
 
size_t


1637 
	$__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
)

1639 
__d0
;

1640 *
__ªs
;

1642 
__asm__
 
__vﬁ©ûe__


1648 : "Ù" (
__ªs
), "=&q" (
__d0
)

1649 : "0" (
__s
), "1" (
__ac˚±
),

1650 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1652  (
__ªs
 - 1Ë- 
__s
;

1653 
	}
}

1656 
__STRING_INLINE
 
size_t
 
__°r•n_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[],

1657 
size_t
 
__ac˚±_Àn
);

1659 
__STRING_INLINE
 
size_t


1660 
	$__°r•n_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[], 
size_t
 
__ac˚±_Àn
)

1662 
__d0
, 
__d1
, 
__d2
;

1663 c⁄° *
__ªs
;

1664 
__asm__
 
__vﬁ©ûe__


1675 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1676 : "0" (
__s
), "g" (
__ac˚±
), "g" (
__ac˚±_Àn
),

1679 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
),

1680 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__ac˚±_Àn
]; } *)
__ac˚±
)

1682  (
__ªs
 - 1Ë- 
__s
;

1683 
	}
}

1685 
__STRING_INLINE
 
size_t
 
__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
);

1686 #ifde‡
__PIC__


1688 
__STRING_INLINE
 
size_t


1689 
	$__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1691 
__d0
, 
__d1
, 
__d2
;

1692 c⁄° *
__ªs
;

1693 
__asm__
 
__vﬁ©ûe__


1709 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1710 : "d" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (__accept)

1712  (
__ªs
 - 1Ë- 
__s
;

1713 
	}
}

1715 
__STRING_INLINE
 
size_t


1716 
	$__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1718 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1719 c⁄° *
__ªs
;

1720 
__asm__
 
__vﬁ©ûe__


1734 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1735 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__ac˚±
), "b" (__accept)

1737  (
__ªs
 - 1Ë- 
__s
;

1738 
	}
}

1743 
	#_HAVE_STRING_ARCH_°Ωbrk
 1

	)

1744 
	#°Ωbrk
(
s
, 
ac˚±
) \

1745 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
) &&  ((accept)[0]) == 1 \

1746 ? ((
ac˚±
)[0] == '\0' \

1747 ? ((Ë(
s
), (*) 0) \

1748 : ((
ac˚±
)[1] == '\0' \

1749 ? 
	`°rchr
 ((
s
), (
ac˚±
)[0]) \

1750 : 
	`__°Ωbrk_cg
 ((
s
), (
ac˚±
), 
	`°æí
 (accept)))) \

1751 : 
	`__°Ωbrk_g
 ((
s
), (
ac˚±
))))

	)

1753 
__STRING_INLINE
 *
__°Ωbrk_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[],

1754 
size_t
 
__ac˚±_Àn
);

1756 
__STRING_INLINE
 *

1757 
	$__°Ωbrk_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[], 
size_t
 
__ac˚±_Àn
)

1759 
__d0
, 
__d1
, 
__d2
;

1760 *
__ªs
;

1761 
__asm__
 
__vﬁ©ûe__


1776 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1777 : "0" (
__s
), "d" (
__ac˚±
), "g" (
__ac˚±_Àn
)

1779  
__ªs
;

1780 
	}
}

1782 
__STRING_INLINE
 *
__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
);

1783 #ifde‡
__PIC__


1785 
__STRING_INLINE
 *

1786 
	$__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1788 
__d0
, 
__d1
, 
__d2
;

1789 *
__ªs
;

1790 
__asm__
 
__vﬁ©ûe__


1811 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1812 : "d" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1814  
__ªs
;

1815 
	}
}

1817 
__STRING_INLINE
 *

1818 
	$__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1820 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1821 *
__ªs
;

1822 
__asm__
 
__vﬁ©ûe__


1841 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

1842 : "0" (
__s
), "1" (0), "2" (0xffffffff), "b" (
__ac˚±
)

1844  
__ªs
;

1845 
	}
}

1850 
	#_HAVE_STRING_ARCH_°r°r
 1

	)

1851 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1852 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
) &&  ((needle)[0]) == 1 \

1853 ? ((
√edÀ
)[0] == '\0' \

1854 ? (
hay°ack
) \

1855 : ((
√edÀ
)[1] == '\0' \

1856 ? 
	`°rchr
 ((
hay°ack
), (
√edÀ
)[0]) \

1857 : 
	`__°r°r_cg
 ((
hay°ack
), (
√edÀ
), \

1858 
	`°æí
 (
√edÀ
)))) \

1859 : 
	`__°r°r_g
 ((
hay°ack
), (
√edÀ
))))

	)

1863 
__STRING_INLINE
 *
__°r°r_cg
 (c⁄° *
__hay°ack
,

1864 c⁄° 
__√edÀ
[],

1865 
size_t
 
__√edÀ_Àn
);

1867 
__STRING_INLINE
 *

1868 
	$__°r°r_cg
 (c⁄° *
__hay°ack
, c⁄° 
__√edÀ
[],

1869 
size_t
 
__√edÀ_Àn
)

1871 
__d0
, 
__d1
, 
__d2
;

1872 *
__ªs
;

1873 
__asm__
 
__vﬁ©ûe__


1886 : "=&a" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

1887 : "g" (
__√edÀ_Àn
), "1" (
__hay°ack
), "d" (
__√edÀ
)

1889  
__ªs
;

1890 
	}
}

1892 
__STRING_INLINE
 *
__°r°r_g
 (c⁄° *
__hay°ack
,

1893 c⁄° *
__√edÀ
);

1894 #ifde‡
__PIC__


1896 
__STRING_INLINE
 *

1897 
	$__°r°r_g
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

1899 
__d0
, 
__d1
, 
__d2
;

1900 *
__ªs
;

1901 
__asm__
 
__vﬁ©ûe__


1920 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
)

1921 : "0" (0), "1" (0xffffffff), "2" (
__hay°ack
), "3" (
__√edÀ
),

1922 "d" (
__√edÀ
)

1924  
__ªs
;

1925 
	}
}

1927 
__STRING_INLINE
 *

1928 
	$__°r°r_g
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

1930 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1931 *
__ªs
;

1932 
__asm__
 
__vﬁ©ûe__


1949 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1950 : "0" (0), "1" (0xffffffff), "2" (
__hay°ack
), "3" (
__√edÀ
),

1951 "b" (
__√edÀ
)

1953  
__ªs
;

1954 
	}
}

1960 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1961 #ifde‡
__i686__


1962 
	#_HAVE_STRING_ARCH_ffs
 1

	)

1963 
	#ffs
(
w‹d
Ë(
	`__buûtö_c⁄°™t_p
 (word) \

1964 ? 
	`__buûtö_ffs
 (
w‹d
) \

1965 : ({ 
__˙t
, 
__tmp
; \

1966 
__asm__
 
__vﬁ©ûe__
 \

1969 : "=&r" (
__˙t
), "Ù" (
__tmp
) \

1970 : "rm" (
w‹d
), "1" (-1)); \

1971 
__˙t
 + 1; }))

	)

1973 #i‚de‡
ff¶


1974 
	#ff¶
(
w‹d
Ë
	`ffs
(w‹d)

	)

1979 #i‚de‡
_FORCE_INLINES


1980 #unde‡
__STRING_INLINE


	@/usr/include/bits/string2.h

20 #i‚de‡
_STRING_H


24 #i‡!
deföed
 
__NO_STRING_INLINES
 && !deföed 
__BOUNDED_POINTERS__


41 #i‚de‡
__STRING_INLINE


42 #ifde‡
__˝lu•lus


43 
	#__STRING_INLINE
 
ölöe


	)

45 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

49 #i‡
_STRING_ARCH_u«lig√d


51 
	~<ídün.h
>

52 
	~<bôs/ty≥s.h
>

54 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


55 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

56 (((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1] << 8 \

57 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
])

	)

58 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

59 (((((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

60 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

61 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

62 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
])

	)

64 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

65 (((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
] << 8 \

66 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1])

	)

67 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

68 (((((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
] << 8 \

69 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

70 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

71 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 3])

	)

76 
	#__STRING2_COPY_TYPE
(
N
) \

77 °ru˘ { 
__¨r
[
N
]; } \

78 
	t__©åibuã__
 ((
	t__∑cked__
)Ë
	t__STRING2_COPY_ARR
##
	tN


	)

79 
	t__STRING2_COPY_TYPE
 (2);

80 
__STRING2_COPY_TYPE
 (3);

81 
__STRING2_COPY_TYPE
 (4);

82 
__STRING2_COPY_TYPE
 (5);

83 
__STRING2_COPY_TYPE
 (6);

84 
__STRING2_COPY_TYPE
 (7);

85 
__STRING2_COPY_TYPE
 (8);

86 #unde‡
__STRING2_COPY_TYPE


92 
	#__°rög2_1b±r_p
(
__x
) \

93 ((
size_t
)(c⁄° *)((
__x
Ë+ 1Ë- (size_t)(c⁄° *)(__xË=1)

	)

96 #i‡!
deföed
 
_HAVE_STRING_ARCH_mem£t


97 #i‡!
__GNUC_PREREQ
 (3, 0)

98 #i‡
_STRING_ARCH_u«lig√d


99 
	#mem£t
(
s
, 
c
, 
n
) \

100 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

101 ? ((
n
) == 1 \

102 ? 
	`__mem£t_1
 (
s
, 
c
) \

103 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

104 : (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

105 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

106 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

108 
	#__mem£t_1
(
s
, 
c
Ë({ *
__s
 = (s); \

109 *((
__uöt8_t
 *Ë
__s
Ë(__uöt8_tË
c
; __s; })

	)

111 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

112 ({ *
__s
 = (
s
); \

114 
__ui
; \

115 
__usi
; \

116 
__uc
; \

117 } *
__u
 = 
__s
; \

118 
__uöt8_t
 
__c
 = (__uöt8_tË(
c
); \

121 (Ë(
n
)) \

124 
__u
->
__ui
 = 
__c
 * 0x01010101; \

125 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

127 
__u
->
__ui
 = 
__c
 * 0x01010101; \

128 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

130 
__u
->
__ui
 = 
__c
 * 0x01010101; \

131 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

133 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

134 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

135 
__u
->
__uc
 = (Ë
__c
; \

139 
__u
->
__ui
 = 
__c
 * 0x01010101; \

140 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

142 
__u
->
__ui
 = 
__c
 * 0x01010101; \

143 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

145 
__u
->
__ui
 = 
__c
 * 0x01010101; \

146 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

148 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

152 
__u
->
__ui
 = 
__c
 * 0x01010101; \

153 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

155 
__u
->
__ui
 = 
__c
 * 0x01010101; \

156 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

158 
__u
->
__ui
 = 
__c
 * 0x01010101; \

159 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

161 
__u
->
__uc
 = (Ë
__c
; \

165 
__u
->
__ui
 = 
__c
 * 0x01010101; \

166 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

168 
__u
->
__ui
 = 
__c
 * 0x01010101; \

169 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

171 
__u
->
__ui
 = 
__c
 * 0x01010101; \

172 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

174 
__u
->
__ui
 = 
__c
 * 0x01010101; \

179 
__s
; })

	)

181 
	#mem£t
(
s
, 
c
, 
n
) \

182 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

183 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

184 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

193 #i‡
__GNUC_PREREQ
 (2, 91)

194 
	#__bzîo
(
s
, 
n
Ë
	`__buûtö_mem£t
 (s, '\0',Ç)

	)

202 #ifde‡
__USE_GNU


203 #i‡!
deföed
 
_HAVE_STRING_ARCH_memp˝y
 || deföed 
_FORCE_INLINES


204 #i‚de‡
_HAVE_STRING_ARCH_memp˝y


205 #i‡
__GNUC_PREREQ
 (3, 4)

206 
	#__memp˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_memp˝y
 (de°, src,Ç)

	)

207 #ñi‡
__GNUC_PREREQ
 (3, 0)

208 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

209 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

210 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

211 ? 
	`__buûtö_mem˝y
 (
de°
, 
§c
, 
n
) + (n) \

212 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

214 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

215 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

216 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

217 ? 
	`__memp˝y_smÆl
 (
de°
, 
	`__memp˝y_¨gs
 (
§c
), 
n
) \

218 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

222 
	#memp˝y
(
de°
, 
§c
, 
n
Ë
	`__memp˝y
 (de°, src,Ç)

	)

225 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


226 #i‡
_STRING_ARCH_u«lig√d


227 #i‚de‡
_FORCE_INLINES


228 
	#__memp˝y_¨gs
(
§c
) \

229 ((c⁄° *Ë(
§c
))[0], ((const *) (src))[2], \

230 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[6], \

231 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

232 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

233 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

234 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

236 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , , , ,

237 
__uöt16_t
, __uöt16_t, 
__uöt32_t
,

238 
__uöt32_t
, 
size_t
);

239 
__STRING_INLINE
 *

240 
	$__memp˝y_smÆl
 (*
__de°1
,

241 
__§c0_1
, 
__§c2_1
, 
__§c4_1
, 
__§c6_1
,

242 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

243 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

244 
size_t
 
__§˛í
)

247 
__uöt32_t
 
__ui
;

248 
__uöt16_t
 
__usi
;

249 
__uc
;

250 
__c
;

251 } *
__u
 = 
__de°1
;

252 (Ë
__§˛í
)

255 
__u
->
__c
 = 
__§c0_1
;

256 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

259 
__u
->
__usi
 = 
__§c0_2
;

260 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

263 
__u
->
__usi
 = 
__§c0_2
;

264 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

265 
__u
->
__c
 = 
__§c2_1
;

266 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

269 
__u
->
__ui
 = 
__§c0_4
;

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

273 
__u
->
__ui
 = 
__§c0_4
;

274 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

275 
__u
->
__c
 = 
__§c4_1
;

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

279 
__u
->
__ui
 = 
__§c0_4
;

280 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

281 
__u
->
__usi
 = 
__§c4_2
;

282 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

285 
__u
->
__ui
 = 
__§c0_4
;

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

287 
__u
->
__usi
 = 
__§c4_2
;

288 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

289 
__u
->
__c
 = 
__§c6_1
;

290 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

293 
__u
->
__ui
 = 
__§c0_4
;

294 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

295 
__u
->
__ui
 = 
__§c4_4
;

296 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

299  (*Ë
__u
;

300 
	}
}

302 #i‚de‡
_FORCE_INLINES


303 
	#__memp˝y_¨gs
(
§c
) \

304 ((c⁄° *Ë(
§c
))[0], \

305 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

306 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1] } }), \

307 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

308 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

309 ((c⁄° *Ë(
§c
))[2] } }), \

310 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

311 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

312 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3] } }), \

313 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

314 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

315 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

316 ((c⁄° *Ë(
§c
))[4] } }), \

317 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

318 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

319 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

320 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5] } }), \

321 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

322 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

323 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

324 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

325 ((c⁄° *Ë(
§c
))[6] } }), \

326 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

327 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

328 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

329 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

330 ((c⁄° *Ë(
§c
))[6], ((c⁄° *Ë(§c))[7] } })

	)

332 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , 
__STRING2_COPY_ARR2
,

333 
__STRING2_COPY_ARR3
,

334 
__STRING2_COPY_ARR4
,

335 
__STRING2_COPY_ARR5
,

336 
__STRING2_COPY_ARR6
,

337 
__STRING2_COPY_ARR7
,

338 
__STRING2_COPY_ARR8
, 
size_t
);

339 
__STRING_INLINE
 *

340 
	$__memp˝y_smÆl
 (*
__de°
, 
__§c1
,

341 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

342 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

343 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

344 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

347 
__c
;

348 
__STRING2_COPY_ARR2
 
__sˇ2
;

349 
__STRING2_COPY_ARR3
 
__sˇ3
;

350 
__STRING2_COPY_ARR4
 
__sˇ4
;

351 
__STRING2_COPY_ARR5
 
__sˇ5
;

352 
__STRING2_COPY_ARR6
 
__sˇ6
;

353 
__STRING2_COPY_ARR7
 
__sˇ7
;

354 
__STRING2_COPY_ARR8
 
__sˇ8
;

355 } *
__u
 = 
__de°
;

356 (Ë
__§˛í
)

359 
__u
->
__c
 = 
__§c1
;

362 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

365 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

368 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

371 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

374 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

377 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

380 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

383  
	`__exãnsi⁄__
 ((*Ë
__u
 + 
__§˛í
);

384 
	}
}

392 #i‚de‡
_HAVE_STRING_ARCH_°rchr


393 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

394 #i‡
__GNUC_PREREQ
 (3, 2)

395 
	#°rchr
(
s
, 
c
) \

396 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
Ë&& !__buûtö_c⁄°™t_∞(
s
) \

397 && (
c
) == '\0' \

398 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

399 : 
	`__buûtö_°rchr
 (
s
, 
c
)))

	)

401 
	#°rchr
(
s
, 
c
) \

402 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

403 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

404 : 
	`°rchr
 (
s
, 
c
)))

	)

410 #i‡(!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)) \

411 || 
deföed
 
	g_FORCE_INLINES


412 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)

413 
	#°r˝y
(
de°
, 
§c
) \

414 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

415 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

416 ? 
	`__°r˝y_smÆl
 (
de°
, 
	`__°r˝y_¨gs
 (
§c
), \

417 
	`°æí
 (
§c
) + 1) \

418 : (*Ë
	`mem˝y
 (
de°
, 
§c
, 
	`°æí
 (src) + 1)) \

419 : 
	`°r˝y
 (
de°
, 
§c
)))

	)

422 #i‡
_STRING_ARCH_u«lig√d


423 #i‚de‡
_FORCE_INLINES


424 
	#__°r˝y_¨gs
(
§c
) \

425 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

426 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

427 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

428 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

430 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

431 
__uöt32_t
, __uöt32_t, 
size_t
);

432 
__STRING_INLINE
 *

433 
	$__°r˝y_smÆl
 (*
__de°
,

434 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

435 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

436 
size_t
 
__§˛í
)

439 
__uöt32_t
 
__ui
;

440 
__uöt16_t
 
__usi
;

441 
__uc
;

442 } *
__u
 = (*Ë
__de°
;

443 (Ë
__§˛í
)

446 
__u
->
__uc
 = '\0';

449 
__u
->
__usi
 = 
__§c0_2
;

452 
__u
->
__usi
 = 
__§c0_2
;

453 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

454 
__u
->
__uc
 = '\0';

457 
__u
->
__ui
 = 
__§c0_4
;

460 
__u
->
__ui
 = 
__§c0_4
;

461 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

462 
__u
->
__uc
 = '\0';

465 
__u
->
__ui
 = 
__§c0_4
;

466 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

467 
__u
->
__usi
 = 
__§c4_2
;

470 
__u
->
__ui
 = 
__§c0_4
;

471 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

472 
__u
->
__usi
 = 
__§c4_2
;

473 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

474 
__u
->
__uc
 = '\0';

477 
__u
->
__ui
 = 
__§c0_4
;

478 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

479 
__u
->
__ui
 = 
__§c4_4
;

482  
__de°
;

483 
	}
}

485 #i‚de‡
_FORCE_INLINES


486 
	#__°r˝y_¨gs
(
§c
) \

487 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

488 { { ((c⁄° *Ë(
§c
))[0], '\0' } }), \

489 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

490 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

492 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

493 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

494 ((c⁄° *Ë(
§c
))[2], '\0' } }), \

495 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

496 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

497 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

499 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

500 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

501 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

502 ((c⁄° *Ë(
§c
))[4], '\0' } }), \

503 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

504 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

505 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

506 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

508 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

509 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

510 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

511 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

512 ((c⁄° *Ë(
§c
))[6], '\0' } })

	)

514 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

515 
__STRING2_COPY_ARR3
,

516 
__STRING2_COPY_ARR4
,

517 
__STRING2_COPY_ARR5
,

518 
__STRING2_COPY_ARR6
,

519 
__STRING2_COPY_ARR7
,

520 
__STRING2_COPY_ARR8
, 
size_t
);

521 
__STRING_INLINE
 *

522 
	$__°r˝y_smÆl
 (*
__de°
,

523 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

524 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

525 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

526 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

529 
__c
;

530 
__STRING2_COPY_ARR2
 
__sˇ2
;

531 
__STRING2_COPY_ARR3
 
__sˇ3
;

532 
__STRING2_COPY_ARR4
 
__sˇ4
;

533 
__STRING2_COPY_ARR5
 
__sˇ5
;

534 
__STRING2_COPY_ARR6
 
__sˇ6
;

535 
__STRING2_COPY_ARR7
 
__sˇ7
;

536 
__STRING2_COPY_ARR8
 
__sˇ8
;

537 } *
__u
 = (*Ë
__de°
;

538 (Ë
__§˛í
)

541 
__u
->
__c
 = '\0';

544 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

547 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

550 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

553 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

556 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

559 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

562 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

565  
__de°
;

566 
	}
}

572 #ifde‡
__USE_GNU


573 #i‡!
deföed
 
_HAVE_STRING_ARCH_°p˝y
 || deföed 
_FORCE_INLINES


574 #i‚de‡
_HAVE_STRING_ARCH_°p˝y


575 #i‡
__GNUC_PREREQ
 (3, 4)

576 
	#__°p˝y
(
de°
, 
§c
Ë
	`__buûtö_°p˝y
 (de°, src)

	)

577 #ñi‡
__GNUC_PREREQ
 (3, 0)

578 
	#__°p˝y
(
de°
, 
§c
) \

579 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

580 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

581 ? 
	`__buûtö_°r˝y
 (
de°
, 
§c
Ë+ 
	`°æí
 (src) \

582 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

584 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

586 
	#__°p˝y
(
de°
, 
§c
) \

587 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

588 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

589 ? 
	`__°p˝y_smÆl
 (
de°
, 
	`__°p˝y_¨gs
 (
§c
), \

590 
	`°æí
 (
§c
) + 1) \

591 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

593 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

597 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 (de°, src)

	)

600 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


601 #i‡
_STRING_ARCH_u«lig√d


602 #i‚de‡
_FORCE_INLINES


603 
	#__°p˝y_¨gs
(
§c
) \

604 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

605 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

606 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

607 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

609 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

610 
__uöt32_t
, __uöt32_t, 
size_t
);

611 
__STRING_INLINE
 *

612 
	$__°p˝y_smÆl
 (*
__de°
,

613 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

614 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

615 
size_t
 
__§˛í
)

618 
__ui
;

619 
__usi
;

620 
__uc
;

621 
__c
;

622 } *
__u
 = (*Ë
__de°
;

623 (Ë
__§˛í
)

626 
__u
->
__uc
 = '\0';

629 
__u
->
__usi
 = 
__§c0_2
;

630 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

633 
__u
->
__usi
 = 
__§c0_2
;

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

635 
__u
->
__uc
 = '\0';

638 
__u
->
__ui
 = 
__§c0_4
;

639 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

642 
__u
->
__ui
 = 
__§c0_4
;

643 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

644 
__u
->
__uc
 = '\0';

647 
__u
->
__ui
 = 
__§c0_4
;

648 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

649 
__u
->
__usi
 = 
__§c4_2
;

650 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

653 
__u
->
__ui
 = 
__§c0_4
;

654 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

655 
__u
->
__usi
 = 
__§c4_2
;

656 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

657 
__u
->
__uc
 = '\0';

660 
__u
->
__ui
 = 
__§c0_4
;

661 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

662 
__u
->
__ui
 = 
__§c4_4
;

663 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

666  &
__u
->
__c
;

667 
	}
}

669 #i‚de‡
_FORCE_INLINES


670 
	#__°p˝y_¨gs
(
§c
) \

671 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

672 { { ((c⁄° *Ë(
§c
))[0], '\0' } }), \

673 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

674 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

676 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

677 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

678 ((c⁄° *Ë(
§c
))[2], '\0' } }), \

679 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

680 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

681 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

683 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

684 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

685 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

686 ((c⁄° *Ë(
§c
))[4], '\0' } }), \

687 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

688 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

689 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

690 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

692 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

693 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

694 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

695 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

696 ((c⁄° *Ë(
§c
))[6], '\0' } })

	)

698 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

699 
__STRING2_COPY_ARR3
,

700 
__STRING2_COPY_ARR4
,

701 
__STRING2_COPY_ARR5
,

702 
__STRING2_COPY_ARR6
,

703 
__STRING2_COPY_ARR7
,

704 
__STRING2_COPY_ARR8
, 
size_t
);

705 
__STRING_INLINE
 *

706 
	$__°p˝y_smÆl
 (*
__de°
,

707 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

708 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

709 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

710 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

713 
__c
;

714 
__STRING2_COPY_ARR2
 
__sˇ2
;

715 
__STRING2_COPY_ARR3
 
__sˇ3
;

716 
__STRING2_COPY_ARR4
 
__sˇ4
;

717 
__STRING2_COPY_ARR5
 
__sˇ5
;

718 
__STRING2_COPY_ARR6
 
__sˇ6
;

719 
__STRING2_COPY_ARR7
 
__sˇ7
;

720 
__STRING2_COPY_ARR8
 
__sˇ8
;

721 } *
__u
 = (*Ë
__de°
;

722 (Ë
__§˛í
)

725 
__u
->
__c
 = '\0';

728 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

731 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

734 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

737 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

740 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

743 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

746 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

749  
__de°
 + 
__§˛í
 - 1;

750 
	}
}

758 #i‚de‡
_HAVE_STRING_ARCH_°∫˝y


759 #i‡
__GNUC_PREREQ
 (3, 2)

760 
	#°∫˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫˝y
 (de°, src,Ç)

	)

762 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

763 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

764 ? (
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

765 ? (*Ë
	`mem˝y
 (
de°
, 
§c
, 
n
) \

766 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)) \

767 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)))

	)

773 #i‚de‡
_HAVE_STRING_ARCH_°∫ˇt


774 #ifde‡
_USE_STRING_ARCH_°rchr


775 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

776 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

777 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

778 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

779 ? 
	`°rˇt
 (
__de°
, 
§c
) \

780 : (*((*Ë
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

781 
§c
, 
n
)Ë'\0', 
__de°
)) \

782 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
); }))

	)

783 #ñi‡
__GNUC_PREREQ
 (3, 2)

784 
	#°∫ˇt
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫ˇt
 (de°, src,Ç)

	)

786 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

787 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

788 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

789 ? 
	`°rˇt
 (
de°
, 
§c
) \

790 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)) \

791 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)))

	)

797 #i‚de‡
_HAVE_STRING_ARCH_°rcmp


798 #i‡
__GNUC_PREREQ
 (3, 2)

799 
	#°rcmp
(
s1
, 
s2
) \

800 
__exãnsi⁄__
 \

801 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

802 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

803 && (
__s1_Àn
 = 
	`__buûtö_°æí
 (
s1
), 
__s2_Àn
 = __buûtö_°æí (
s2
), \

804 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

805 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

806 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

807 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

808 && (
__s1_Àn
 = 
	`__buûtö_°æí
 (
s1
), __s1_len < 4) \

809 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

810 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

811 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

812 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

813 && (
__s2_Àn
 = 
	`__buûtö_°æí
 (
s2
), __s2_len < 4) \

814 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

815 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

816 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

817 : 
	`__buûtö_°rcmp
 (
s1
, 
s2
)))); })

	)

819 
	#°rcmp
(
s1
, 
s2
) \

820 
__exãnsi⁄__
 \

821 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

822 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

823 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

824 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

825 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

826 ? 
	`memcmp
 ((c⁄° *Ë(
s1
), (c⁄° *Ë(
s2
), \

827 (
__s1_Àn
 < 
__s2_Àn
 ? __s1_len : __s2_len) + 1) \

828 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

829 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

830 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

831 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s1_Àn
) \

832 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

833 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

834 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

835 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

836 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s2_Àn
) \

837 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

838 : 
	`°rcmp
 (
s1
, 
s2
)))); })

	)

841 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

842 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = \

843 (((c⁄° *Ë(c⁄° *Ë(
s1
))[0] \

844 - ((c⁄° *Ë(c⁄° *)(
s2
))[0]); \

845 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

847 
__ªsu…
 = (((const *) \

848 (c⁄° *Ë(
s1
))[1] \

850 (c⁄° *Ë(
s2
))[1]); \

851 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

853 
__ªsu…
 = \

855 (c⁄° *Ë(
s1
))[2] \

857 (c⁄° *Ë(
s2
))[2]); \

858 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

859 
__ªsu…
 = \

861 (c⁄° *Ë(
s1
))[3] \

863 (c⁄° *Ë(
s2
))[3]); \

866 
__ªsu…
; }))

	)

868 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

869 (
	`__exãnsi⁄__
 ({ c⁄° *
__s2
 = \

870 (c⁄° *Ë(c⁄° *Ë(
s2
); \

871 
__ªsu…
 = \

872 (((c⁄° *Ë(c⁄° *Ë(
s1
))[0] \

873 - 
__s2
[0]); \

874 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

876 
__ªsu…
 = (((const *) \

877 (c⁄° *Ë(
s1
))[1] - 
__s2
[1]); \

878 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

880 
__ªsu…
 = (((const *) \

881 (c⁄° *Ë(
s1
))[2] - 
__s2
[2]); \

882 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

883 
__ªsu…
 = (((const *) \

884 (c⁄° *Ë(
s1
))[3] \

885 - 
__s2
[3]); \

888 
__ªsu…
; }))

	)

890 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

891 (
	`__exãnsi⁄__
 ({ c⁄° *
__s1
 = \

892 (c⁄° *Ë(c⁄° *Ë(
s1
); \

893 
__ªsu…
 = \

894 
__s1
[0] - ((const *) \

895 (c⁄° *Ë(
s2
))[0]; \

896 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

898 
__ªsu…
 = (
__s1
[1] \

900 (c⁄° *Ë(
s2
))[1]); \

901 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

903 
__ªsu…
 = \

904 (
__s1
[2] - ((const *) \

905 (c⁄° *Ë(
s2
))[2]); \

906 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

907 
__ªsu…
 = \

908 (
__s1
[3] \

910 (c⁄° *Ë(
s2
))[3]); \

913 
__ªsu…
; }))

	)

918 #i‚de‡
_HAVE_STRING_ARCH_°∫cmp


919 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

920 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

921 && ((
	`__buûtö_c⁄°™t_p
 (
s1
) \

922 && 
	`°æí
 (
s1
Ë< ((
size_t
Ë(
n
))) \

923 || (
	`__buûtö_c⁄°™t_p
 (
s2
) \

924 && 
	`°æí
 (
s2
Ë< ((
size_t
Ë(
n
)))) \

925 ? 
	`°rcmp
 (
s1
, 
s2
Ë: 
	`°∫cmp
 (s1, s2, 
n
)))

	)

931 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rc•n
 || deföed 
_FORCE_INLINES


932 #i‚de‡
_HAVE_STRING_ARCH_°rc•n


933 #i‡
__GNUC_PREREQ
 (3, 2)

934 
	#°rc•n
(
s
, 
ªje˘
) \

935 
__exãnsi⁄__
 \

936 ({ 
__r0
, 
__r1
, 
__r2
; \

937 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

938 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

939 ? 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
) \

940 : ((
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], __r0 == '\0') \

941 ? 
	`°æí
 (
s
) \

942 : ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], __r1 == '\0') \

943 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

944 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

945 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

946 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

947 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

948 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)))))) \

949 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)); })

	)

951 
	#°rc•n
(
s
, 
ªje˘
) \

952 
__exãnsi⁄__
 \

953 ({ 
__r0
, 
__r1
, 
__r2
; \

954 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

955 ? ((
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], __r0 == '\0') \

956 ? 
	`°æí
 (
s
) \

957 : ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], __r1 == '\0') \

958 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

959 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

960 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

961 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

962 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

963 : 
	`°rc•n
 (
s
, 
ªje˘
))))) \

964 : 
	`°rc•n
 (
s
, 
ªje˘
)); })

	)

968 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
);

969 
__STRING_INLINE
 
size_t


970 
	$__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
)

972 
size_t
 
__ªsu…
 = 0;

973 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘
)

974 ++
__ªsu…
;

975  
__ªsu…
;

976 
	}
}

978 
__STRING_INLINE
 
size_t
 
__°rc•n_c2
 (c⁄° *
__s
, 
__ªje˘1
,

979 
__ªje˘2
);

980 
__STRING_INLINE
 
size_t


981 
	$__°rc•n_c2
 (c⁄° *
__s
, 
__ªje˘1
, 
__ªje˘2
)

983 
size_t
 
__ªsu…
 = 0;

984 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


985 && 
__s
[
__ªsu…
] !
__ªje˘2
)

986 ++
__ªsu…
;

987  
__ªsu…
;

988 
	}
}

990 
__STRING_INLINE
 
size_t
 
__°rc•n_c3
 (c⁄° *
__s
, 
__ªje˘1
,

991 
__ªje˘2
, 
__ªje˘3
);

992 
__STRING_INLINE
 
size_t


993 
	$__°rc•n_c3
 (c⁄° *
__s
, 
__ªje˘1
, 
__ªje˘2
,

994 
__ªje˘3
)

996 
size_t
 
__ªsu…
 = 0;

997 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


998 && 
__s
[
__ªsu…
] !
__ªje˘2
 && __s[__ªsu…] !
__ªje˘3
)

999 ++
__ªsu…
;

1000  
__ªsu…
;

1001 
	}
}

1007 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r•n
 || deföed 
_FORCE_INLINES


1008 #i‚de‡
_HAVE_STRING_ARCH_°r•n


1009 #i‡
__GNUC_PREREQ
 (3, 2)

1010 
	#°r•n
(
s
, 
ac˚±
) \

1011 
__exãnsi⁄__
 \

1012 ({ 
__a0
, 
__a1
, 
__a2
; \

1013 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1014 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1015 ? 
	`__buûtö_°r•n
 (
s
, 
ac˚±
) \

1016 : ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1017 ? ((Ë(
s
), (
size_t
) 0) \

1018 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1019 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1020 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1021 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1022 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1023 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1024 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)))))) \

1025 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)); })

	)

1027 
	#°r•n
(
s
, 
ac˚±
) \

1028 
__exãnsi⁄__
 \

1029 ({ 
__a0
, 
__a1
, 
__a2
; \

1030 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1031 ? ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1032 ? ((Ë(
s
), (
size_t
) 0) \

1033 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1034 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1035 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1036 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1037 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1038 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1039 : 
	`°r•n
 (
s
, 
ac˚±
))))) \

1040 : 
	`°r•n
 (
s
, 
ac˚±
)); })

	)

1044 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
);

1045 
__STRING_INLINE
 
size_t


1046 
	$__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
)

1048 
size_t
 
__ªsu…
 = 0;

1050 
__s
[
__ªsu…
] =
__ac˚±
)

1051 ++
__ªsu…
;

1052  
__ªsu…
;

1053 
	}
}

1055 
__STRING_INLINE
 
size_t
 
__°r•n_c2
 (c⁄° *
__s
, 
__ac˚±1
,

1056 
__ac˚±2
);

1057 
__STRING_INLINE
 
size_t


1058 
	$__°r•n_c2
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1060 
size_t
 
__ªsu…
 = 0;

1062 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2
)

1063 ++
__ªsu…
;

1064  
__ªsu…
;

1065 
	}
}

1067 
__STRING_INLINE
 
size_t
 
__°r•n_c3
 (c⁄° *
__s
, 
__ac˚±1
,

1068 
__ac˚±2
, 
__ac˚±3
);

1069 
__STRING_INLINE
 
size_t


1070 
	$__°r•n_c3
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1072 
size_t
 
__ªsu…
 = 0;

1074 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2


1075 || 
__s
[
__ªsu…
] =
__ac˚±3
)

1076 ++
__ªsu…
;

1077  
__ªsu…
;

1078 
	}
}

1083 #i‡!
deföed
 
_HAVE_STRING_ARCH_°Ωbrk
 || deföed 
_FORCE_INLINES


1084 #i‚de‡
_HAVE_STRING_ARCH_°Ωbrk


1085 #i‡
__GNUC_PREREQ
 (3, 2)

1086 
	#°Ωbrk
(
s
, 
ac˚±
) \

1087 
__exãnsi⁄__
 \

1088 ({ 
__a0
, 
__a1
, 
__a2
; \

1089 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1090 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1091 ? 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
) \

1092 : ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1093 ? ((Ë(
s
), (*Ë
NULL
) \

1094 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1095 ? 
	`__buûtö_°rchr
 (
s
, 
__a0
) \

1096 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1097 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1098 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1099 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1100 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)))))) \

1101 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1103 
	#°Ωbrk
(
s
, 
ac˚±
) \

1104 
__exãnsi⁄__
 \

1105 ({ 
__a0
, 
__a1
, 
__a2
; \

1106 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1107 ? ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1108 ? ((Ë(
s
), (*Ë
NULL
) \

1109 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1110 ? 
	`°rchr
 (
s
, 
__a0
) \

1111 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1112 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1113 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1114 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1115 : 
	`°Ωbrk
 (
s
, 
ac˚±
))))) \

1116 : 
	`°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1120 
__STRING_INLINE
 *
__°Ωbrk_c2
 (c⁄° *
__s
, 
__ac˚±1
,

1121 
__ac˚±2
);

1122 
__STRING_INLINE
 *

1123 
	$__°Ωbrk_c2
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1126 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2
)

1127 ++
__s
;

1128  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1129 
	}
}

1131 
__STRING_INLINE
 *
__°Ωbrk_c3
 (c⁄° *
__s
, 
__ac˚±1
,

1132 
__ac˚±2
, 
__ac˚±3
);

1133 
__STRING_INLINE
 *

1134 
	$__°Ωbrk_c3
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1137 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2


1138 && *
__s
 !
__ac˚±3
)

1139 ++
__s
;

1140  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1141 
	}
}

1147 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r°r
 && !
__GNUC_PREREQ
 (2, 97)

1148 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1149 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
Ë&& 
	`__°rög2_1b±r_p
 (needle) \

1150 ? (((c⁄° *Ë(
√edÀ
))[0] == '\0' \

1151 ? (*Ë(
size_t
Ë(
hay°ack
) \

1152 : (((c⁄° *Ë(
√edÀ
))[1] == '\0' \

1153 ? 
	`°rchr
 (
hay°ack
, \

1154 ((c⁄° *Ë(
√edÀ
))[0]) \

1155 : 
	`°r°r
 (
hay°ack
, 
√edÀ
))) \

1156 : 
	`°r°r
 (
hay°ack
, 
√edÀ
)))

	)

1160 #i‡!
deföed
 
_HAVE_STRING_ARCH_°πok_r
 || deföed 
_FORCE_INLINES


1161 #i‚de‡
_HAVE_STRING_ARCH_°πok_r


1162 
	#__°πok_r
(
s
, 
£p
, 
√xç
) \

1163 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
£p
Ë&& 
	`__°rög2_1b±r_p
 (sep) \

1164 && ((c⁄° *Ë(
£p
))[0] != '\0' \

1165 && ((c⁄° *Ë(
£p
))[1] == '\0' \

1166 ? 
	`__°πok_r_1c
 (
s
, ((c⁄° *Ë(
£p
))[0], 
√xç
) \

1167 : 
	`__°πok_r
 (
s
, 
£p
, 
√xç
)))

	)

1170 
__STRING_INLINE
 *
__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
);

1171 
__STRING_INLINE
 *

1172 
	$__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
)

1174 *
__ªsu…
;

1175 i‡(
__s
 =
NULL
)

1176 
__s
 = *
__√xç
;

1177 *
__s
 =
__£p
)

1178 ++
__s
;

1179 
__ªsu…
 = 
NULL
;

1180 i‡(*
__s
 != '\0')

1182 
__ªsu…
 = 
__s
++;

1183 *
__s
 != '\0')

1184 i‡(*
__s
++ =
__£p
)

1186 
__s
[-1] = '\0';

1190 *
__√xç
 = 
__s
;

1191  
__ªsu…
;

1192 
	}
}

1193 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


1194 
	#°πok_r
(
s
, 
£p
, 
√xç
Ë
	`__°πok_r
 (s, sï,Çexç)

	)

1199 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r£p
 || deföed 
_FORCE_INLINES


1200 #i‚de‡
_HAVE_STRING_ARCH_°r£p


1202 *
__°r£p_g
 (**
__°rögp
, c⁄° *
__dñim
);

1203 
	#__°r£p
(
s
, 
ªje˘
) \

1204 
__exãnsi⁄__
 \

1205 ({ 
__r0
, 
__r1
, 
__r2
; \

1206 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

1207 && (
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], \

1208 ((c⁄° *Ë(
ªje˘
))[0] != '\0') \

1209 ? ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], \

1210 ((c⁄° *Ë(
ªje˘
))[1] == '\0') \

1211 ? 
	`__°r£p_1c
 (
s
, 
__r0
) \

1212 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

1213 ? 
	`__°r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1214 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

1215 ? 
	`__°r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1216 : 
	`__°r£p_g
 (
s
, 
ªje˘
)))) \

1217 : 
	`__°r£p_g
 (
s
, 
ªje˘
)); })

	)

1220 
__STRING_INLINE
 *
__°r£p_1c
 (**
__s
, 
__ªje˘
);

1221 
__STRING_INLINE
 *

1222 
	$__°r£p_1c
 (**
__s
, 
__ªje˘
)

1224 *
__ªtvÆ
 = *
__s
;

1225 i‡(
__ªtvÆ
 !
NULL
 && (*
__s
 = 
	`°rchr
 (__ªtvÆ, 
__ªje˘
)) != NULL)

1226 *(*
__s
)++ = '\0';

1227  
__ªtvÆ
;

1228 
	}
}

1230 
__STRING_INLINE
 *
__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
);

1231 
__STRING_INLINE
 *

1232 
	$__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
)

1234 *
__ªtvÆ
 = *
__s
;

1235 i‡(
__ªtvÆ
 !
NULL
)

1237 *
__˝
 = 
__ªtvÆ
;

1240 i‡(*
__˝
 == '\0')

1242 
__˝
 = 
NULL
;

1245 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
)

1247 *
__˝
++ = '\0';

1250 ++
__˝
;

1252 *
__s
 = 
__˝
;

1254  
__ªtvÆ
;

1255 
	}
}

1257 
__STRING_INLINE
 *
__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
,

1258 
__ªje˘3
);

1259 
__STRING_INLINE
 *

1260 
	$__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
, 
__ªje˘3
)

1262 *
__ªtvÆ
 = *
__s
;

1263 i‡(
__ªtvÆ
 !
NULL
)

1265 *
__˝
 = 
__ªtvÆ
;

1268 i‡(*
__˝
 == '\0')

1270 
__˝
 = 
NULL
;

1273 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
 || *__˝ =
__ªje˘3
)

1275 *
__˝
++ = '\0';

1278 ++
__˝
;

1280 *
__s
 = 
__˝
;

1282  
__ªtvÆ
;

1283 
	}
}

1284 #ifde‡
__USE_BSD


1285 
	#°r£p
(
s
, 
ªje˘
Ë
	`__°r£p
 (s,Ñeje˘)

	)

1292 #ifde‡
__USE_MISC


1294 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rdup
 || !deföed 
_HAVE_STRING_ARCH_°∫dup


1295 
	#__√ed_mÆloc_™d_ˇŒoc


	)

1296 
	~<°dlib.h
>

1299 #i‚de‡
_HAVE_STRING_ARCH_°rdup


1301 *
	$__°rdup
 (c⁄° *
__°rög
Ë
__THROW
 
__©åibuã_mÆloc__
;

1302 
	#__°rdup
(
s
) \

1303 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1304 ? (((c⁄° *Ë(
s
))[0] == '\0' \

1305 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1306 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1307 *
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1308 i‡(
__ªtvÆ
 !
NULL
) \

1309 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, 
__Àn
); \

1310 
__ªtvÆ
; 
	}
})) \

1311 : 
	`__°rdup
 (
s
)))

	)

1313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1314 
	#°rdup
(
s
Ë
	`__°rdup
 (s)

	)

1318 #i‚de‡
_HAVE_STRING_ARCH_°∫dup


1320 *
	$__°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

1321 
__THROW
 
__©åibuã_mÆloc__
;

1322 
	#__°∫dup
(
s
, 
n
) \

1323 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1324 ? (((c⁄° *Ë(
s
))[0] == '\0' \

1325 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1326 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1327 
size_t
 
__n
 = (
n
); \

1328 *
__ªtvÆ
; \

1329 i‡(
__n
 < 
__Àn
) \

1330 
__Àn
 = 
__n
 + 1; \

1331 
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1332 i‡(
__ªtvÆ
 !
NULL
) \

1334 
__ªtvÆ
[
__Àn
 - 1] = '\0'; \

1335 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, \

1336 
__Àn
 - 1); \

1338 
__ªtvÆ
; 
	}
})) \

1339 : 
	`__°∫dup
 (
s
, 
n
)))

	)

1341 #ifde‡
__USE_GNU


1342 
	#°∫dup
(
s
, 
n
Ë
	`__°∫dup
 (s,Ç)

	)

1348 #i‚de‡
_FORCE_INLINES


1349 #unde‡
__STRING_INLINE


	@/usr/include/bits/string3.h

18 #i‚de‡
_STRING_H


22 
__w¨nde˛
 (
__w¨n_mem£t_zîo_Àn
,

25 #i‚de‡
__˝lu•lus


29 #unde‡
mem˝y


30 #unde‡
memmove


31 #unde‡
mem£t


32 #unde‡
°rˇt


33 #unde‡
°r˝y


34 #unde‡
°∫ˇt


35 #unde‡
°∫˝y


36 #ifde‡
__USE_GNU


37 #unde‡
memp˝y


38 #unde‡
°p˝y


40 #ifde‡
__USE_BSD


41 #unde‡
bc›y


42 #unde‡
bzîo


47 
__f‹tify_fun˘i⁄
 *

48 
__NTH
 (
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

49 
size_t
 
__Àn
))

51  
	`__buûtö___mem˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

52 
	}
}

54 
__f‹tify_fun˘i⁄
 *

55 
__NTH
 (
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__Àn
))

57  
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

58 
	}
}

60 #ifde‡
__USE_GNU


61 
__f‹tify_fun˘i⁄
 *

62 
__NTH
 (
	$memp˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

63 
size_t
 
__Àn
))

65  
	`__buûtö___memp˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

66 
	}
}

75 
__f‹tify_fun˘i⁄
 *

76 
__NTH
 (
	$mem£t
 (*
__de°
, 
__ch
, 
size_t
 
__Àn
))

78 i‡(
	`__buûtö_c⁄°™t_p
 (
__Àn
) && __len == 0

79 && (!
	`__buûtö_c⁄°™t_p
 (
__ch
) || __ch != 0))

81 
	`__w¨n_mem£t_zîo_Àn
 ();

82  
__de°
;

84  
	`__buûtö___mem£t_chk
 (
__de°
, 
__ch
, 
__Àn
, 
	`__bos0
 (__dest));

85 
	}
}

87 #ifde‡
__USE_BSD


88 
__f‹tify_fun˘i⁄
 

89 
__NTH
 (
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__Àn
))

91 (Ë
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

92 
	}
}

94 
__f‹tify_fun˘i⁄
 

95 
__NTH
 (
	$bzîo
 (*
__de°
, 
size_t
 
__Àn
))

97 (Ë
	`__buûtö___mem£t_chk
 (
__de°
, '\0', 
__Àn
, 
	`__bos0
 (__dest));

98 
	}
}

101 
__f‹tify_fun˘i⁄
 *

102 
__NTH
 (
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

104  
	`__buûtö___°r˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

105 
	}
}

107 #ifde‡
__USE_GNU


108 
__f‹tify_fun˘i⁄
 *

109 
__NTH
 (
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

111  
	`__buûtö___°p˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

112 
	}
}

116 
__f‹tify_fun˘i⁄
 *

117 
__NTH
 (
	$°∫˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

118 
size_t
 
__Àn
))

120  
	`__buûtö___°∫˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

121 
	}
}

124 *
	$__°≤˝y_chk
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

125 
size_t
 
__de°Àn
Ë
__THROW
;

126 *
	`__REDIRECT_NTH
 (
__°≤˝y_Æüs
, (*
__de°
, c⁄° *
__§c
,

127 
size_t
 
__n
), 
°≤˝y
);

129 
__f‹tify_fun˘i⁄
 *

130 
	`__NTH
 (
	$°≤˝y
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
))

132 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1

133 && (!
	`__buûtö_c⁄°™t_p
 (
__n
Ë|| __¿<
	`__bos
 (
__de°
)))

134  
	`__°≤˝y_chk
 (
__de°
, 
__§c
, 
__n
, 
	`__bos
 (__dest));

135  
	`__°≤˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

136 
	}
}

139 
__f‹tify_fun˘i⁄
 *

140 
__NTH
 (
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

142  
	`__buûtö___°rˇt_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

143 
	}
}

146 
__f‹tify_fun˘i⁄
 *

147 
__NTH
 (
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

148 
size_t
 
__Àn
))

150  
	`__buûtö___°∫ˇt_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

151 
	}
}

	@/usr/include/bits/types.h

23 #i‚def 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/w‹dsize.h
>

30 
	t__u_ch¨
;

31 
	t__u_sh‹t
;

32 
	t__u_öt
;

33 
	t__u_l⁄g
;

36 sig√d 
	t__öt8_t
;

37 
	t__uöt8_t
;

38 sig√d 
	t__öt16_t
;

39 
	t__uöt16_t
;

40 sig√d 
	t__öt32_t
;

41 
	t__uöt32_t
;

42 #i‡
__WORDSIZE
 == 64

43 sig√d 
	t__öt64_t
;

44 
	t__uöt64_t
;

45 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


46 
__exãnsi⁄__
 sig√d 
	t__öt64_t
;

47 
__exãnsi⁄__
 
	t__uöt64_t
;

51 #i‡
__WORDSIZE
 == 64

52 
	t__quad_t
;

53 
	t__u_quad_t
;

54 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


55 
__exãnsi⁄__
 
	t__quad_t
;

56 
__exãnsi⁄__
 
	t__u_quad_t
;

60 
	m__vÆ
[2];

61 } 
	t__quad_t
;

64 
__u_l⁄g
 
	m__vÆ
[2];

65 } 
	t__u_quad_t
;

98 
	#__S16_TYPE
 

	)

99 
	#__U16_TYPE
 

	)

100 
	#__S32_TYPE
 

	)

101 
	#__U32_TYPE
 

	)

102 
	#__SLONGWORD_TYPE
 

	)

103 
	#__ULONGWORD_TYPE
 

	)

104 #i‡
__WORDSIZE
 == 32

105 
	#__SQUAD_TYPE
 
__quad_t


	)

106 
	#__UQUAD_TYPE
 
__u_quad_t


	)

107 
	#__SWORD_TYPE
 

	)

108 
	#__UWORD_TYPE
 

	)

109 
	#__SLONG32_TYPE
 

	)

110 
	#__ULONG32_TYPE
 

	)

111 
	#__S64_TYPE
 
__quad_t


	)

112 
	#__U64_TYPE
 
__u_quad_t


	)

115 
	#__STD_TYPE
 
__exãnsi⁄__
 

	)

116 #ñi‡
__WORDSIZE
 == 64

117 
	t__SQUAD_TYPE
 

	)

118 
	t__UQUAD_TYPE
 

	)

119 
	t__SWORD_TYPE
 

	)

120 
	t__UWORD_TYPE
 

	)

121 
	t__SLONG32_TYPE
 

	)

122 
	t__ULONG32_TYPE
 

	)

123 
	t__S64_TYPE
 

	)

124 
	t__U64_TYPE
 

	)

126 
	t__STD_TYPE
 

	)

130 
	~<bôs/ty≥sizes.h
>

133 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

134 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

135 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

136 
__STD_TYPE
 
__INO_T_TYPE
 
	g__öo_t
;

137 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__öo64_t
;

138 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

139 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__∆ök_t
;

140 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

141 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

142 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

143 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

144 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__˛ock_t
;

145 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__æim_t
;

146 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__æim64_t
;

147 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

148 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

149 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£c⁄ds_t
;

150 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£c⁄ds_t
;

152 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

153 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

156 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__˛ockid_t
;

159 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__timî_t
;

162 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

167 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blk˙t_t
;

168 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blk˙t64_t
;

171 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblk˙t_t
;

172 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblk˙t64_t
;

175 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfû˙t_t
;

176 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfû˙t64_t
;

179 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fsw‹d_t
;

181 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysˇŒ_¶⁄g_t
;

186 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysˇŒ_ul⁄g_t
;

190 
__off64_t
 
	t__loff_t
;

191 
__quad_t
 *
	t__qaddr_t
;

192 *
	t__ˇddr_t
;

195 
__STD_TYPE
 
__SWORD_TYPE
 
	g__öçå_t
;

198 
__STD_TYPE
 
__U32_TYPE
 
	g__sockÀn_t
;

201 #unde‡
__STD_TYPE


	@/usr/include/bits/wordsize.h

3 #i‡
deföed
 
__x86_64__
 && !deföed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

9 #ifde‡
__x86_64__


10 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

12 
	#__SYSCALL_WORDSIZE
 64

	)

	@/usr/include/bits/xopen_lim.h

29 #i‚de‡
_XOPEN_LIM_H


30 
	#_XOPEN_LIM_H
 1

	)

32 
	#__√ed_IOV_MAX


	)

33 
	~<bôs/°dio_lim.h
>

65 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

70 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

73 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

76 
	#NL_MSGMAX
 
INT_MAX


	)

80 
	#NL_NMAX
 
INT_MAX


	)

83 
	#NL_SETMAX
 
INT_MAX


	)

86 
	#NL_TEXTMAX
 
INT_MAX


	)

89 
	#NZERO
 20

	)

93 #ifde‡
INT_MAX


94 #i‡
INT_MAX
 == 32767

95 
	#WORD_BIT
 16

	)

97 #i‡
INT_MAX
 == 2147483647

98 
	#WORD_BIT
 32

	)

101 
	#WORD_BIT
 64

	)

104 #ñi‡
deföed
 
__INT_MAX__


105 #i‡
__INT_MAX__
 == 32767

106 
	#WORD_BIT
 16

	)

108 #i‡
__INT_MAX__
 == 2147483647

109 
	#WORD_BIT
 32

	)

112 
	#WORD_BIT
 64

	)

116 
	#WORD_BIT
 32

	)

120 #ifde‡
LONG_MAX


121 #i‡
LONG_MAX
 == 2147483647

122 
	#LONG_BIT
 32

	)

125 
	#LONG_BIT
 64

	)

127 #ñi‡
deföed
 
__LONG_MAX__


128 #i‡
__LONG_MAX__
 == 2147483647

129 
	#LONG_BIT
 32

	)

132 
	#LONG_BIT
 64

	)

135 
	~<bôs/w‹dsize.h
>

136 #i‡
__WORDSIZE
 == 64

137 
	#LONG_BIT
 64

	)

139 
	#LONG_BIT
 32

	)

	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 #i‡
__GLIBC_HAVE_LONG_LONG


74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë(x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë(x)

	)

81 
	#htobe16
(
x
Ë(x)

	)

82 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

83 
	#be16toh
(
x
Ë(x)

	)

84 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

86 
	#htobe32
(
x
Ë(x)

	)

87 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

88 
	#be32toh
(
x
Ë(x)

	)

89 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

91 #i‡
__GLIBC_HAVE_LONG_LONG


92 
	#htobe64
(
x
Ë(x)

	)

93 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

94 
	#be64toh
(
x
Ë(x)

	)

95 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

98 #unde‡
__USE_ISOC11


99 #unde‡
__USE_ISOC99


100 #unde‡
__USE_ISOC95


101 #unde‡
__USE_ISOCXX11


102 #unde‡
__USE_POSIX


103 #unde‡
__USE_POSIX2


104 #unde‡
__USE_POSIX199309


105 #unde‡
__USE_POSIX199506


106 #unde‡
__USE_XOPEN


107 #unde‡
__USE_XOPEN_EXTENDED


108 #unde‡
__USE_UNIX98


109 #unde‡
__USE_XOPEN2K


110 #unde‡
__USE_XOPEN2KXSI


111 #unde‡
__USE_XOPEN2K8


112 #unde‡
__USE_XOPEN2K8XSI


113 #unde‡
__USE_LARGEFILE


114 #unde‡
__USE_LARGEFILE64


115 #unde‡
__USE_FILE_OFFSET64


116 #unde‡
__USE_BSD


117 #unde‡
__USE_SVID


118 #unde‡
__USE_MISC


119 #unde‡
__USE_ATFILE


120 #unde‡
__USE_GNU


121 #unde‡
__USE_REENTRANT


122 #unde‡
__USE_FORTIFY_LEVEL


123 #unde‡
__FAVOR_BSD


124 #unde‡
__KERNEL_STRICT_NAMES


128 #i‚de‡
_LOOSE_KERNEL_NAMES


129 
	#__KERNEL_STRICT_NAMES


	)

133 
	#__USE_ANSI
 1

	)

142 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


143 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

144 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

146 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

151 #i‡
deföed
 
_BSD_SOURCE
 && \

152 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

153 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

154 
	#__FAVOR_BSD
 1

	)

158 #ifde‡
_GNU_SOURCE


159 #unde‡
_ISOC95_SOURCE


160 
	#_ISOC95_SOURCE
 1

	)

161 #unde‡
_ISOC99_SOURCE


162 
	#_ISOC99_SOURCE
 1

	)

163 #unde‡
_ISOC11_SOURCE


164 
	#_ISOC11_SOURCE
 1

	)

165 #unde‡
_POSIX_SOURCE


166 
	#_POSIX_SOURCE
 1

	)

167 #unde‡
_POSIX_C_SOURCE


168 
	#_POSIX_C_SOURCE
 200809L

	)

169 #unde‡
_XOPEN_SOURCE


170 
	#_XOPEN_SOURCE
 700

	)

171 #unde‡
_XOPEN_SOURCE_EXTENDED


172 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

173 #unde‡
_LARGEFILE64_SOURCE


174 
	#_LARGEFILE64_SOURCE
 1

	)

175 #unde‡
_BSD_SOURCE


176 
	#_BSD_SOURCE
 1

	)

177 #unde‡
_SVID_SOURCE


178 
	#_SVID_SOURCE
 1

	)

179 #unde‡
_ATFILE_SOURCE


180 
	#_ATFILE_SOURCE
 1

	)

185 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

186 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

187 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

188 
	#_BSD_SOURCE
 1

	)

189 
	#_SVID_SOURCE
 1

	)

193 #i‡(
deföed
 
_ISOC11_SOURCE
 \

194 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

195 
	#__USE_ISOC11
 1

	)

199 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

200 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

201 
	#__USE_ISOC99
 1

	)

205 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

206 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

207 
	#__USE_ISOC95
 1

	)

214 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

215 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

216 
	#__USE_ISOCXX11
 1

	)

221 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

222 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

223 
	#_POSIX_SOURCE
 1

	)

224 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

225 
	#_POSIX_C_SOURCE
 2

	)

226 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

227 
	#_POSIX_C_SOURCE
 199506L

	)

228 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

229 
	#_POSIX_C_SOURCE
 200112L

	)

231 
	#_POSIX_C_SOURCE
 200809L

	)

233 
	#__USE_POSIX_IMPLICITLY
 1

	)

236 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


237 
	#__USE_POSIX
 1

	)

240 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


241 
	#__USE_POSIX2
 1

	)

244 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

245 
	#__USE_POSIX199309
 1

	)

248 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

249 
	#__USE_POSIX199506
 1

	)

252 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

253 
	#__USE_XOPEN2K
 1

	)

254 #unde‡
__USE_ISOC95


255 
	#__USE_ISOC95
 1

	)

256 #unde‡
__USE_ISOC99


257 
	#__USE_ISOC99
 1

	)

260 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

261 
	#__USE_XOPEN2K8
 1

	)

262 #unde‡
_ATFILE_SOURCE


263 
	#_ATFILE_SOURCE
 1

	)

266 #ifdef 
_XOPEN_SOURCE


267 
	#__USE_XOPEN
 1

	)

268 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

269 
	#__USE_XOPEN_EXTENDED
 1

	)

270 
	#__USE_UNIX98
 1

	)

271 #unde‡
_LARGEFILE_SOURCE


272 
	#_LARGEFILE_SOURCE
 1

	)

273 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

274 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

275 
	#__USE_XOPEN2K8
 1

	)

276 
	#__USE_XOPEN2K8XSI
 1

	)

278 
	#__USE_XOPEN2K
 1

	)

279 
	#__USE_XOPEN2KXSI
 1

	)

280 #unde‡
__USE_ISOC95


281 
	#__USE_ISOC95
 1

	)

282 #unde‡
__USE_ISOC99


283 
	#__USE_ISOC99
 1

	)

286 #ifde‡
_XOPEN_SOURCE_EXTENDED


287 
	#__USE_XOPEN_EXTENDED
 1

	)

292 #ifde‡
_LARGEFILE_SOURCE


293 
	#__USE_LARGEFILE
 1

	)

296 #ifde‡
_LARGEFILE64_SOURCE


297 
	#__USE_LARGEFILE64
 1

	)

300 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

301 
	#__USE_FILE_OFFSET64
 1

	)

304 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


305 
	#__USE_MISC
 1

	)

308 #ifdef 
_BSD_SOURCE


309 
	#__USE_BSD
 1

	)

312 #ifdef 
_SVID_SOURCE


313 
	#__USE_SVID
 1

	)

316 #ifdef 
_ATFILE_SOURCE


317 
	#__USE_ATFILE
 1

	)

320 #ifdef 
_GNU_SOURCE


321 
	#__USE_GNU
 1

	)

324 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


325 
	#__USE_REENTRANT
 1

	)

328 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

329 && 
__GNUC_PREREQ
 (4, 1Ë&& 
deföed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

330 #i‡
_FORTIFY_SOURCE
 > 1

331 
	#__USE_FORTIFY_LEVEL
 2

	)

333 
	#__USE_FORTIFY_LEVEL
 1

	)

336 
	#__USE_FORTIFY_LEVEL
 0

	)

341 
	~<°dc-¥edef.h
>

349 #unde‡
__GNU_LIBRARY__


350 
	#__GNU_LIBRARY__
 6

	)

354 
	#__GLIBC__
 2

	)

355 
	#__GLIBC_MINOR__
 17

	)

357 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

358 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

361 #i‡
deföed
 
__GNUC__
 \

362 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

363 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

364 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

365 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

369 #i‚de‡
__ASSEMBLER__


370 #i‚de‡
_SYS_CDEFS_H


371 
	~<sys/cdefs.h
>

376 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


377 
	#__USE_LARGEFILE
 1

	)

378 
	#__USE_LARGEFILE64
 1

	)

384 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

385 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

386 && 
deföed
 
	g__exã∫_ölöe


387 
	#__USE_EXTERN_INLINES
 1

	)

395 
	~<gnu/°ubs.h
>

	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/bits/byteswap.h

19 #i‡!
deföed
 
_BYTESWAP_H
 && !deföed 
_NETINET_IN_H
 && !deföed 
_ENDIAN_H


23 #i‚de‡
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

28 
	~<bôs/w‹dsize.h
>

31 
	#__bsw≠_c⁄°™t_16
(
x
) \

32 ((Ë((((
x
Ë>> 8Ë& 0xffË| (((xË& 0xffË<< 8)))

	)

35 
	~<bôs/byãsw≠-16.h
>

38 
	#__bsw≠_c⁄°™t_32
(
x
) \

39 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

40 (((
x
Ë& 0x0000ff00Ë<< 8Ë| (((xË& 0x000000ffË<< 24))

	)

42 #ifde‡
__GNUC__


43 #i‡
__GNUC_PREREQ
 (4, 3)

44 
__ölöe
 

45 
	$__bsw≠_32
 (
__bsx
)

47  
	`__buûtö_bsw≠32
 (
__bsx
);

48 
	}
}

49 #ñi‡
__GNUC__
 >= 2

50 #i‡
__WORDSIZE
 =64 || (
deföed
 
__i486__
 || deföed 
__≥¡ium__
 \

51 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

52 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

53 || 
deföed
 
	g__k6__
 || deföed 
	g__noc⁄a__
 \

54 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__geode__
 \

55 || 
deföed
 
	g__amdÁm10__
)

58 
	#__bsw≠_32
(
x
) \

59 (
__exãnsi⁄__
 \

60 ({ 
__v
, 
__x
 = (
x
); \

61 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

62 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

64 
	`__asm__
 ("bsw≠ %0" : "Ù" (
__v
Ë: "0" (
__x
)); \

65 
__v
; }))

	)

67 
	#__bsw≠_32
(
x
) \

68 (
__exãnsi⁄__
 \

69 ({ 
__v
, 
__x
 = (
x
); \

70 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

71 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

73 
	`__asm__
 ("rorw $8, %w0;" \

76 : "Ù" (
__v
) \

77 : "0" (
__x
) \

79 
__v
; }))

	)

82 
	#__bsw≠_32
(
x
) \

83 (
__exãnsi⁄__
 \

84 ({ 
__x
 = (
x
); 
	`__bsw≠_c⁄°™t_32
 (__x); }))

	)

87 
__ölöe
 

88 
	$__bsw≠_32
 (
__bsx
)

90  
	`__bsw≠_c⁄°™t_32
 (
__bsx
);

91 
	}
}

95 #i‡
__GNUC_PREREQ
 (2, 0)

97 
	#__bsw≠_c⁄°™t_64
(
x
) \

98 (
	`__exãnsi⁄__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

99 | (((
x
) & 0x00ff000000000000ull) >> 40) \

100 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

101 | (((
x
) & 0x000000ff00000000ull) >> 8) \

102 | (((
x
) & 0x00000000ff000000ull) << 8) \

103 | (((
x
) & 0x0000000000ff0000ull) << 24) \

104 | (((
x
) & 0x000000000000ff00ull) << 40) \

105 | (((
x
Ë& 0x00000000000000ffuŒË<< 56)))

	)

107 #i‡
__GNUC_PREREQ
 (4, 3)

108 
__ölöe
 
__uöt64_t


109 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

111  
	`__buûtö_bsw≠64
 (
__bsx
);

112 
	}
}

113 #ñi‡
__WORDSIZE
 == 64

114 
	#__bsw≠_64
(
x
) \

115 (
__exãnsi⁄__
 \

116 ({ 
__uöt64_t
 
__v
, 
__x
 = (
x
); \

117 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

118 
__v
 = 
	`__bsw≠_c⁄°™t_64
 (
__x
); \

120 
	`__asm__
 ("bsw≠ %q0" : "Ù" (
__v
Ë: "0" (
__x
)); \

121 
__v
; }))

	)

123 
	#__bsw≠_64
(
x
) \

124 (
__exãnsi⁄__
 \

125 ({ uni⁄ { 
__exãnsi⁄__
 
__uöt64_t
 
__Œ
; \

126 
__l
[2]; } 
__w
, 
__r
; \

127 i‡(
	`__buûtö_c⁄°™t_p
 (
x
)) \

128 
__r
.
__Œ
 = 
	`__bsw≠_c⁄°™t_64
 (
x
); \

131 
__w
.
__Œ
 = (
x
); \

132 
__r
.
__l
[0] = 
	`__bsw≠_32
 (
__w
.__l[1]); \

133 
__r
.
__l
[1] = 
	`__bsw≠_32
 (
__w
.__l[0]); \

135 
__r
.
__Œ
; }))

	)

137 #ñi‡
__GLIBC_HAVE_LONG_LONG


138 
	#__bsw≠_c⁄°™t_64
(
x
) \

139 ((((
x
) & 0xff00000000000000ull) >> 56) \

140 | (((
x
) & 0x00ff000000000000ull) >> 40) \

141 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

142 | (((
x
) & 0x000000ff00000000ull) >> 8) \

143 | (((
x
) & 0x00000000ff000000ull) << 8) \

144 | (((
x
) & 0x0000000000ff0000ull) << 24) \

145 | (((
x
) & 0x000000000000ff00ull) << 40) \

146 | (((
x
Ë& 0x00000000000000ffuŒË<< 56))

	)

148 
__ölöe
 
__uöt64_t


149 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

151  
	`__bsw≠_c⁄°™t_64
 (
__bsx
);

152 
	}
}

	@/usr/include/bits/endian.h

3 #i‚de‡
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/local_lim.h

24 #i‚de‡
NR_OPEN


25 
	#__undef_NR_OPEN


	)

27 #i‚de‡
LINK_MAX


28 
	#__undef_LINK_MAX


	)

30 #i‚de‡
OPEN_MAX


31 
	#__undef_OPEN_MAX


	)

33 #i‚de‡
ARG_MAX


34 
	#__undef_ARG_MAX


	)

38 
	~<löux/limôs.h
>

41 #ifde‡
__undef_NR_OPEN


42 #unde‡
NR_OPEN


43 #unde‡
__undef_NR_OPEN


46 #ifde‡
__undef_LINK_MAX


47 #unde‡
LINK_MAX


48 #unde‡
__undef_LINK_MAX


51 #ifde‡
__undef_OPEN_MAX


52 #unde‡
OPEN_MAX


53 #unde‡
__undef_OPEN_MAX


56 #ifde‡
__undef_ARG_MAX


57 #unde‡
ARG_MAX


58 #unde‡
__undef_ARG_MAX


62 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

64 
	#PTHREAD_KEYS_MAX
 1024

	)

67 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

69 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

72 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

74 #unde‡
PTHREAD_THREADS_MAX


78 
	#AIO_PRIO_DELTA_MAX
 20

	)

81 
	#PTHREAD_STACK_MIN
 16384

	)

84 
	#DELAYTIMER_MAX
 2147483647

	)

87 
	#TTY_NAME_MAX
 32

	)

90 
	#LOGIN_NAME_MAX
 256

	)

93 
	#HOST_NAME_MAX
 64

	)

96 
	#MQ_PRIO_MAX
 32768

	)

99 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/stdio_lim.h

18 #i‡!
deföed
 
_STDIO_H
 && !deföed 
__√ed_FOPEN_MAX
 && !deföed 
__√ed_IOV_MAX


22 #ifde‡
_STDIO_H


23 
	#L_tm≤am
 20

	)

24 
	#TMP_MAX
 238328

	)

25 
	#FILENAME_MAX
 4096

	)

27 #ifde‡
__USE_POSIX


28 
	#L_˘îmid
 9

	)

29 #i‡!
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_GNU


30 
	#L_cu£rid
 9

	)

35 #i‡
deföed
 
__√ed_FOPEN_MAX
 || deföed 
_STDIO_H


36 #unde‡
FOPEN_MAX


37 
	#FOPEN_MAX
 16

	)

40 #i‡
deföed
 
__√ed_IOV_MAX
 && !deföed 
IOV_MAX


41 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/typesizes.h

19 #i‚de‡
_BITS_TYPES_H


23 #i‚def 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifde‡
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 såu˘ { 
__vÆ
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

75 #ifde‡
__x86_64__


79 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

82 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/gnu/stubs.h

6 #i‡!
deföed
 
__x86_64__


7 
	~<gnu/°ubs-32.h
>

9 #i‡
deföed
 
__x86_64__
 && deföed 
__LP64__


10 
	~<gnu/°ubs-64.h
>

12 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


13 
	~<gnu/°ubs-x32.h
>

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

30 
	~<bôs/¥edefs.h
>

34 
	#__STDC_ISO_10646__
 201103L

	)

37 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__a
;

422 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

423 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

424 
	$î™d48_r
 (
__xsubi
[3],

425 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

426 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

429 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

430 *
__ª°ri˘
 
__ªsu…
)

431 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

432 
	$ƒ™d48_r
 (
__xsubi
[3],

433 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

434 *
__ª°ri˘
 
__ªsu…
)

435 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

438 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

439 *
__ª°ri˘
 
__ªsu…
)

440 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

441 
	$jønd48_r
 (
__xsubi
[3],

442 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

443 *
__ª°ri˘
 
__ªsu…
)

444 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

447 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

448 
__THROW
 
	`__n⁄nuŒ
 ((2));

450 
	$£ed48_r
 (
__£ed16v
[3],

451 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$lc⁄g48_r
 (
__∑øm
[7],

454 
dønd48_d©a
 *
__buf„r
)

455 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

461 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


462 
	#__mÆloc_™d_ˇŒoc_deföed


	)

463 
__BEGIN_NAMESPACE_STD


465 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

467 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

468 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

469 
__END_NAMESPACE_STD


472 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


473 
__BEGIN_NAMESPACE_STD


479 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

480 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

482 
	$‰ì
 (*
__±r
Ë
__THROW
;

483 
__END_NAMESPACE_STD


485 #ifdef 
__USE_MISC


487 
	$c‰ì
 (*
__±r
Ë
__THROW
;

490 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


491 
	~<Æloˇ.h
>

494 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

495 || 
deföed
 
__USE_BSD


497 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

500 #ifde‡
__USE_XOPEN2K


502 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

503 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

506 #ifde‡
__USE_ISOC11


508 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

509 
__THROW
 
__wur
 
	`__©åibuã__
 ((
__mÆloc__
, 
	`__Æloc_size__
 (2)));

512 
__BEGIN_NAMESPACE_STD


514 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

518 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

520 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


522 #ifde‡
__˝lu•lus


523 "C++" 
	`©_quick_exô
 ((*
__func
) ())

524 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

526 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

529 
__END_NAMESPACE_STD


531 #ifdef 
__USE_MISC


534 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

535 
__THROW
 
	`__n⁄nuŒ
 ((1));

538 
__BEGIN_NAMESPACE_STD


542 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

544 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


548 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

550 
__END_NAMESPACE_STD


552 #ifde‡
__USE_ISOC99


553 
__BEGIN_NAMESPACE_C99


556 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

557 
__END_NAMESPACE_C99


561 
__BEGIN_NAMESPACE_STD


563 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

564 
__END_NAMESPACE_STD


566 #ifde‡
__USE_GNU


569 *
	$£cuª_gëív
 (c⁄° *
__«me
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

573 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


577 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

580 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


583 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

584 
__THROW
 
	`__n⁄nuŒ
 ((2));

587 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

590 #ifdef 
__USE_MISC


594 
	$˛óªnv
 (Ë
__THROW
;

598 #i‡
deföed
 
__USE_MISC
 \

599 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

605 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

609 || 
deföed
 
__USE_XOPEN2K8


618 #i‚de‡
__USE_FILE_OFFSET64


619 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

621 #ifde‡
__REDIRECT


622 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

623 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

625 
	#mk°emp
 
mk°emp64


	)

628 #ifde‡
__USE_LARGEFILE64


629 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

633 #ifde‡
__USE_MISC


640 #i‚de‡
__USE_FILE_OFFSET64


641 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

643 #ifde‡
__REDIRECT


644 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

645 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

647 
	#mk°emps
 
mk°emps64


	)

650 #ifde‡
__USE_LARGEFILE64


651 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

652 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

656 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


662 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

665 #ifde‡
__USE_GNU


672 #i‚de‡
__USE_FILE_OFFSET64


673 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

675 #ifde‡
__REDIRECT


676 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

677 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

679 
	#mko°emp
 
mko°emp64


	)

682 #ifde‡
__USE_LARGEFILE64


683 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

692 #i‚de‡
__USE_FILE_OFFSET64


693 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

694 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

696 #ifde‡
__REDIRECT


697 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

698 
__Êags
), 
mko°emps64
)

699 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

701 
	#mko°emps
 
mko°emps64


	)

704 #ifde‡
__USE_LARGEFILE64


705 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

706 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

724 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

727 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


733 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

734 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

739 #i‚de‡
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__com∑r_‚_t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

747 #ifde‡
__USE_GNU


748 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

755 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

756 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

760 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

761 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

762 #ifde‡
__USE_GNU


763 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

764 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

765 
	`__n⁄nuŒ
 ((1, 4));

770 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

771 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

772 
__END_NAMESPACE_STD


774 #ifde‡
__USE_ISOC99


775 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

776 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

780 
__BEGIN_NAMESPACE_STD


784 
div_t
 
	$div
 (
__numî
, 
__díom
)

785 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

786 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

787 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

788 
__END_NAMESPACE_STD


790 #ifde‡
__USE_ISOC99


791 
__BEGIN_NAMESPACE_C99


792 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

793 
__díom
)

794 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

795 
__END_NAMESPACE_C99


799 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

800 || 
deföed
 
__USE_SVID


807 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

808 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

813 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

814 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

819 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

820 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

823 #ifde‡
__USE_MISC


825 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

826 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

827 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

828 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

829 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

830 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

831 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

837 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

838 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

839 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

840 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

841 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

842 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

844 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

845 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

846 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

847 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

848 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

849 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

850 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

851 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

856 
__BEGIN_NAMESPACE_STD


859 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

862 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

863 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

866 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
 
__wur
;

870 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

871 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

873 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

874 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

875 
__THROW
;

876 
__END_NAMESPACE_STD


879 #ifde‡
__USE_SVID


884 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

888 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


895 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

896 *c⁄° *
__ª°ri˘
 
__tokís
,

897 **
__ª°ri˘
 
__vÆuï
)

898 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

902 #ifde‡
__USE_XOPEN


904 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

910 #ifde‡
__USE_XOPEN2KXSI


912 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

915 #ifde‡
__USE_XOPEN


920 
	$gø¡±
 (
__fd
Ë
__THROW
;

924 
	$u∆ock±
 (
__fd
Ë
__THROW
;

929 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

932 #ifde‡
__USE_GNU


936 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

937 
__THROW
 
	`__n⁄nuŒ
 ((2));

940 
	`gë±
 ();

943 #ifde‡
__USE_BSD


947 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

948 
__THROW
 
	`__n⁄nuŒ
 ((1));

951 
	~<bôs/°dlib-Êﬂt.h
>

954 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


955 
	~<bôs/°dlib.h
>

957 #ifde‡
__LDBL_COMPAT


958 
	~<bôs/°dlib-ldbl.h
>

962 #unde‡
__√ed_mÆloc_™d_ˇŒoc


964 
__END_DECLS


	@/usr/include/sys/cdefs.h

19 #i‚def 
_SYS_CDEFS_H


20 
	#_SYS_CDEFS_H
 1

	)

23 #i‚de‡
_FEATURES_H


24 
	~<„©uªs.h
>

30 #i‡
deföed
 
__GNUC__
 && !deföed 
__STDC__


35 #unde‡
__P


36 #unde‡
__PMT


38 #ifde‡
__GNUC__


42 #i‡
__GNUC_PREREQ
 (4, 6Ë&& !
deföed
 
_LIBC


43 
	#__LEAF
 , 
__Àaf__


	)

44 
	#__LEAF_ATTR
 
	`__©åibuã__
 ((
__Àaf__
))

	)

46 
	#__LEAF


	)

47 
	#__LEAF_ATTR


	)

55 #i‡!
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (3, 3)

56 
	#__THROW
 
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
))

	)

57 
	#__THROWNL
 
	`__©åibuã__
 ((
__nŸhrow__
))

	)

58 
	#__NTH
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
)Ë
	)
fct

60 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
f˘
Ë
__LEAF_ATTR
 f˘ 
	`throw
 ()

	)

65 
	#__THROW


	)

66 
	#__THROWNL


	)

67 
	#__NTH
(
f˘
Ë
	)
fct

73 
	#__ölöe


	)

75 
	#__THROW


	)

76 
	#__THROWNL


	)

77 
	#__NTH
(
f˘
Ë
	)
fct

83 
	#__P
(
¨gs
Ë
	)
args

84 
	#__PMT
(
¨gs
Ë
	)
args

89 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

90 
	#__STRING
(
x
Ë#x

	)

93 
	#__±r_t
 *

	)

94 
	#__l⁄g_doubÀ_t
 

	)

98 #ifdef 
__˝lu•lus


99 
	#__BEGIN_DECLS
 "C" {

	)

100 
	#__END_DECLS
 }

	)

102 
	#__BEGIN_DECLS


	)

103 
	#__END_DECLS


	)

112 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES


113 
	#__BEGIN_NAMESPACE_STD
 
«me•a˚
 
°d
 {

	)

114 
	#__END_NAMESPACE_STD
 }

	)

115 
	#__USING_NAMESPACE_STD
(
«me
Ë
usög
 
°d
::«me;

	)

116 
	#__BEGIN_NAMESPACE_C99
 
«me•a˚
 
__c99
 {

	)

117 
	#__END_NAMESPACE_C99
 }

	)

118 
	#__USING_NAMESPACE_C99
(
«me
Ë
usög
 
__c99
::«me;

	)

123 
	#__BEGIN_NAMESPACE_STD


	)

124 
	#__END_NAMESPACE_STD


	)

125 
	#__USING_NAMESPACE_STD
(
«me
)

	)

126 
	#__BEGIN_NAMESPACE_C99


	)

127 
	#__END_NAMESPACE_C99


	)

128 
	#__USING_NAMESPACE_C99
(
«me
)

	)

133 #i‚de‡
__BOUNDED_POINTERS__


134 
	#__bounded


	)

135 
	#__unbounded


	)

136 
	#__±rvÆue


	)

141 
	#__bos
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

142 
	#__bos0
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 0)

	)

143 
	#__f‹tify_fun˘i⁄
 
__exã∫_Æways_ölöe
 
__©åibuã_¨tificül__


	)

145 #i‡
__GNUC_PREREQ
 (4,3)

146 
	#__w¨nde˛
(
«me
, 
msg
) \

147 
	`«me
 (Ë
	`__©åibuã__
((
	`__w¨nög__
 (
msg
)))

	)

148 
	#__w¨«âr
(
msg
Ë
	`__©åibuã__
((
	`__w¨nög__
 (msg)))

	)

149 
	#__îr‹de˛
(
«me
, 
msg
) \

150 
	`«me
 (Ë
	`__©åibuã__
((
	`__îr‹__
 (
msg
)))

	)

152 
	#__w¨nde˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

153 
	#__w¨«âr
(
msg
)

	)

154 
	#__îr‹de˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

158 #i‡
__GNUC_PREREQ
 (2,97)

160 
	#__Êex¨r
 []

	)

162 #ifde‡
__GNUC__


163 
	#__Êex¨r
 [0]

	)

165 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

166 
	#__Êex¨r
 []

	)

169 
	#__Êex¨r
 [1]

	)

185 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

187 
	#__REDIRECT
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

188 #ifde‡
__˝lu•lus


189 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

190 
«me
 
¥Ÿo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

191 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

192 
«me
 
¥Ÿo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

194 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

195 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROW


	)

196 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

197 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROWNL


	)

199 
	#__ASMNAME
(
˙ame
Ë
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, c«me)

	)

200 
	#__ASMNAME2
(
¥efix
, 
˙ame
Ë
	`__STRING
 (¥efixË
	)
cname

213 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

214 
	#__©åibuã__
(
xyz
Ë

	)

220 #i‡
__GNUC_PREREQ
 (2,96)

221 
	#__©åibuã_mÆloc__
 
	`__©åibuã__
 ((
__mÆloc__
))

	)

223 
	#__©åibuã_mÆloc__


	)

229 #i‡
__GNUC_PREREQ
 (2,96)

230 
	#__©åibuã_puª__
 
	`__©åibuã__
 ((
__puª__
))

	)

232 
	#__©åibuã_puª__


	)

236 #i‡
__GNUC_PREREQ
 (2,5)

237 
	#__©åibuã_c⁄°__
 
	`__©åibuã__
 ((
__c⁄°__
))

	)

239 
	#__©åibuã_c⁄°__


	)

245 #i‡
__GNUC_PREREQ
 (3,1)

246 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__u£d__
))

	)

247 
	#__©åibuã_noölöe__
 
	`__©åibuã__
 ((
__noölöe__
))

	)

249 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__unu£d__
))

	)

250 
	#__©åibuã_noölöe__


	)

254 #i‡
__GNUC_PREREQ
 (3,2)

255 
	#__©åibuã_dïªˇãd__
 
	`__©åibuã__
 ((
__dïªˇãd__
))

	)

257 
	#__©åibuã_dïªˇãd__


	)

266 #i‡
__GNUC_PREREQ
 (2,8)

267 
	#__©åibuã_f‹m©_¨g__
(
x
Ë
	`__©åibuã__
 ((
	`__f‹m©_¨g__
 (x)))

	)

269 
	#__©åibuã_f‹m©_¨g__
(
x
Ë

	)

276 #i‡
__GNUC_PREREQ
 (2,97)

277 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
) \

278 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__°rfm⁄__
, 
a
, 
b
)))

	)

280 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
Ë

	)

285 #i‡
__GNUC_PREREQ
 (3,3)

286 
	#__n⁄nuŒ
(
∑øms
Ë
	`__©åibuã__
 ((
__n⁄nuŒ__
Ö¨ams))

	)

288 
	#__n⁄nuŒ
(
∑øms
)

	)

293 #i‡
__GNUC_PREREQ
 (3,4)

294 
	#__©åibuã_w¨n_unu£d_ªsu…__
 \

295 
	`__©åibuã__
 ((
__w¨n_unu£d_ªsu…__
))

	)

296 #i‡
__USE_FORTIFY_LEVEL
 > 0

297 
	#__wur
 
__©åibuã_w¨n_unu£d_ªsu…__


	)

300 
	#__©åibuã_w¨n_unu£d_ªsu…__


	)

302 #i‚de‡
__wur


303 
	#__wur


	)

307 #i‡
__GNUC_PREREQ
 (3,2)

308 
	#__Æways_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__Æways_ölöe__
))

	)

310 
	#__Æways_ölöe
 
__ölöe


	)

315 #i‡
__GNUC_PREREQ
 (4,3)

316 
	#__©åibuã_¨tificül__
 
	`__©åibuã__
 ((
__¨tificül__
))

	)

318 
	#__©åibuã_¨tificül__


	)

323 #i‡(!
deföed
 
__˝lu•lus
 || 
__GNUC_PREREQ
 (4,3)Ë&& deföed 
__GNUC__


324 #i‡
deföed
 
__GNUC_STDC_INLINE__
 || deföed 
__˝lu•lus


325 
	#__exã∫_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

326 
	#__exã∫_Æways_ölöe
 \

327 
__Æways_ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

329 
	#__exã∫_ölöe
 
__ölöe


	)

330 
	#__exã∫_Æways_ölöe
 
__Æways_ölöe


	)

332 #ñi‡
deföed
 
__GNUC__


333 
	#__exã∫_ölöe
 
__ölöe


	)

334 
	#__exã∫_Æways_ölöe
 \

335 
__Æways_ölöe


	)

337 
	#__exã∫_ölöe


	)

338 
	#__exã∫_Æways_ölöe


	)

343 #i‡
__GNUC_PREREQ
 (4,3)

344 
	#__va_¨g_∑ck
(Ë
	`__buûtö_va_¨g_∑ck
 ()

	)

345 
	#__va_¨g_∑ck_Àn
(Ë
	`__buûtö_va_¨g_∑ck_Àn
 ()

	)

352 #i‡!
__GNUC_PREREQ
 (2,8)

353 
	#__exãnsi⁄__


	)

357 #i‡!
__GNUC_PREREQ
 (2,92)

358 
	#__ª°ri˘


	)

364 #i‡
__GNUC_PREREQ
 (3,1Ë&& !
deföed
 
__GNUG__


365 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

367 #ifde‡
__GNUC__


368 
	#__ª°ri˘_¨r


	)

370 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

371 
	#__ª°ri˘_¨r
 
ª°ri˘


	)

374 
	#__ª°ri˘_¨r


	)

379 #i‡
__GNUC__
 >= 3

380 
	#__glibc_u∆ikñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
((c⁄d), 0)

	)

382 
	#__glibc_u∆ikñy
(
c⁄d
Ë(c⁄d)

	)

385 
	~<bôs/w‹dsize.h
>

387 #i‡
deföed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && deföed 
__NO_LONG_DOUBLE_MATH


388 
	#__LDBL_COMPAT
 1

	)

389 #ifde‡
__REDIRECT


390 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

391 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
) \

392 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

393 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT_NTH
 («me,ÖrŸo,álüs)

	)

394 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
) \

395 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

396 
	#__LDBL_REDIR1_DECL
(
«me
, 
Æüs
) \

397 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 (#Æüs));

	)

398 
	#__LDBL_REDIR_DECL
(
«me
) \

399 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 ("__∆dbl_" #«me));

	)

400 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

401 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

402 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

403 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

406 #i‡!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT


407 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê
	)
proto

408 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
Ë«mê
	)
proto

409 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
__THROW


	)

410 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
Ë«mê¥Ÿÿ
__THROW


	)

411 
	#__LDBL_REDIR_DECL
(
«me
)

	)

412 #ifde‡
__REDIRECT


413 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

414 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

415 
	`__REDIRECT_NTH
 (
«me
, 
¥Ÿo
, 
Æüs
)

	)

	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/bits/byteswap-16.h

19 #i‚de‡
_BITS_BYTESWAP_H


23 #ifde‡
__GNUC__


24 #i‡
__GNUC__
 >= 2

25 
	#__bsw≠_16
(
x
) \

26 (
__exãnsi⁄__
 \

27 ({ 
__v
, 
__x
 = (Ë(
x
); \

28 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

29 
__v
 = 
	`__bsw≠_c⁄°™t_16
 (
__x
); \

31 
	`__asm__
 ("rorw $8, %w0" \

32 : "Ù" (
__v
) \

33 : "0" (
__x
) \

35 
__v
; }))

	)

38 
	#__bsw≠_16
(
x
) \

39 (
__exãnsi⁄__
 \

40 ({ 
__x
 = (Ë(
x
); \

41 
	`__bsw≠_c⁄°™t_16
 (
__x
); }))

	)

44 
__ölöe
 

45 
	$__bsw≠_16
 (
__bsx
)

47  
	`__bsw≠_c⁄°™t_16
 (
__bsx
);

48 
	}
}

	@/usr/include/bits/predefs.h

19 #i‚de‡
_PREDEFS_H


20 
	#_PREDEFS_H


	)

22 #i‚de‡
_STDC_PREDEF_H


27 
	#__STDC_IEC_559__
 1

	)

28 
	#__STDC_IEC_559_COMPLEX__
 1

	)

	@/usr/include/bits/stdlib-float.h

19 #i‚de‡
_STDLIB_H


23 #ifde‡
__USE_EXTERN_INLINES


24 
__BEGIN_NAMESPACE_STD


25 
__exã∫_ölöe
 

26 
__NTH
 (
	$©of
 (c⁄° *
__≈å
))

28  
	`°πod
 (
__≈å
, (**Ë
NULL
);

29 
	}
}

30 
	g__END_NAMESPACE_STD


	@/usr/include/bits/stdlib-ldbl.h

19 #i‚de‡
_STDLIB_H


23 #ifdef 
__USE_ISOC99


24 
__BEGIN_NAMESPACE_C99


25 
	$__LDBL_REDIR1_DECL
 (
°πﬁd
, 
°πod
)

26 
__END_NAMESPACE_C99


29 #ifde‡
__USE_GNU


30 
	$__LDBL_REDIR1_DECL
 (
°πﬁd_l
, 
°πod_l
)

33 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


34 #ifde‡
__USE_MISC


35 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

36 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

38 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

39 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

19 #i‚de‡
_STDLIB_H


23 *
	$__ªÆ∑th_chk
 (c⁄° *
__ª°ri˘
 
__«me
,

24 *
__ª°ri˘
 
__ªsﬁved
,

25 
size_t
 
__ªsﬁvedÀn
Ë
__THROW
 
__wur
;

26 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_Æüs
,

27 (c⁄° *
__ª°ri˘
 
__«me
,

28 *
__ª°ri˘
 
__ªsﬁved
), 
ªÆ∑th
Ë
__wur
;

29 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_chk_w¨n
,

30 (c⁄° *
__ª°ri˘
 
__«me
,

31 *
__ª°ri˘
 
__ªsﬁved
,

32 
size_t
 
__ªsﬁvedÀn
), 
__ªÆ∑th_chk
Ë
__wur


33 
	`__w¨«âr
 ("secondárgument ofÑealpath must beÉither NULL orát "

36 
__f‹tify_fun˘i⁄
 
__wur
 *

37 
	`__NTH
 (
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
, *__ª°ri˘ 
__ªsﬁved
))

39 i‡(
	`__bos
 (
__ªsﬁved
Ë!(
size_t
) -1)

41 #i‡
deföed
 
_LIBC_LIMITS_H_
 && deföed 
PATH_MAX


42 i‡(
	`__bos
 (
__ªsﬁved
Ë< 
PATH_MAX
)

43  
	`__ªÆ∑th_chk_w¨n
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

45  
	`__ªÆ∑th_chk
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

48  
	`__ªÆ∑th_Æüs
 (
__«me
, 
__ªsﬁved
);

49 
	}
}

52 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

53 
size_t
 
__ƒól
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

54 
	`__REDIRECT_NTH
 (
__±¢ame_r_Æüs
, (
__fd
, *
__buf
,

55 
size_t
 
__buÊí
), 
±¢ame_r
)

56 
	`__n⁄nuŒ
 ((2));

57 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¨n
,

58 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

59 
size_t
 
__ƒól
), 
__±¢ame_r_chk
)

60 
	`__n⁄nuŒ
 ((2)Ë
	`__w¨«âr
 ("ptsname_r called with buflen biggerÅhan "

63 
__f‹tify_fun˘i⁄
 

64 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
))

66 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

68 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

69  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

70 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

71  
	`__±¢ame_r_chk_w¨n
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

73  
	`__±¢ame_r_Æüs
 (
__fd
, 
__buf
, 
__buÊí
);

74 
	}
}

77 
	$__w˘omb_chk
 (*
__s
, 
wch¨_t
 
__wch¨
, 
size_t
 
__buÊí
)

78 
__THROW
 
__wur
;

79 
	`__REDIRECT_NTH
 (
__w˘omb_Æüs
, (*
__s
, 
wch¨_t
 
__wch¨
),

80 
w˘omb
Ë
__wur
;

82 
__f‹tify_fun˘i⁄
 
__wur
 

83 
	`__NTH
 (
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
))

88 
	#__STDLIB_MB_LEN_MAX
 16

	)

89 #i‡
deföed
 
MB_LEN_MAX
 && MB_LEN_MAX !
__STDLIB_MB_LEN_MAX


92 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

93  
	`__w˘omb_chk
 (
__s
, 
__wch¨
, 
	`__bos
 (__s));

94  
	`__w˘omb_Æüs
 (
__s
, 
__wch¨
);

95 
	}
}

98 
size_t
 
	$__mb°owcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

99 c⁄° *
__ª°ri˘
 
__§c
,

100 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

101 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_Æüs
,

102 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

103 c⁄° *
__ª°ri˘
 
__§c
,

104 
size_t
 
__Àn
), 
mb°owcs
);

105 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_chk_w¨n
,

106 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

107 c⁄° *
__ª°ri˘
 
__§c
,

108 
size_t
 
__Àn
, size_à
__d°Àn
), 
__mb°owcs_chk
)

109 
	`__w¨«âr
 ("mbstowcs called with dst buffer smallerÅhanÜen "

112 
__f‹tify_fun˘i⁄
 
size_t


113 
	`__NTH
 (
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, c⁄° *__ª°ri˘ 
__§c
,

114 
size_t
 
__Àn
))

116 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

118 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

119  
	`__mb°owcs_chk
 (
__d°
, 
__§c
, 
__Àn
,

120 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

122 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

123  
	`__mb°owcs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
,

124 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

126  
	`__mb°owcs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

127 
	}
}

130 
size_t
 
	$__wc°ombs_chk
 (*
__ª°ri˘
 
__d°
,

131 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

132 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

133 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_Æüs
,

134 (*
__ª°ri˘
 
__d°
,

135 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

136 
size_t
 
__Àn
), 
wc°ombs
);

137 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_chk_w¨n
,

138 (*
__ª°ri˘
 
__d°
,

139 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

140 
size_t
 
__Àn
, size_à
__d°Àn
), 
__wc°ombs_chk
)

141 
	`__w¨«âr
 ("wcstombs called with dst buffer smallerÅhanÜen");

143 
__f‹tify_fun˘i⁄
 
size_t


144 
	`__NTH
 (
	$wc°ombs
 (*
__ª°ri˘
 
__d°
, c⁄° 
wch¨_t
 *__ª°ri˘ 
__§c
,

145 
size_t
 
__Àn
))

147 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

149 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

150  
	`__wc°ombs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

151 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

152  
	`__wc°ombs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

154  
	`__wc°ombs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

155 
	}
}

	@/usr/include/bits/waitflags.h

19 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


25 
	#WNOHANG
 1

	)

26 
	#WUNTRACED
 2

	)

29 
	#WSTOPPED
 2

	)

30 
	#WEXITED
 4

	)

31 
	#WCONTINUED
 8

	)

32 
	#WNOWAIT
 0x01000000

	)

34 
	#__WNOTHREAD
 0x20000000

	)

36 
	#__WALL
 0x40000000

	)

37 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

19 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


28 
	#__WEXITSTATUS
(
°©us
Ë(((°©usË& 0xff00Ë>> 8)

	)

31 
	#__WTERMSIG
(
°©us
Ë((°©usË& 0x7f)

	)

34 
	#__WSTOPSIG
(
°©us
Ë
	`__WEXITSTATUS
(°©us)

	)

37 
	#__WIFEXITED
(
°©us
Ë(
	`__WTERMSIG
(°©usË=0)

	)

40 
	#__WIFSIGNALED
(
°©us
) \

41 (((sig√d Ë(((
°©us
Ë& 0x7fË+ 1Ë>> 1Ë> 0)

	)

44 
	#__WIFSTOPPED
(
°©us
Ë(((°©usË& 0xffË=0x7f)

	)

48 #ifde‡
WCONTINUED


49 
	#__WIFCONTINUED
(
°©us
Ë((°©usË=
__W_CONTINUED
)

	)

53 
	#__WCOREDUMP
(
°©us
Ë((°©usË& 
__WCOREFLAG
)

	)

56 
	#__W_EXITCODE
(
ªt
, 
sig
Ë(‘ëË<< 8 | (sig))

	)

57 
	#__W_STOPCODE
(
sig
Ë((sigË<< 8 | 0x7f)

	)

58 
	#__W_CONTINUED
 0xffff

	)

59 
	#__WCOREFLAG
 0x80

	)

62 #ifdef 
__USE_BSD


64 
	~<ídün.h
>

66 
	uwaô


68 
	mw_°©us
;

71 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


72 
	m__w_ãrmsig
:7;

73 
	m__w_c‹edump
:1;

74 
	m__w_ªtcode
:8;

77 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


79 
	m__w_ªtcode
:8;

80 
	m__w_c‹edump
:1;

81 
	m__w_ãrmsig
:7;

83 } 
	m__waô_ãrmö©ed
;

86 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


87 
	m__w_°›vÆ
:8;

88 
	m__w_°›sig
:8;

91 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


93 
	m__w_°›sig
:8;

94 
	m__w_°›vÆ
:8;

96 } 
	m__waô_°›≥d
;

99 
	#w_ãrmsig
 
__waô_ãrmö©ed
.
__w_ãrmsig


	)

100 
	#w_c‹edump
 
__waô_ãrmö©ed
.
__w_c‹edump


	)

101 
	#w_ªtcode
 
__waô_ãrmö©ed
.
__w_ªtcode


	)

102 
	#w_°›sig
 
__waô_°›≥d
.
__w_°›sig


	)

103 
	#w_°›vÆ
 
__waô_°›≥d
.
__w_°›vÆ


	)

	@/usr/include/gnu/stubs-32.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_chÊags


	)

11 
	#__°ub_Áâach


	)

12 
	#__°ub_fchÊags


	)

13 
	#__°ub_fdëach


	)

14 
	#__°ub_gây


	)

15 
	#__°ub_lchmod


	)

16 
	#__°ub_ªvoke


	)

17 
	#__°ub_£éogö


	)

18 
	#__°ub_sigªtu∫


	)

19 
	#__°ub_s°k


	)

20 
	#__°ub_°ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_bdÊush


	)

11 
	#__°ub_chÊags


	)

12 
	#__°ub_Áâach


	)

13 
	#__°ub_fchÊags


	)

14 
	#__°ub_fdëach


	)

15 
	#__°ub_gëmsg


	)

16 
	#__°ub_gây


	)

17 
	#__°ub_lchmod


	)

18 
	#__°ub_putmsg


	)

19 
	#__°ub_ªvoke


	)

20 
	#__°ub_£éogö


	)

21 
	#__°ub_sigªtu∫


	)

22 
	#__°ub_s°k


	)

23 
	#__°ub_°ty


	)

	@/usr/include/gnu/stubs-x32.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_bdÊush


	)

11 
	#__°ub_chÊags


	)

12 
	#__°ub_¸óã_moduÀ


	)

13 
	#__°ub_Áâach


	)

14 
	#__°ub_fchÊags


	)

15 
	#__°ub_fdëach


	)

16 
	#__°ub_gë_kî√l_syms


	)

17 
	#__°ub_gëmsg


	)

18 
	#__°ub_gây


	)

19 
	#__°ub_lchmod


	)

20 
	#__°ub_nfs£rv˘l


	)

21 
	#__°ub_putmsg


	)

22 
	#__°ub_quîy_moduÀ


	)

23 
	#__°ub_ªvoke


	)

24 
	#__°ub_£éogö


	)

25 
	#__°ub_sigªtu∫


	)

26 
	#__°ub_s°k


	)

27 
	#__°ub_°ty


	)

28 
	#__°ub_u£lib


	)

	@/usr/include/linux/limits.h

1 #i‚de‡
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/sys/types.h

22 #i‚def 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

31 #ifdef 
__USE_BSD


32 #i‚de‡
__u_ch¨_deföed


33 
__u_ch¨
 
	tu_ch¨
;

34 
__u_sh‹t
 
	tu_sh‹t
;

35 
__u_öt
 
	tu_öt
;

36 
__u_l⁄g
 
	tu_l⁄g
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¨_deföed


	)

44 
__loff_t
 
	tloff_t
;

46 #i‚de‡
__öo_t_deföed


47 #i‚de‡
__USE_FILE_OFFSET64


48 
__öo_t
 
	töo_t
;

50 
__öo64_t
 
	töo_t
;

52 
	#__öo_t_deföed


	)

54 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


55 
__öo64_t
 
	töo64_t
;

56 
	#__öo64_t_deföed


	)

59 #i‚de‡
__dev_t_deföed


60 
__dev_t
 
	tdev_t
;

61 
	#__dev_t_deföed


	)

64 #i‚de‡
__gid_t_deföed


65 
__gid_t
 
	tgid_t
;

66 
	#__gid_t_deföed


	)

69 #i‚de‡
__mode_t_deföed


70 
__mode_t
 
	tmode_t
;

71 
	#__mode_t_deföed


	)

74 #i‚de‡
__∆ök_t_deföed


75 
__∆ök_t
 
	t∆ök_t
;

76 
	#__∆ök_t_deföed


	)

79 #i‚de‡
__uid_t_deföed


80 
__uid_t
 
	tuid_t
;

81 
	#__uid_t_deföed


	)

84 #i‚de‡
__off_t_deföed


85 #i‚de‡
__USE_FILE_OFFSET64


86 
__off_t
 
	toff_t
;

88 
__off64_t
 
	toff_t
;

90 
	#__off_t_deföed


	)

92 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


93 
__off64_t
 
	toff64_t
;

94 
	#__off64_t_deföed


	)

97 #i‚de‡
__pid_t_deföed


98 
__pid_t
 
	tpid_t
;

99 
	#__pid_t_deföed


	)

102 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
) \

103 && !
deföed
 
__id_t_deföed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_deföed


	)

108 #i‚de‡
__ssize_t_deföed


109 
__ssize_t
 
	tssize_t
;

110 
	#__ssize_t_deföed


	)

113 #ifdef 
__USE_BSD


114 #i‚de‡
__daddr_t_deföed


115 
__daddr_t
 
	tdaddr_t
;

116 
__ˇddr_t
 
	tˇddr_t
;

117 
	#__daddr_t_deföed


	)

121 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__key_t_deföed


122 
__key_t
 
	tkey_t
;

123 
	#__key_t_deföed


	)

126 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


127 
	#__√ed_˛ock_t


	)

129 
	#__√ed_time_t


	)

130 
	#__√ed_timî_t


	)

131 
	#__√ed_˛ockid_t


	)

132 
	~<time.h
>

134 #ifde‡
__USE_XOPEN


135 #i‚de‡
__u£c⁄ds_t_deföed


136 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

137 
	#__u£c⁄ds_t_deföed


	)

139 #i‚de‡
__su£c⁄ds_t_deföed


140 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

141 
	#__su£c⁄ds_t_deföed


	)

145 
	#__√ed_size_t


	)

146 
	~<°ddef.h
>

148 #ifde‡
__USE_MISC


150 
	tul⁄g
;

151 
	tush‹t
;

152 
	tuöt
;

157 #i‡!
__GNUC_PREREQ
 (2, 7)

160 #i‚de‡
__öt8_t_deföed


161 
	#__öt8_t_deföed


	)

162 
	töt8_t
;

163 
	töt16_t
;

164 
	töt32_t
;

165 #i‡
__WORDSIZE
 == 64

166 
	töt64_t
;

167 #ñi‡
__GLIBC_HAVE_LONG_LONG


168 
__exãnsi⁄__
 
	töt64_t
;

173 
	tu_öt8_t
;

174 
	tu_öt16_t
;

175 
	tu_öt32_t
;

176 #i‡
__WORDSIZE
 == 64

177 
	tu_öt64_t
;

178 #ñi‡
__GLIBC_HAVE_LONG_LONG


179 
__exãnsi⁄__
 
	tu_öt64_t
;

182 
	tªgi°î_t
;

187 
	#__ötN_t
(
N
, 
MODE
) \

188 ##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

189 
	t__u_ötN_t
(
	tN
, 
	tMODE
) \

190 
	tu_öt
##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

192 #i‚de‡
	t__öt8_t_deföed


193 
	t__öt8_t_deföed


	)

194 
	t__ötN_t
 (8, 
	t__QI__
);

195 
__ötN_t
 (16, 
__HI__
);

196 
__ötN_t
 (32, 
__SI__
);

197 
__ötN_t
 (64, 
__DI__
);

200 
__u_ötN_t
 (8, 
__QI__
);

201 
__u_ötN_t
 (16, 
__HI__
);

202 
__u_ötN_t
 (32, 
__SI__
);

203 
__u_ötN_t
 (64, 
__DI__
);

205 
	tªgi°î_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__w‹d__
)));

211 
	#__BIT_TYPES_DEFINED__
 1

	)

214 #ifdef 
__USE_BSD


216 
	~<ídün.h
>

219 
	~<sys/£À˘.h
>

222 
	~<sys/sysma¸os.h
>

226 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
) \

227 && !
deföed
 
__blksize_t_deföed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_deföed


	)

233 #i‚de‡
__USE_FILE_OFFSET64


234 #i‚de‡
__blk˙t_t_deföed


235 
__blk˙t_t
 
	tblk˙t_t
;

236 
	#__blk˙t_t_deföed


	)

238 #i‚de‡
__fsblk˙t_t_deföed


239 
__fsblk˙t_t
 
	tfsblk˙t_t
;

240 
	#__fsblk˙t_t_deföed


	)

242 #i‚de‡
__fsfû˙t_t_deföed


243 
__fsfû˙t_t
 
	tfsfû˙t_t
;

244 
	#__fsfû˙t_t_deföed


	)

247 #i‚de‡
__blk˙t_t_deföed


248 
__blk˙t64_t
 
	tblk˙t_t
;

249 
	#__blk˙t_t_deföed


	)

251 #i‚de‡
__fsblk˙t_t_deföed


252 
__fsblk˙t64_t
 
	tfsblk˙t_t
;

253 
	#__fsblk˙t_t_deföed


	)

255 #i‚de‡
__fsfû˙t_t_deföed


256 
__fsfû˙t64_t
 
	tfsfû˙t_t
;

257 
	#__fsfû˙t_t_deföed


	)

261 #ifde‡
__USE_LARGEFILE64


262 
__blk˙t64_t
 
	tblk˙t64_t
;

263 
__fsblk˙t64_t
 
	tfsblk˙t64_t
;

264 
__fsfû˙t64_t
 
	tfsfû˙t64_t
;

269 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


270 
	~<bôs/±hªadty≥s.h
>

273 
	g__END_DECLS


	@/usr/include/bits/pthreadtypes.h

18 #i‚de‡
_BITS_PTHREADTYPES_H


19 
	#_BITS_PTHREADTYPES_H
 1

	)

21 
	~<bôs/w‹dsize.h
>

23 #ifde‡
__x86_64__


24 #i‡
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

26 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

27 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

28 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

29 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

30 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

31 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

32 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

33 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

35 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

36 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

37 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

38 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

39 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

40 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

41 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

42 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

43 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

46 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

47 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

48 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

49 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

50 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

51 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

52 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

53 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

54 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

60 
	t±hªad_t
;

63 
	u±hªad_©å_t


65 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

66 
	m__Æign
;

68 #i‚de‡
__have_±hªad_©å_t


69 
±hªad_©å_t
 
	t±hªad_©å_t
;

70 
	#__have_±hªad_©å_t
 1

	)

74 #ifde‡
__x86_64__


75 
	s__±hªad_öã∫Æ_li°


77 
__±hªad_öã∫Æ_li°
 *
	m__¥ev
;

78 
__±hªad_öã∫Æ_li°
 *
	m__√xt
;

79 } 
	t__±hªad_li°_t
;

81 
	s__±hªad_öã∫Æ_¶i°


83 
__±hªad_öã∫Æ_¶i°
 *
	m__√xt
;

84 } 
	t__±hªad_¶i°_t
;

92 
	s__±hªad_muãx_s


94 
	m__lock
;

95 
	m__cou¡
;

96 
	m__ow√r
;

97 #ifde‡
__x86_64__


98 
	m__nu£rs
;

102 
	m__köd
;

103 #ifde‡
__x86_64__


104 
	m__•ös
;

105 
__±hªad_li°_t
 
	m__li°
;

106 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

108 
	m__nu£rs
;

109 
__exãnsi⁄__
 union

111 
	m__•ös
;

112 
__±hªad_¶i°_t
 
	m__li°
;

115 } 
	m__d©a
;

116 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

117 
	m__Æign
;

118 } 
	t±hªad_muãx_t
;

122 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

123 
	m__Æign
;

124 } 
	t±hªad_muãx©å_t
;

133 
	m__lock
;

134 
	m__fuãx
;

135 
__exãnsi⁄__
 
	m__tŸÆ_£q
;

136 
__exãnsi⁄__
 
	m__wakeup_£q
;

137 
__exãnsi⁄__
 
	m__wokí_£q
;

138 *
	m__muãx
;

139 
	m__nwaôîs
;

140 
	m__brﬂdˇ°_£q
;

141 } 
	m__d©a
;

142 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

143 
__exãnsi⁄__
 
	m__Æign
;

144 } 
	t±hªad_c⁄d_t
;

148 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

149 
	m__Æign
;

150 } 
	t±hªad_c⁄d©å_t
;

154 
	t±hªad_key_t
;

158 
	t±hªad_⁄˚_t
;

161 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


166 #ifde‡
__x86_64__


169 
	m__lock
;

170 
	m__ƒ_ªadîs
;

171 
	m__ªadîs_wakeup
;

172 
	m__wrôî_wakeup
;

173 
	m__ƒ_ªadîs_queued
;

174 
	m__ƒ_wrôîs_queued
;

175 
	m__wrôî
;

176 
	m__sh¨ed
;

177 
	m__∑d1
;

178 
	m__∑d2
;

181 
	m__Êags
;

182 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

183 } 
	m__d©a
;

187 
	m__lock
;

188 
	m__ƒ_ªadîs
;

189 
	m__ªadîs_wakeup
;

190 
	m__wrôî_wakeup
;

191 
	m__ƒ_ªadîs_queued
;

192 
	m__ƒ_wrôîs_queued
;

195 
	m__Êags
;

196 
	m__sh¨ed
;

197 
	m__∑d1
;

198 
	m__∑d2
;

199 
	m__wrôî
;

200 } 
	m__d©a
;

202 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

203 
	m__Æign
;

204 } 
	t±hªad_rwlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

209 
	m__Æign
;

210 } 
	t±hªad_rwlock©å_t
;

214 #ifde‡
__USE_XOPEN2K


216 vﬁ©ûê
	t±hªad_•ölock_t
;

223 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

224 
	m__Æign
;

225 } 
	t±hªad_b¨rõr_t
;

229 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

230 
	m__Æign
;

231 } 
	t±hªad_b¨rõøâr_t
;

235 #i‚de‡
__x86_64__


237 
	#__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
	`__ªg∑rm__
 (1)))

	)

	@/usr/include/sys/select.h

21 #i‚de‡
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

30 
	~<bôs/£À˘.h
>

33 
	~<bôs/sig£t.h
>

35 #i‚de‡
__sig£t_t_deföed


36 
	#__sig£t_t_deföed


	)

37 
__sig£t_t
 
	tsig£t_t
;

41 
	#__√ed_time_t


	)

42 
	#__√ed_time•ec


	)

43 
	~<time.h
>

44 
	#__√ed_timevÆ


	)

45 
	~<bôs/time.h
>

47 #i‚de‡
__su£c⁄ds_t_deföed


48 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

49 
	#__su£c⁄ds_t_deföed


	)

54 
	t__fd_mask
;

57 #unde‡
__NFDBITS


59 
	#__NFDBITS
 (8 * (Ë (
__fd_mask
))

	)

60 
	#__FD_ELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

61 
	#__FD_MASK
(
d
Ë((
__fd_mask
Ë1 << ((dË% 
__NFDBITS
))

	)

68 #ifde‡
__USE_XOPEN


69 
__fd_mask
 
	mfds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

70 
	#__FDS_BITS
(
£t
Ë((£t)->
fds_bôs
)

	)

72 
__fd_mask
 
	m__fds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
Ë((£t)->
__fds_bôs
)

	)

75 } 
	tfd_£t
;

78 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

80 #ifde‡
__USE_MISC


82 
__fd_mask
 
	tfd_mask
;

85 
	#NFDBITS
 
__NFDBITS


	)

90 
	#FD_SET
(
fd
, 
fd£ç
Ë
	`__FD_SET
 (fd, fd£ç)

	)

91 
	#FD_CLR
(
fd
, 
fd£ç
Ë
	`__FD_CLR
 (fd, fd£ç)

	)

92 
	#FD_ISSET
(
fd
, 
fd£ç
Ë
	`__FD_ISSET
 (fd, fd£ç)

	)

93 
	#FD_ZERO
(
fd£ç
Ë
	`__FD_ZERO
 (fd£ç)

	)

96 
__BEGIN_DECLS


106 
£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

107 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

108 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

109 
timevÆ
 *
__ª°ri˘
 
__timeout
);

111 #ifde‡
__USE_XOPEN2K


118 
p£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

119 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

120 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

121 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
,

122 c⁄° 
__sig£t_t
 *
__ª°ri˘
 
__sigmask
);

127 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__GNUC__


128 
	~<bôs/£À˘2.h
>

131 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

20 #i‚de‡
_SYS_SYSMACROS_H


21 
	#_SYS_SYSMACROS_H
 1

	)

23 
	~<„©uªs.h
>

28 #ifde‡
__GLIBC_HAVE_LONG_LONG


29 
__BEGIN_DECLS


31 
__exãnsi⁄__


32 
	$gnu_dev_maj‹
 (
__dev
)

33 
__THROW
 
__©åibuã_c⁄°__
;

34 
__exãnsi⁄__


35 
	$gnu_dev_mö‹
 (
__dev
)

36 
__THROW
 
__©åibuã_c⁄°__
;

37 
__exãnsi⁄__


38 
	$gnu_dev_makedev
 (
__maj‹
,

39 
__mö‹
)

40 
__THROW
 
__©åibuã_c⁄°__
;

42 #i‡
deföed
 
__GNUC__
 && __GNUC__ >2 && deföed 
__USE_EXTERN_INLINES


43 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

44 
	`__NTH
 (
	$gnu_dev_maj‹
 (
__dev
))

46  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

47 
	}
}

49 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

50 
__NTH
 (
	$gnu_dev_mö‹
 (
__dev
))

52  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

53 
	}
}

55 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

56 
__NTH
 (
	$gnu_dev_makedev
 (
__maj‹
, 
__mö‹
))

58  ((
__mö‹
 & 0xffË| ((
__maj‹
 & 0xfff) << 8)

59 | (((Ë(
__mö‹
 & ~0xff)) << 12)

60 | (((Ë(
__maj‹
 & ~0xfff)) << 32));

61 
	}
}

63 
	g__END_DECLS


66 
	#maj‹
(
dev
Ë
	`gnu_dev_maj‹
 (dev)

	)

67 
	#mö‹
(
dev
Ë
	`gnu_dev_mö‹
 (dev)

	)

68 
	#makedev
(
maj
, 
mö
Ë
	`gnu_dev_makedev
 (maj, mö)

	)

	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@/usr/include/bits/select.h

18 #i‚de‡
_SYS_SELECT_H


22 
	~<bôs/w‹dsize.h
>

25 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

27 #i‡
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "°osq"

	)

30 
	#__FD_ZERO_STOS
 "°o¶"

	)

33 
	#__FD_ZERO
(
fd•
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vﬁ©ûe__
 ("˛d;Ñï; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd•
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¨r
 = (
£t
); \

52 
__i
 = 0; __ò<  (
fd_£t
Ë/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¨r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)Ë!0)

	)

	@/usr/include/bits/select2.h

19 #i‚de‡
_SYS_SELECT_H


24 
__fdñt_chk
 (
__d
);

25 
	$__fdñt_w¨n
 (
__d
)

26 
	`__w¨«âr
 ("bit outside of fd_set selected");

27 #unde‡
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__exãnsi⁄__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__buûtö_c⁄°™t_p
 (
__d
) \

32 ? (0 <
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fdñt_w¨n
 (
__d
)) \

35 : 
	`__fdñt_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/sigset.h

20 #i‚def 
_SIGSET_H_ty≥s


21 
	#_SIGSET_H_ty≥s
 1

	)

23 
	t__sig_©omic_t
;

27 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

30 
	m__vÆ
[
_SIGSET_NWORDS
];

31 } 
	t__sig£t_t
;

42 #i‡!
deföed
 
_SIGSET_H_‚s
 && deföed 
_SIGNAL_H


43 
	#_SIGSET_H_‚s
 1

	)

45 #i‚de‡
_EXTERN_INLINE


46 
	#_EXTERN_INLINE
 
__exã∫_ölöe


	)

50 
	#__sigmask
(
sig
) \

51 (((Ë1Ë<< (((
sig
Ë- 1Ë% (8 *  ())))

	)

54 
	#__sigw‹d
(
sig
Ë(((sigË- 1Ë/ (8 *  ()))

	)

56 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

57 
	#__sigem±y£t
(
£t
) \

58 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

59 
sig£t_t
 *
__£t
 = (
£t
); \

60 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = 0; \

61 0; }))

	)

62 
	#__sigfûl£t
(
£t
) \

63 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

64 
sig£t_t
 *
__£t
 = (
£t
); \

65 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = ~0UL; \

66 0; }))

	)

68 #ifde‡
__USE_GNU


72 
	#__sigi£m±y£t
(
£t
) \

73 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

74 c⁄° 
sig£t_t
 *
__£t
 = (
£t
); \

75 
__ªt
 = 
__£t
->
__vÆ
[--
__˙t
]; \

76 !
__ªt
 && --
__˙t
 >= 0) \

77 
__ªt
 = 
__£t
->
__vÆ
[
__˙t
]; \

78 
__ªt
 =0; }))

	)

79 
	#__sig™d£t
(
de°
, 
À·
, 
right
) \

80 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

81 
sig£t_t
 *
__de°
 = (
de°
); \

82 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

83 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

84 --
__˙t
 >= 0) \

85 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

86 & 
__right
->
__vÆ
[
__˙t
]); \

87 0; }))

	)

88 
	#__sig‹£t
(
de°
, 
À·
, 
right
) \

89 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

90 
sig£t_t
 *
__de°
 = (
de°
); \

91 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

92 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

93 --
__˙t
 >= 0) \

94 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

95 | 
__right
->
__vÆ
[
__˙t
]); \

96 0; }))

	)

103 
__sigismembî
 (c⁄° 
__sig£t_t
 *, );

104 
__sigadd£t
 (
__sig£t_t
 *, );

105 
__sigdñ£t
 (
__sig£t_t
 *, );

107 #ifde‡
__USE_EXTERN_INLINES


108 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

109 
_EXTERN_INLINE
 \

110 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

112 
__mask
 = 
	`__sigmask
 (
__sig
); \

113 
__w‹d
 = 
	`__sigw‹d
 (
__sig
); \

114  
BODY
; \

115 }

	)

117 
__SIGSETFN
 (
__sigismembî
, (
__£t
->
__vÆ
[
__w‹d
] & 
__mask
) ? 1 : 0, const)

118 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__vÆ
[
__w‹d
] |
__mask
), 0), )

119 
__SIGSETFN
 (
__sigdñ£t
, ((
__£t
->
__vÆ
[
__w‹d
] &~
__mask
), 0), )

121 #unde‡
__SIGSETFN


	@/usr/include/bits/time.h

23 #i‡
deföed
 
__√ed_timevÆ
 || deföed 
__USE_GNU


24 #i‚de‡
_STRUCT_TIMEVAL


25 
	#_STRUCT_TIMEVAL
 1

	)

26 
	~<bôs/ty≥s.h
>

30 
	stimevÆ


32 
__time_t
 
	mtv_£c
;

33 
__su£c⁄ds_t
 
	mtv_u£c
;

38 #i‚de‡
__√ed_timevÆ


39 #i‚de‡
_BITS_TIME_H


40 
	#_BITS_TIME_H
 1

	)

48 
	#CLOCKS_PER_SEC
 1000000l

	)

50 #i‡(!
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_POSIX
) \

51 && !
deföed
 
	g__USE_XOPEN2K


54 
	~<bôs/ty≥s.h
>

55 
__sysc⁄f
 ();

56 
	#CLK_TCK
 ((
__˛ock_t
Ë
	`__sysc⁄f
 (2)Ë

	)

59 #ifde‡
__USE_POSIX199309


61 
	#CLOCK_REALTIME
 0

	)

63 
	#CLOCK_MONOTONIC
 1

	)

65 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

67 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

69 
	#CLOCK_MONOTONIC_RAW
 4

	)

71 
	#CLOCK_REALTIME_COARSE
 5

	)

73 
	#CLOCK_MONOTONIC_COARSE
 6

	)

75 
	#CLOCK_BOOTTIME
 7

	)

77 
	#CLOCK_REALTIME_ALARM
 8

	)

79 
	#CLOCK_BOOTTIME_ALARM
 9

	)

82 
	#TIMER_ABSTIME
 1

	)

85 #ifde‡
__USE_GNU


86 
	~<bôs/timex.h
>

88 
__BEGIN_DECLS


91 
	$˛ock_adjtime
 (
__˛ockid_t
 
__˛ock_id
, 
timex
 *
__utx
Ë
__THROW
;

93 
__END_DECLS


99 #unde‡
__√ed_timevÆ


	@/usr/include/bits/timex.h

18 #i‚def 
_BITS_TIMEX_H


19 
	#_BITS_TIMEX_H
 1

	)

21 
	~<bôs/ty≥s.h
>

25 
	stimex


27 
	mmodes
;

28 
__sysˇŒ_¶⁄g_t
 
	moff£t
;

29 
__sysˇŒ_¶⁄g_t
 
	m‰eq
;

30 
__sysˇŒ_¶⁄g_t
 
	mmaxîr‹
;

31 
__sysˇŒ_¶⁄g_t
 
	me°îr‹
;

32 
	m°©us
;

33 
__sysˇŒ_¶⁄g_t
 
	mc⁄°™t
;

34 
__sysˇŒ_¶⁄g_t
 
	m¥ecisi⁄
;

35 
__sysˇŒ_¶⁄g_t
 
	mtﬁî™˚
;

36 
timevÆ
 
	mtime
;

37 
__sysˇŒ_¶⁄g_t
 
	mtick
;

38 
__sysˇŒ_¶⁄g_t
 
	mµs‰eq
;

39 
__sysˇŒ_¶⁄g_t
 
	mjôãr
;

40 
	mshi·
;

41 
__sysˇŒ_¶⁄g_t
 
	m°abû
;

42 
__sysˇŒ_¶⁄g_t
 
	mjô˙t
;

43 
__sysˇŒ_¶⁄g_t
 
	mˇl˙t
;

44 
__sysˇŒ_¶⁄g_t
 
	mîr˙t
;

45 
__sysˇŒ_¶⁄g_t
 
	m°b˙t
;

47 
	mèi
;

56 
	#ADJ_OFFSET
 0x0001

	)

57 
	#ADJ_FREQUENCY
 0x0002

	)

58 
	#ADJ_MAXERROR
 0x0004

	)

59 
	#ADJ_ESTERROR
 0x0008

	)

60 
	#ADJ_STATUS
 0x0010

	)

61 
	#ADJ_TIMECONST
 0x0020

	)

62 
	#ADJ_TAI
 0x0080

	)

63 
	#ADJ_MICRO
 0x1000

	)

64 
	#ADJ_NANO
 0x2000

	)

65 
	#ADJ_TICK
 0x4000

	)

66 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

67 
	#ADJ_OFFSET_SS_READ
 0xa001

	)

70 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

71 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

72 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

73 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

74 
	#MOD_STATUS
 
ADJ_STATUS


	)

75 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

76 
	#MOD_CLKB
 
ADJ_TICK


	)

77 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

78 
	#MOD_TAI
 
ADJ_TAI


	)

79 
	#MOD_MICRO
 
ADJ_MICRO


	)

80 
	#MOD_NANO
 
ADJ_NANO


	)

84 
	#STA_PLL
 0x0001

	)

85 
	#STA_PPSFREQ
 0x0002

	)

86 
	#STA_PPSTIME
 0x0004

	)

87 
	#STA_FLL
 0x0008

	)

89 
	#STA_INS
 0x0010

	)

90 
	#STA_DEL
 0x0020

	)

91 
	#STA_UNSYNC
 0x0040

	)

92 
	#STA_FREQHOLD
 0x0080

	)

94 
	#STA_PPSSIGNAL
 0x0100

	)

95 
	#STA_PPSJITTER
 0x0200

	)

96 
	#STA_PPSWANDER
 0x0400

	)

97 
	#STA_PPSERROR
 0x0800

	)

99 
	#STA_CLOCKERR
 0x1000

	)

100 
	#STA_NANO
 0x2000

	)

101 
	#STA_MODE
 0x4000

	)

102 
	#STA_CLK
 0x8000

	)

105 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

106 
STA_PPSERROR
 | 
STA_CLOCKERR
 | 
STA_NANO
 | 
STA_MODE
 | 
STA_CLK
)

	)

	@
1
.
1
/usr/include
85
1535
alarm.c
argblock.c
bitset.c
blockdev.c
bufcache.c
cfs.c
crc32.c
dma.c
elf.c
floppy.c
gdt.c
gfs2.c
gosfs.c
ide.c
idt.c
int.c
io.c
irq.c
keyboard.c
kthread.c
main.c
malloc.c
mem.c
paging.c
pfat.c
pipe.c
screen.c
segment.c
sem.c
signal.c
smp.c
synch.c
syscall.c
timer.c
trap.c
tss.c
user.c
userseg.c
uservm.c
vfs.c
/usr/include/ctype.h
/usr/include/limits.h
/usr/include/string.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/types.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/xlocale.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/local_lim.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/typesizes.h
/usr/include/gnu/stubs.h
/usr/include/stdc-predef.h
/usr/include/stdlib.h
/usr/include/sys/cdefs.h
/usr/include/alloca.h
/usr/include/bits/byteswap-16.h
/usr/include/bits/predefs.h
/usr/include/bits/stdlib-float.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/gnu/stubs-x32.h
/usr/include/linux/limits.h
/usr/include/sys/types.h
/usr/include/bits/pthreadtypes.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/time.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/sigset.h
/usr/include/bits/time.h
/usr/include/bits/timex.h
